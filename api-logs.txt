
> jackpotx-backend@1.0.0 dev
> ts-node-dev --respawn --transpile-only index.ts

[INFO] 14:11:40 ts-node-dev ver. 2.0.0 (using ts-node ver. 10.9.2, typescript ver. 5.8.3)
[CRITICAL] Provider callback service loaded - VERSION 2.0
[HEALTH_MONITOR] Starting health monitoring...
Loaded Swagger paths: [
  '/api/admin-modules/my-modules',
  '/api/admin-modules/roles',
  '/api/admin-modules/by-role/{roleId}',
  '/api/admin-modules/all',
  '/api/admin-modules',
  '/api/admin-modules/{id}',
  '/api/admin/provider/validate-transaction',
  '/api/admin/provider/list-cancellable-transactions',
  '/api/admin/provider/transaction-details',
  '/api/admin/dashboard/stats',
  '/api/admin/games',
  '/api/admin/games/status',
  '/api/admin/games/status/id',
  '/api/admin/games/status/category',
  '/api/admin/games/status/provider',
  '/api/admin/games/status/bulk',
  '/api/admin/games/status/stats',
  '/api/admin/games/status/changes',
  '/api/admin/games/{id}',
  '/api/admin/categories',
  '/api/admin/categories/{id}',
  '/api/admin/categories/bulk',
  '/api/admin/categories/stats',
  '/api/admin/categories/hierarchy',
  '/api/admin/categories/migrate',
  '/api/admin/categories/{id}/games',
  '/api/admin/roles',
  '/api/admin/roles/{id}',
  '/api/admin/users/{id}/roles',
  '/api/admin/users/{id}/roles/{roleId}',
  '/api/admin/users',
  '/api/admin/users/{id}/status',
  '/api/admin/users/{id}/balance',
  '/api/admin/users/{id}/disable',
  '/api/admin/users/{id}/enable',
  '/api/admin/users/{id}/activate',
  '/api/admin/users/{id}/deactivate',
  '/api/admin/users/{id}/suspend',
  '/api/admin/users/{id}/ban',
  '/api/admin/affiliates',
  '/api/admin/users/{id}/topup',
  '/api/admin/providers',
  '/api/admin/providers/{id}',
  '/api/admin/providers/{id}/activate',
  '/api/admin/transactions',
  '/api/admin/transactions/{id}/approve',
  '/api/admin/settings',
  '/api/admin/analytics/revenue',
  '/api/admin/analytics/users',
  '/api/admin/game-provider',
  '/api/admin/import-games',
  '/api/admin/import-game',
  '/api/admin/game-import/status',
  '/api/admin/import-all-games',
  '/api/admin/payment-gateways',
  '/api/admin/payment-gateways/{id}',
  '/api/admin/payment-gateways/active',
  '/api/admin/payment-gateways/{id}/test',
  '/api/admin/payment-gateways/{id}/stats',
  '/api/admin/ggr-filter',
  '/api/admin/ggr-audit-logs',
  '/api/admin/ggr-report-summary',
  '/api/admin/modules',
  '/api/admin/modules/hierarchy',
  '/api/admin/modules/{id}',
  '/api/admin/activities',
  '/api/admin/rtp/settings',
  '/api/admin/rtp/analytics',
  '/api/admin/rtp/bulk-update',
  '/api/admin/rtp/report',
  '/api/admin/bets',
  '/api/admin/analytics/profit',
  '/api/admin/rtp/target-profit',
  '/api/admin/rtp/auto-adjustment',
  '/api/admin/profit/analytics',
  '/api/admin/profit/auto-adjustment',
  '/api/admin/profit/performance',
  '/api/admin/cron/status',
  '/api/admin/cron/start',
  '/api/admin/cron/stop',
  '/api/admin/cron/trigger-auto-adjustment',
  '/api/admin/cron/trigger-daily-summary',
  '/api/admin/promotions',
  '/api/admin/promotions/{id}',
  '/api/admin/promotions/{id}/toggle',
  '/api/admin/promotions/stats',
  '/api/admin/promotions/stats/overview',
  '/api/admin/promotions/{id}/claims',
  '/api/admin/kyc/pending',
  '/api/admin/kyc/{user_id}',
  '/api/admin/kyc/{user_id}/approve',
  '/api/admin/kyc/{user_id}/reject',
  '/api/admin/kyc/documents',
  '/api/admin/kyc/documents/{document_id}/verify',
  '/api/admin/kyc/{user_id}/risk-assessment',
  '/api/admin/kyc/reports',
  '/api/admin/kyc/audit-logs',
  '/api/admin/system/reset',
  '/api/admin/system/reset/stats',
  '/api/admin/users/bulk-status',
  ... 118 more items
]
Server running on http://localhost:3000
[APP] Starting background cron jobs...
[CRON_MANAGER] Cron jobs disabled via DISABLE_CRON_JOBS environment variable
[APP] Background cron jobs initialized
MongoDB connected: mongo
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":1,"currency_code":"USD","transaction_id":999999,"transaction_timestamp":"2025-08-11 14:12:00","round_id":999999,"round_finished":false,"game_id":4,"user_id":"48","token":"test123","context":{"reason":"not_provided","urid":"TEST123","history_id":"test"}},"request_timestamp":"2025-08-11 14:12:00","hash":"test123"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d853227b2fcb91-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '409',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'user-agent': 'curl/8.5.0',
    accept: '*/*',
    'x-operator-id': 'thinkcode_stg',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'cf-ray': '96d853227b2fcb91-LAX',
    'content-type': 'application/json',
    'accept-encoding': 'gzip, br',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG',
    'cf-visitor': '{"scheme":"https"}',
    'x-forwarded-proto': 'https'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: 1,
      currency_code: 'USD',
      transaction_id: 999999,
      transaction_timestamp: '2025-08-11 14:12:00',
      round_id: 999999,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:12:00',
    hash: 'test123'
  },
  timestamp: '2025-08-11T14:11:53.825Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": 1,
    "currency_code": "USD",
    "transaction_id": 999999,
    "transaction_timestamp": "2025-08-11 14:12:00",
    "round_id": 999999,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST123",
      "history_id": "test"
    }
  },
  "request_timestamp": "2025-08-11 14:12:00",
  "hash": "test123"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": 1,
    "currency_code": "USD",
    "transaction_id": 999999,
    "transaction_timestamp": "2025-08-11 14:12:00",
    "round_id": 999999,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST123",
      "history_id": "test"
    }
  },
  "request_timestamp": "2025-08-11 14:12:00",
  "hash": "test123"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '409',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'user-agent': 'curl/8.5.0',
    accept: '*/*',
    'x-operator-id': 'thinkcode_stg',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'cf-ray': '96d853227b2fcb91-LAX',
    'content-type': 'application/json',
    'accept-encoding': 'gzip, br',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG',
    'cf-visitor': '{"scheme":"https"}',
    'x-forwarded-proto': 'https'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: 1,
      currency_code: 'USD',
      transaction_id: 999999,
      transaction_timestamp: '2025-08-11 14:12:00',
      round_id: 999999,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:12:00',
    hash: 'test123'
  },
  timestamp: '2025-08-11T14:11:53.829Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: 1,
    currency_code: 'USD',
    transaction_id: 999999,
    transaction_timestamp: '2025-08-11 14:12:00',
    round_id: 999999,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test123',
    context: { reason: 'not_provided', urid: 'TEST123', history_id: 'test' }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": 1,
      "currency_code": "USD",
      "transaction_id": 999999,
      "transaction_timestamp": "2025-08-11 14:12:00",
      "round_id": 999999,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST123",
        "history_id": "test"
      }
    },
    "request_timestamp": "2025-08-11 14:12:00",
    "hash": "test123"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:11:53",
    "hash": "0c8e7ac0665f2e2ec8c31417703ba2892231fa6c",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid request hash"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": 1,
      "currency_code": "USD",
      "transaction_id": 999999,
      "transaction_timestamp": "2025-08-11 14:12:00",
      "round_id": 999999,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST123",
        "history_id": "test"
      }
    },
    "request_timestamp": "2025-08-11 14:12:00",
    "hash": "test123"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:11:53",
    "hash": "0c8e7ac0665f2e2ec8c31417703ba2892231fa6c",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid request hash"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 9.731 ms - 610[0m
[APP DEBUG] Incoming request: GET /api/user/balance body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d8533c28bfe4b6-OTP, IP: 81.196.253.99
[APP DEBUG] Incoming request: GET /api/user/category-balances body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d8533c38d3e4b6-OTP, IP: 81.196.253.99
[0mGET /api/user/category-balances [32m200[0m 54.069 ms - 141[0m
[0mGET /api/user/balance [32m200[0m 76.333 ms - 643[0m
[APP DEBUG] Incoming request: GET /api/user/balance body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85351bd68dc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[APP DEBUG] Incoming request: GET /api/user/category-balances body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85351bd6bdc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[0mGET /api/user/category-balances [32m200[0m 4.261 ms - 136[0m
[0mGET /api/user/balance [32m200[0m 10.389 ms - 593[0m
[APP DEBUG] Incoming request: GET /api/user/balance body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d8540ebd1cdc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[APP DEBUG] Incoming request: GET /api/user/category-balances body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d8540ebd1adc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[0mGET /api/user/category-balances [32m200[0m 24.045 ms - 136[0m
[0mGET /api/user/balance [32m200[0m 33.419 ms - 593[0m
[INFO] 14:12:31 Restarting: /app/src/services/provider/provider-callback.service.ts has been modified
[CRITICAL] Provider callback service loaded - VERSION 2.0
[HEALTH_MONITOR] Starting health monitoring...
Loaded Swagger paths: [
  '/api/admin-modules/my-modules',
  '/api/admin-modules/roles',
  '/api/admin-modules/by-role/{roleId}',
  '/api/admin-modules/all',
  '/api/admin-modules',
  '/api/admin-modules/{id}',
  '/api/admin/provider/validate-transaction',
  '/api/admin/provider/list-cancellable-transactions',
  '/api/admin/provider/transaction-details',
  '/api/admin/dashboard/stats',
  '/api/admin/games',
  '/api/admin/games/status',
  '/api/admin/games/status/id',
  '/api/admin/games/status/category',
  '/api/admin/games/status/provider',
  '/api/admin/games/status/bulk',
  '/api/admin/games/status/stats',
  '/api/admin/games/status/changes',
  '/api/admin/games/{id}',
  '/api/admin/categories',
  '/api/admin/categories/{id}',
  '/api/admin/categories/bulk',
  '/api/admin/categories/stats',
  '/api/admin/categories/hierarchy',
  '/api/admin/categories/migrate',
  '/api/admin/categories/{id}/games',
  '/api/admin/roles',
  '/api/admin/roles/{id}',
  '/api/admin/users/{id}/roles',
  '/api/admin/users/{id}/roles/{roleId}',
  '/api/admin/users',
  '/api/admin/users/{id}/status',
  '/api/admin/users/{id}/balance',
  '/api/admin/users/{id}/disable',
  '/api/admin/users/{id}/enable',
  '/api/admin/users/{id}/activate',
  '/api/admin/users/{id}/deactivate',
  '/api/admin/users/{id}/suspend',
  '/api/admin/users/{id}/ban',
  '/api/admin/affiliates',
  '/api/admin/users/{id}/topup',
  '/api/admin/providers',
  '/api/admin/providers/{id}',
  '/api/admin/providers/{id}/activate',
  '/api/admin/transactions',
  '/api/admin/transactions/{id}/approve',
  '/api/admin/settings',
  '/api/admin/analytics/revenue',
  '/api/admin/analytics/users',
  '/api/admin/game-provider',
  '/api/admin/import-games',
  '/api/admin/import-game',
  '/api/admin/game-import/status',
  '/api/admin/import-all-games',
  '/api/admin/payment-gateways',
  '/api/admin/payment-gateways/{id}',
  '/api/admin/payment-gateways/active',
  '/api/admin/payment-gateways/{id}/test',
  '/api/admin/payment-gateways/{id}/stats',
  '/api/admin/ggr-filter',
  '/api/admin/ggr-audit-logs',
  '/api/admin/ggr-report-summary',
  '/api/admin/modules',
  '/api/admin/modules/hierarchy',
  '/api/admin/modules/{id}',
  '/api/admin/activities',
  '/api/admin/rtp/settings',
  '/api/admin/rtp/analytics',
  '/api/admin/rtp/bulk-update',
  '/api/admin/rtp/report',
  '/api/admin/bets',
  '/api/admin/analytics/profit',
  '/api/admin/rtp/target-profit',
  '/api/admin/rtp/auto-adjustment',
  '/api/admin/profit/analytics',
  '/api/admin/profit/auto-adjustment',
  '/api/admin/profit/performance',
  '/api/admin/cron/status',
  '/api/admin/cron/start',
  '/api/admin/cron/stop',
  '/api/admin/cron/trigger-auto-adjustment',
  '/api/admin/cron/trigger-daily-summary',
  '/api/admin/promotions',
  '/api/admin/promotions/{id}',
  '/api/admin/promotions/{id}/toggle',
  '/api/admin/promotions/stats',
  '/api/admin/promotions/stats/overview',
  '/api/admin/promotions/{id}/claims',
  '/api/admin/kyc/pending',
  '/api/admin/kyc/{user_id}',
  '/api/admin/kyc/{user_id}/approve',
  '/api/admin/kyc/{user_id}/reject',
  '/api/admin/kyc/documents',
  '/api/admin/kyc/documents/{document_id}/verify',
  '/api/admin/kyc/{user_id}/risk-assessment',
  '/api/admin/kyc/reports',
  '/api/admin/kyc/audit-logs',
  '/api/admin/system/reset',
  '/api/admin/system/reset/stats',
  '/api/admin/users/bulk-status',
  ... 118 more items
]
Server running on http://localhost:3000
[APP] Starting background cron jobs...
[CRON_MANAGER] Cron jobs disabled via DISABLE_CRON_JOBS environment variable
[APP] Background cron jobs initialized
MongoDB connected: mongo
[APP DEBUG] Incoming request: GET /api/user/category-balances body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d854cb8c96dc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[APP DEBUG] Incoming request: GET /api/user/balance body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d854cb9cb0dc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[0mGET /api/user/category-balances [32m200[0m 53.272 ms - 136[0m
[0mGET /api/user/balance [32m200[0m 52.633 ms - 593[0m
[APP DEBUG] Incoming request: GET /api/user/balance body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d854d28ecce4b6-OTP, IP: 81.196.253.99
[APP DEBUG] Incoming request: GET /api/user/category-balances body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d854d29ee1e4b6-OTP, IP: 81.196.253.99
[0mGET /api/user/category-balances [32m200[0m 6.220 ms - 141[0m
[0mGET /api/user/balance [32m200[0m 16.648 ms - 643[0m
[APP DEBUG] Incoming request: HEAD / body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d855801950e972-DFW, IP: 216.144.248.23
[0mHEAD / [36m302[0m 1.821 ms - 34[0m
[APP DEBUG] Incoming request: GET /api/user/balance body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85587afcfdc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[APP DEBUG] Incoming request: GET /api/user/category-balances body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85587bfd5dc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[0mGET /api/user/category-balances [32m200[0m 22.233 ms - 136[0m
[0mGET /api/user/balance [32m200[0m 30.677 ms - 593[0m
[APP DEBUG] Incoming request: HEAD /docs body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d855848c88e85b-DFW, IP: 216.144.248.23
[0mHEAD /docs [33m401[0m 0.711 ms - 79[0m
[APP DEBUG] Incoming request: GET /api/admin/dashboard/stats body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d855a6d8f9e4b6-OTP, IP: 81.196.253.99
[APP DEBUG] Incoming request: GET /api/admin/transactions?page=10&limit=50 body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d855a6e90de4b6-OTP, IP: 81.196.253.99
[0mGET /api/admin/transactions?page=10&limit=50 [32m200[0m 18.364 ms - -[0m
[0mGET /api/admin/dashboard/stats [32m200[0m 39.760 ms - 164[0m
[APP DEBUG] Incoming request: GET /robots.txt body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d855b8ca512ca9-DFW, IP: 104.210.140.136
[0mGET /robots.txt [33m404[0m 1.576 ms - 149[0m
[APP DEBUG] Incoming request: GET /robots.txt body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d855c69aac2ca9-DFW, IP: 104.210.140.136
[0mGET /robots.txt [33m404[0m 0.277 ms - 149[0m
[APP DEBUG] Incoming request: GET /api/user/balance body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d8562a2d10e4b6-OTP, IP: 81.196.253.99
[APP DEBUG] Incoming request: GET /api/user/category-balances body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d8562a3d21e4b6-OTP, IP: 81.196.253.99
[0mGET /api/user/balance [32m200[0m 33.046 ms - 643[0m
[0mGET /api/user/category-balances [32m200[0m 24.429 ms - 141[0m
[APP DEBUG] Incoming request: GET /api/user/category-balances body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d856445aabdc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[APP DEBUG] Incoming request: GET /api/user/balance body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d856446ab3dc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[0mGET /api/user/category-balances [32m200[0m 31.408 ms - 136[0m
[0mGET /api/user/balance [32m200[0m 20.222 ms - 593[0m
[APP DEBUG] Incoming request: GET /api/user/balance body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85701deb3dc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[APP DEBUG] Incoming request: GET /api/user/category-balances body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85701deb5dc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[0mGET /api/user/balance [32m200[0m 26.459 ms - 593[0m
[0mGET /api/user/category-balances [32m200[0m 23.369 ms - 136[0m
[APP DEBUG] Incoming request: GET /api/user/category-balances body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d857a1cac7e4b6-OTP, IP: 81.196.253.99
[APP DEBUG] Incoming request: GET /api/user/balance body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d857a1cac8e4b6-OTP, IP: 81.196.253.99
[0mGET /api/user/category-balances [32m200[0m 22.628 ms - 141[0m
[0mGET /api/user/balance [32m200[0m 23.314 ms - 643[0m
[APP DEBUG] Incoming request: GET /api/user/balance body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d857be9bfadc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[APP DEBUG] Incoming request: GET /api/user/category-balances body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d857be9bf5dc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[0mGET /api/user/balance [32m200[0m 33.774 ms - 593[0m
[0mGET /api/user/category-balances [32m200[0m 29.234 ms - 136[0m
[APP DEBUG] Incoming request: GET /api/user/category-balances body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d8587acb48dc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[APP DEBUG] Incoming request: GET /api/user/balance body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d8587acb4adc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[0mGET /api/user/category-balances [32m200[0m 19.921 ms - 136[0m
[0mGET /api/user/balance [32m200[0m 20.082 ms - 593[0m
[APP DEBUG] Incoming request: GET /api/user/category-balances body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d859184aa5e4b6-OTP, IP: 81.196.253.99
[APP DEBUG] Incoming request: GET /api/user/balance body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d859184ab9e4b6-OTP, IP: 81.196.253.99
[0mGET /api/user/category-balances [32m200[0m 21.471 ms - 141[0m
[0mGET /api/user/balance [32m200[0m 25.095 ms - 643[0m
[APP DEBUG] Incoming request: GET /api/user/balance body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d859378c1fdc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[APP DEBUG] Incoming request: GET /api/user/category-balances body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d859378c21dc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[0mGET /api/user/category-balances [32m200[0m 12.628 ms - 136[0m
[0mGET /api/user/balance [32m200[0m 15.614 ms - 593[0m
[APP DEBUG] Incoming request: GET /api/user/category-balances body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d859f44d17dc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[APP DEBUG] Incoming request: GET /api/user/balance body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d859f45d48dc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[0mGET /api/user/category-balances [32m200[0m 32.127 ms - 136[0m
[0mGET /api/user/balance [32m200[0m 30.544 ms - 593[0m
[APP DEBUG] Incoming request: GET /api/user/balance body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85a919c15e594-OTP, IP: 81.196.253.99
[0mGET /api/user/balance [32m200[0m 21.532 ms - 643[0m
[APP DEBUG] Incoming request: GET /api/user/category-balances body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85a91cc25e594-OTP, IP: 81.196.253.99
[0mGET /api/user/category-balances [32m200[0m 4.726 ms - 141[0m
[APP DEBUG] Incoming request: GET /api/user/balance body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85ab07c11dc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[APP DEBUG] Incoming request: GET /api/user/category-balances body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85ab08c2edc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[0mGET /api/user/balance [32m200[0m 34.960 ms - 593[0m
[0mGET /api/user/category-balances [32m200[0m 131.010 ms - 136[0m
[HEALTH_MONITOR] System Status: DEGRADED
[HEALTH_MONITOR] Uptime: 4 minutes
[HEALTH_MONITOR] Memory Usage: 94.60%
[HEALTH_MONITOR] CPU Usage: 0.00s
[HEALTH_MONITOR] Requests: 34
[HEALTH_MONITOR] Errors: 0
[HEALTH_MONITOR] Rate Limits: 0
[HEALTH_MONITOR] Cloudflare Requests: 34
[HEALTH_MONITOR] Circuit Breaker: CLOSED
[APP DEBUG] Incoming request: GET /api/user/balance body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85b6c9f33dc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[APP DEBUG] Incoming request: GET /api/user/category-balances body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85b6c9f34dc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[0mGET /api/user/category-balances [32m200[0m 16.583 ms - 136[0m
[0mGET /api/user/balance [32m200[0m 23.240 ms - 593[0m
[APP DEBUG] Incoming request: GET /api/user/category-balances body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85c296c93dc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[APP DEBUG] Incoming request: GET /api/user/balance body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85c296c9ddc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[0mGET /api/user/balance [32m200[0m 36.327 ms - 593[0m
[0mGET /api/user/category-balances [32m200[0m 63.069 ms - 136[0m
[APP DEBUG] Incoming request: GET /api/user/category-balances body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85ce59bd8dc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[APP DEBUG] Incoming request: GET /api/user/balance body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85ce59bdadc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[0mGET /api/user/category-balances [32m200[0m 21.571 ms - 136[0m
[0mGET /api/user/balance [32m200[0m 22.687 ms - 593[0m
[APP DEBUG] Incoming request: GET /api/user/category-balances body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85da29bc3dc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[APP DEBUG] Incoming request: GET /api/user/balance body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85da28bbfdc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[0mGET /api/user/balance [32m200[0m 43.855 ms - 593[0m
[0mGET /api/user/category-balances [32m200[0m 70.448 ms - 136[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"2.12","currency_code":"USD","transaction_id":1000001,"transaction_timestamp":"2025-08-11 14:19:18","round_id":137057,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000001","history_id":"test-1000001"}},"request_timestamp":"2025-08-11 14:19:18","hash":"test_hash_1000001"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e0558101015-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': 'a972b2eefcc9c33715d835c83cf1eec8351f3fa8',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e0558101015-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '2.12',
      currency_code: 'USD',
      transaction_id: 1000001,
      transaction_timestamp: '2025-08-11 14:19:18',
      round_id: 137057,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:18',
    hash: 'test_hash_1000001'
  },
  timestamp: '2025-08-11T14:19:19.731Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "2.12",
    "currency_code": "USD",
    "transaction_id": 1000001,
    "transaction_timestamp": "2025-08-11 14:19:18",
    "round_id": 137057,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000001",
      "history_id": "test-1000001"
    }
  },
  "request_timestamp": "2025-08-11 14:19:18",
  "hash": "test_hash_1000001"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "2.12",
    "currency_code": "USD",
    "transaction_id": 1000001,
    "transaction_timestamp": "2025-08-11 14:19:18",
    "round_id": 137057,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000001",
      "history_id": "test-1000001"
    }
  },
  "request_timestamp": "2025-08-11 14:19:18",
  "hash": "test_hash_1000001"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': 'a972b2eefcc9c33715d835c83cf1eec8351f3fa8',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e0558101015-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '2.12',
      currency_code: 'USD',
      transaction_id: 1000001,
      transaction_timestamp: '2025-08-11 14:19:18',
      round_id: 137057,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:18',
    hash: 'test_hash_1000001'
  },
  timestamp: '2025-08-11T14:19:19.732Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '2.12',
    currency_code: 'USD',
    transaction_id: 1000001,
    transaction_timestamp: '2025-08-11 14:19:18',
    round_id: 137057,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000001',
      history_id: 'test-1000001'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: a972b2eefcc9c33715d835c83cf1eec8351f3fa8
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: false
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "2.12",
      "currency_code": "USD",
      "transaction_id": 1000001,
      "transaction_timestamp": "2025-08-11 14:19:18",
      "round_id": 137057,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000001",
        "history_id": "test-1000001"
      }
    },
    "request_timestamp": "2025-08-11 14:19:18",
    "hash": "test_hash_1000001"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:19",
    "hash": "56039fc6a8919bd043ca76937a9c16cb9a8e8326",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "2.12",
      "currency_code": "USD",
      "transaction_id": 1000001,
      "transaction_timestamp": "2025-08-11 14:19:18",
      "round_id": 137057,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000001",
        "history_id": "test-1000001"
      }
    },
    "request_timestamp": "2025-08-11 14:19:18",
    "hash": "test_hash_1000001"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:19",
    "hash": "56039fc6a8919bd043ca76937a9c16cb9a8e8326",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 2.824 ms - 646[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"3.79","currency_code":"USD","transaction_id":1000009,"transaction_timestamp":"2025-08-11 14:19:18","round_id":218488,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000009","history_id":"test-1000009"}},"request_timestamp":"2025-08-11 14:19:18","hash":"test_hash_1000009"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e055a6f1000-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '826a8bc77f8824975add6e1b85a0f2c0a74f9129',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e055a6f1000-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '3.79',
      currency_code: 'USD',
      transaction_id: 1000009,
      transaction_timestamp: '2025-08-11 14:19:18',
      round_id: 218488,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:18',
    hash: 'test_hash_1000009'
  },
  timestamp: '2025-08-11T14:19:19.736Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "3.79",
    "currency_code": "USD",
    "transaction_id": 1000009,
    "transaction_timestamp": "2025-08-11 14:19:18",
    "round_id": 218488,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000009",
      "history_id": "test-1000009"
    }
  },
  "request_timestamp": "2025-08-11 14:19:18",
  "hash": "test_hash_1000009"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "3.79",
    "currency_code": "USD",
    "transaction_id": 1000009,
    "transaction_timestamp": "2025-08-11 14:19:18",
    "round_id": 218488,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000009",
      "history_id": "test-1000009"
    }
  },
  "request_timestamp": "2025-08-11 14:19:18",
  "hash": "test_hash_1000009"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '826a8bc77f8824975add6e1b85a0f2c0a74f9129',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e055a6f1000-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '3.79',
      currency_code: 'USD',
      transaction_id: 1000009,
      transaction_timestamp: '2025-08-11 14:19:18',
      round_id: 218488,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:18',
    hash: 'test_hash_1000009'
  },
  timestamp: '2025-08-11T14:19:19.737Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '3.79',
    currency_code: 'USD',
    transaction_id: 1000009,
    transaction_timestamp: '2025-08-11 14:19:18',
    round_id: 218488,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000009',
      history_id: 'test-1000009'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 826a8bc77f8824975add6e1b85a0f2c0a74f9129
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: false
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "3.79",
      "currency_code": "USD",
      "transaction_id": 1000009,
      "transaction_timestamp": "2025-08-11 14:19:18",
      "round_id": 218488,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000009",
        "history_id": "test-1000009"
      }
    },
    "request_timestamp": "2025-08-11 14:19:18",
    "hash": "test_hash_1000009"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:19",
    "hash": "56039fc6a8919bd043ca76937a9c16cb9a8e8326",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "3.79",
      "currency_code": "USD",
      "transaction_id": 1000009,
      "transaction_timestamp": "2025-08-11 14:19:18",
      "round_id": 218488,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000009",
        "history_id": "test-1000009"
      }
    },
    "request_timestamp": "2025-08-11 14:19:18",
    "hash": "test_hash_1000009"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:19",
    "hash": "56039fc6a8919bd043ca76937a9c16cb9a8e8326",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 1.433 ms - 646[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"2.93","currency_code":"USD","transaction_id":1000004,"transaction_timestamp":"2025-08-11 14:19:18","round_id":830039,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000004","history_id":"test-1000004"}},"request_timestamp":"2025-08-11 14:19:18","hash":"test_hash_1000004"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e056a822b83-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '76010d698c2fdee27af1afa5acad531860fef414',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e056a822b83-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '2.93',
      currency_code: 'USD',
      transaction_id: 1000004,
      transaction_timestamp: '2025-08-11 14:19:18',
      round_id: 830039,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:18',
    hash: 'test_hash_1000004'
  },
  timestamp: '2025-08-11T14:19:19.744Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "2.93",
    "currency_code": "USD",
    "transaction_id": 1000004,
    "transaction_timestamp": "2025-08-11 14:19:18",
    "round_id": 830039,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000004",
      "history_id": "test-1000004"
    }
  },
  "request_timestamp": "2025-08-11 14:19:18",
  "hash": "test_hash_1000004"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "2.93",
    "currency_code": "USD",
    "transaction_id": 1000004,
    "transaction_timestamp": "2025-08-11 14:19:18",
    "round_id": 830039,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000004",
      "history_id": "test-1000004"
    }
  },
  "request_timestamp": "2025-08-11 14:19:18",
  "hash": "test_hash_1000004"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '76010d698c2fdee27af1afa5acad531860fef414',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e056a822b83-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '2.93',
      currency_code: 'USD',
      transaction_id: 1000004,
      transaction_timestamp: '2025-08-11 14:19:18',
      round_id: 830039,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:18',
    hash: 'test_hash_1000004'
  },
  timestamp: '2025-08-11T14:19:19.745Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '2.93',
    currency_code: 'USD',
    transaction_id: 1000004,
    transaction_timestamp: '2025-08-11 14:19:18',
    round_id: 830039,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000004',
      history_id: 'test-1000004'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 76010d698c2fdee27af1afa5acad531860fef414
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: false
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "2.93",
      "currency_code": "USD",
      "transaction_id": 1000004,
      "transaction_timestamp": "2025-08-11 14:19:18",
      "round_id": 830039,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000004",
        "history_id": "test-1000004"
      }
    },
    "request_timestamp": "2025-08-11 14:19:18",
    "hash": "test_hash_1000004"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:19",
    "hash": "56039fc6a8919bd043ca76937a9c16cb9a8e8326",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "2.93",
      "currency_code": "USD",
      "transaction_id": 1000004,
      "transaction_timestamp": "2025-08-11 14:19:18",
      "round_id": 830039,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000004",
        "history_id": "test-1000004"
      }
    },
    "request_timestamp": "2025-08-11 14:19:18",
    "hash": "test_hash_1000004"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:19",
    "hash": "56039fc6a8919bd043ca76937a9c16cb9a8e8326",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 1.885 ms - 646[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"1.79","currency_code":"USD","transaction_id":1000000,"transaction_timestamp":"2025-08-11 14:19:18","round_id":474760,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000000","history_id":"test-1000000"}},"request_timestamp":"2025-08-11 14:19:18","hash":"test_hash_1000000"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e057817f7db-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '2332b83602f3a38292abfd9d6d23749b2582a6f3',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e057817f7db-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '1.79',
      currency_code: 'USD',
      transaction_id: 1000000,
      transaction_timestamp: '2025-08-11 14:19:18',
      round_id: 474760,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:18',
    hash: 'test_hash_1000000'
  },
  timestamp: '2025-08-11T14:19:19.753Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "1.79",
    "currency_code": "USD",
    "transaction_id": 1000000,
    "transaction_timestamp": "2025-08-11 14:19:18",
    "round_id": 474760,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000000",
      "history_id": "test-1000000"
    }
  },
  "request_timestamp": "2025-08-11 14:19:18",
  "hash": "test_hash_1000000"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "1.79",
    "currency_code": "USD",
    "transaction_id": 1000000,
    "transaction_timestamp": "2025-08-11 14:19:18",
    "round_id": 474760,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000000",
      "history_id": "test-1000000"
    }
  },
  "request_timestamp": "2025-08-11 14:19:18",
  "hash": "test_hash_1000000"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '2332b83602f3a38292abfd9d6d23749b2582a6f3',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e057817f7db-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '1.79',
      currency_code: 'USD',
      transaction_id: 1000000,
      transaction_timestamp: '2025-08-11 14:19:18',
      round_id: 474760,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:18',
    hash: 'test_hash_1000000'
  },
  timestamp: '2025-08-11T14:19:19.753Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '1.79',
    currency_code: 'USD',
    transaction_id: 1000000,
    transaction_timestamp: '2025-08-11 14:19:18',
    round_id: 474760,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000000',
      history_id: 'test-1000000'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 2332b83602f3a38292abfd9d6d23749b2582a6f3
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: false
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "1.79",
      "currency_code": "USD",
      "transaction_id": 1000000,
      "transaction_timestamp": "2025-08-11 14:19:18",
      "round_id": 474760,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000000",
        "history_id": "test-1000000"
      }
    },
    "request_timestamp": "2025-08-11 14:19:18",
    "hash": "test_hash_1000000"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:19",
    "hash": "56039fc6a8919bd043ca76937a9c16cb9a8e8326",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "1.79",
      "currency_code": "USD",
      "transaction_id": 1000000,
      "transaction_timestamp": "2025-08-11 14:19:18",
      "round_id": 474760,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000000",
        "history_id": "test-1000000"
      }
    },
    "request_timestamp": "2025-08-11 14:19:18",
    "hash": "test_hash_1000000"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:19",
    "hash": "56039fc6a8919bd043ca76937a9c16cb9a8e8326",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 1.091 ms - 646[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"6.82","currency_code":"USD","transaction_id":1000008,"transaction_timestamp":"2025-08-11 14:19:18","round_id":212753,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000008","history_id":"test-1000008"}},"request_timestamp":"2025-08-11 14:19:18","hash":"test_hash_1000008"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e059fcb08cd-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '78f57fe0b25013c5304c273846d5f0fe0ed9d8d9',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e059fcb08cd-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '6.82',
      currency_code: 'USD',
      transaction_id: 1000008,
      transaction_timestamp: '2025-08-11 14:19:18',
      round_id: 212753,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:18',
    hash: 'test_hash_1000008'
  },
  timestamp: '2025-08-11T14:19:19.770Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "6.82",
    "currency_code": "USD",
    "transaction_id": 1000008,
    "transaction_timestamp": "2025-08-11 14:19:18",
    "round_id": 212753,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000008",
      "history_id": "test-1000008"
    }
  },
  "request_timestamp": "2025-08-11 14:19:18",
  "hash": "test_hash_1000008"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "6.82",
    "currency_code": "USD",
    "transaction_id": 1000008,
    "transaction_timestamp": "2025-08-11 14:19:18",
    "round_id": 212753,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000008",
      "history_id": "test-1000008"
    }
  },
  "request_timestamp": "2025-08-11 14:19:18",
  "hash": "test_hash_1000008"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '78f57fe0b25013c5304c273846d5f0fe0ed9d8d9',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e059fcb08cd-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '6.82',
      currency_code: 'USD',
      transaction_id: 1000008,
      transaction_timestamp: '2025-08-11 14:19:18',
      round_id: 212753,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:18',
    hash: 'test_hash_1000008'
  },
  timestamp: '2025-08-11T14:19:19.770Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '6.82',
    currency_code: 'USD',
    transaction_id: 1000008,
    transaction_timestamp: '2025-08-11 14:19:18',
    round_id: 212753,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000008',
      history_id: 'test-1000008'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 78f57fe0b25013c5304c273846d5f0fe0ed9d8d9
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: false
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "6.82",
      "currency_code": "USD",
      "transaction_id": 1000008,
      "transaction_timestamp": "2025-08-11 14:19:18",
      "round_id": 212753,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000008",
        "history_id": "test-1000008"
      }
    },
    "request_timestamp": "2025-08-11 14:19:18",
    "hash": "test_hash_1000008"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:19",
    "hash": "56039fc6a8919bd043ca76937a9c16cb9a8e8326",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "6.82",
      "currency_code": "USD",
      "transaction_id": 1000008,
      "transaction_timestamp": "2025-08-11 14:19:18",
      "round_id": 212753,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000008",
        "history_id": "test-1000008"
      }
    },
    "request_timestamp": "2025-08-11 14:19:18",
    "hash": "test_hash_1000008"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:19",
    "hash": "56039fc6a8919bd043ca76937a9c16cb9a8e8326",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 1.244 ms - 646[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"9.17","currency_code":"USD","transaction_id":1000002,"transaction_timestamp":"2025-08-11 14:19:18","round_id":397753,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000002","history_id":"test-1000002"}},"request_timestamp":"2025-08-11 14:19:18","hash":"test_hash_1000002"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e05acbb2aa6-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '48ba4c5f63f5b384cde57f7d8147bba1449929a7',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e05acbb2aa6-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '9.17',
      currency_code: 'USD',
      transaction_id: 1000002,
      transaction_timestamp: '2025-08-11 14:19:18',
      round_id: 397753,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:18',
    hash: 'test_hash_1000002'
  },
  timestamp: '2025-08-11T14:19:19.774Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "9.17",
    "currency_code": "USD",
    "transaction_id": 1000002,
    "transaction_timestamp": "2025-08-11 14:19:18",
    "round_id": 397753,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000002",
      "history_id": "test-1000002"
    }
  },
  "request_timestamp": "2025-08-11 14:19:18",
  "hash": "test_hash_1000002"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "9.17",
    "currency_code": "USD",
    "transaction_id": 1000002,
    "transaction_timestamp": "2025-08-11 14:19:18",
    "round_id": 397753,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000002",
      "history_id": "test-1000002"
    }
  },
  "request_timestamp": "2025-08-11 14:19:18",
  "hash": "test_hash_1000002"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '48ba4c5f63f5b384cde57f7d8147bba1449929a7',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e05acbb2aa6-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '9.17',
      currency_code: 'USD',
      transaction_id: 1000002,
      transaction_timestamp: '2025-08-11 14:19:18',
      round_id: 397753,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:18',
    hash: 'test_hash_1000002'
  },
  timestamp: '2025-08-11T14:19:19.775Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '9.17',
    currency_code: 'USD',
    transaction_id: 1000002,
    transaction_timestamp: '2025-08-11 14:19:18',
    round_id: 397753,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000002',
      history_id: 'test-1000002'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 48ba4c5f63f5b384cde57f7d8147bba1449929a7
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: false
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "9.17",
      "currency_code": "USD",
      "transaction_id": 1000002,
      "transaction_timestamp": "2025-08-11 14:19:18",
      "round_id": 397753,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000002",
        "history_id": "test-1000002"
      }
    },
    "request_timestamp": "2025-08-11 14:19:18",
    "hash": "test_hash_1000002"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:19",
    "hash": "56039fc6a8919bd043ca76937a9c16cb9a8e8326",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "9.17",
      "currency_code": "USD",
      "transaction_id": 1000002,
      "transaction_timestamp": "2025-08-11 14:19:18",
      "round_id": 397753,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000002",
        "history_id": "test-1000002"
      }
    },
    "request_timestamp": "2025-08-11 14:19:18",
    "hash": "test_hash_1000002"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:19",
    "hash": "56039fc6a8919bd043ca76937a9c16cb9a8e8326",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 1.530 ms - 646[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"6.82","currency_code":"USD","transaction_id":1000003,"transaction_timestamp":"2025-08-11 14:19:18","round_id":876207,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000003","history_id":"test-1000003"}},"request_timestamp":"2025-08-11 14:19:18","hash":"test_hash_1000003"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e054c447cb0-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '405eb8982032fa6952daf910c0570004d4be417e',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e054c447cb0-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '6.82',
      currency_code: 'USD',
      transaction_id: 1000003,
      transaction_timestamp: '2025-08-11 14:19:18',
      round_id: 876207,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:18',
    hash: 'test_hash_1000003'
  },
  timestamp: '2025-08-11T14:19:19.778Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "6.82",
    "currency_code": "USD",
    "transaction_id": 1000003,
    "transaction_timestamp": "2025-08-11 14:19:18",
    "round_id": 876207,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000003",
      "history_id": "test-1000003"
    }
  },
  "request_timestamp": "2025-08-11 14:19:18",
  "hash": "test_hash_1000003"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "6.82",
    "currency_code": "USD",
    "transaction_id": 1000003,
    "transaction_timestamp": "2025-08-11 14:19:18",
    "round_id": 876207,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000003",
      "history_id": "test-1000003"
    }
  },
  "request_timestamp": "2025-08-11 14:19:18",
  "hash": "test_hash_1000003"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '405eb8982032fa6952daf910c0570004d4be417e',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e054c447cb0-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '6.82',
      currency_code: 'USD',
      transaction_id: 1000003,
      transaction_timestamp: '2025-08-11 14:19:18',
      round_id: 876207,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:18',
    hash: 'test_hash_1000003'
  },
  timestamp: '2025-08-11T14:19:19.778Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '6.82',
    currency_code: 'USD',
    transaction_id: 1000003,
    transaction_timestamp: '2025-08-11 14:19:18',
    round_id: 876207,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000003',
      history_id: 'test-1000003'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 405eb8982032fa6952daf910c0570004d4be417e
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: false
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "6.82",
      "currency_code": "USD",
      "transaction_id": 1000003,
      "transaction_timestamp": "2025-08-11 14:19:18",
      "round_id": 876207,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000003",
        "history_id": "test-1000003"
      }
    },
    "request_timestamp": "2025-08-11 14:19:18",
    "hash": "test_hash_1000003"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:19",
    "hash": "56039fc6a8919bd043ca76937a9c16cb9a8e8326",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "6.82",
      "currency_code": "USD",
      "transaction_id": 1000003,
      "transaction_timestamp": "2025-08-11 14:19:18",
      "round_id": 876207,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000003",
        "history_id": "test-1000003"
      }
    },
    "request_timestamp": "2025-08-11 14:19:18",
    "hash": "test_hash_1000003"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:19",
    "hash": "56039fc6a8919bd043ca76937a9c16cb9a8e8326",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 1.624 ms - 646[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"5.25","currency_code":"USD","transaction_id":1000007,"transaction_timestamp":"2025-08-11 14:19:18","round_id":705417,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000007","history_id":"test-1000007"}},"request_timestamp":"2025-08-11 14:19:18","hash":"test_hash_1000007"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e05ab3ef7d9-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '2b730c86cb337f731adf2d3fa63f4798de8b4f4d',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e05ab3ef7d9-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '5.25',
      currency_code: 'USD',
      transaction_id: 1000007,
      transaction_timestamp: '2025-08-11 14:19:18',
      round_id: 705417,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:18',
    hash: 'test_hash_1000007'
  },
  timestamp: '2025-08-11T14:19:19.781Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "5.25",
    "currency_code": "USD",
    "transaction_id": 1000007,
    "transaction_timestamp": "2025-08-11 14:19:18",
    "round_id": 705417,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000007",
      "history_id": "test-1000007"
    }
  },
  "request_timestamp": "2025-08-11 14:19:18",
  "hash": "test_hash_1000007"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "5.25",
    "currency_code": "USD",
    "transaction_id": 1000007,
    "transaction_timestamp": "2025-08-11 14:19:18",
    "round_id": 705417,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000007",
      "history_id": "test-1000007"
    }
  },
  "request_timestamp": "2025-08-11 14:19:18",
  "hash": "test_hash_1000007"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '2b730c86cb337f731adf2d3fa63f4798de8b4f4d',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e05ab3ef7d9-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '5.25',
      currency_code: 'USD',
      transaction_id: 1000007,
      transaction_timestamp: '2025-08-11 14:19:18',
      round_id: 705417,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:18',
    hash: 'test_hash_1000007'
  },
  timestamp: '2025-08-11T14:19:19.782Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '5.25',
    currency_code: 'USD',
    transaction_id: 1000007,
    transaction_timestamp: '2025-08-11 14:19:18',
    round_id: 705417,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000007',
      history_id: 'test-1000007'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 2b730c86cb337f731adf2d3fa63f4798de8b4f4d
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: false
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "5.25",
      "currency_code": "USD",
      "transaction_id": 1000007,
      "transaction_timestamp": "2025-08-11 14:19:18",
      "round_id": 705417,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000007",
        "history_id": "test-1000007"
      }
    },
    "request_timestamp": "2025-08-11 14:19:18",
    "hash": "test_hash_1000007"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:19",
    "hash": "56039fc6a8919bd043ca76937a9c16cb9a8e8326",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "5.25",
      "currency_code": "USD",
      "transaction_id": 1000007,
      "transaction_timestamp": "2025-08-11 14:19:18",
      "round_id": 705417,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000007",
        "history_id": "test-1000007"
      }
    },
    "request_timestamp": "2025-08-11 14:19:18",
    "hash": "test_hash_1000007"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:19",
    "hash": "56039fc6a8919bd043ca76937a9c16cb9a8e8326",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 1.371 ms - 646[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"2.40","currency_code":"USD","transaction_id":1000005,"transaction_timestamp":"2025-08-11 14:19:18","round_id":677341,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000005","history_id":"test-1000005"}},"request_timestamp":"2025-08-11 14:19:18","hash":"test_hash_1000005"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e056b612b7d-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '810dd45df4ff2b2e086ee0f83be3a57ee4deec4e',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e056b612b7d-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '2.40',
      currency_code: 'USD',
      transaction_id: 1000005,
      transaction_timestamp: '2025-08-11 14:19:18',
      round_id: 677341,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:18',
    hash: 'test_hash_1000005'
  },
  timestamp: '2025-08-11T14:19:19.808Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "2.40",
    "currency_code": "USD",
    "transaction_id": 1000005,
    "transaction_timestamp": "2025-08-11 14:19:18",
    "round_id": 677341,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000005",
      "history_id": "test-1000005"
    }
  },
  "request_timestamp": "2025-08-11 14:19:18",
  "hash": "test_hash_1000005"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "2.40",
    "currency_code": "USD",
    "transaction_id": 1000005,
    "transaction_timestamp": "2025-08-11 14:19:18",
    "round_id": 677341,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000005",
      "history_id": "test-1000005"
    }
  },
  "request_timestamp": "2025-08-11 14:19:18",
  "hash": "test_hash_1000005"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '810dd45df4ff2b2e086ee0f83be3a57ee4deec4e',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e056b612b7d-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '2.40',
      currency_code: 'USD',
      transaction_id: 1000005,
      transaction_timestamp: '2025-08-11 14:19:18',
      round_id: 677341,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:18',
    hash: 'test_hash_1000005'
  },
  timestamp: '2025-08-11T14:19:19.809Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '2.40',
    currency_code: 'USD',
    transaction_id: 1000005,
    transaction_timestamp: '2025-08-11 14:19:18',
    round_id: 677341,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000005',
      history_id: 'test-1000005'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 810dd45df4ff2b2e086ee0f83be3a57ee4deec4e
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: false
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "2.40",
      "currency_code": "USD",
      "transaction_id": 1000005,
      "transaction_timestamp": "2025-08-11 14:19:18",
      "round_id": 677341,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000005",
        "history_id": "test-1000005"
      }
    },
    "request_timestamp": "2025-08-11 14:19:18",
    "hash": "test_hash_1000005"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:19",
    "hash": "56039fc6a8919bd043ca76937a9c16cb9a8e8326",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "2.40",
      "currency_code": "USD",
      "transaction_id": 1000005,
      "transaction_timestamp": "2025-08-11 14:19:18",
      "round_id": 677341,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000005",
        "history_id": "test-1000005"
      }
    },
    "request_timestamp": "2025-08-11 14:19:18",
    "hash": "test_hash_1000005"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:19",
    "hash": "56039fc6a8919bd043ca76937a9c16cb9a8e8326",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 6.128 ms - 646[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"7.02","currency_code":"USD","transaction_id":1000006,"transaction_timestamp":"2025-08-11 14:19:18","round_id":459118,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000006","history_id":"test-1000006"}},"request_timestamp":"2025-08-11 14:19:18","hash":"test_hash_1000006"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e057b606a2e-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '57ac698e80d5edb08a3026db7c84eca2d8dc5e2c',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e057b606a2e-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '7.02',
      currency_code: 'USD',
      transaction_id: 1000006,
      transaction_timestamp: '2025-08-11 14:19:18',
      round_id: 459118,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:18',
    hash: 'test_hash_1000006'
  },
  timestamp: '2025-08-11T14:19:19.819Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "7.02",
    "currency_code": "USD",
    "transaction_id": 1000006,
    "transaction_timestamp": "2025-08-11 14:19:18",
    "round_id": 459118,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000006",
      "history_id": "test-1000006"
    }
  },
  "request_timestamp": "2025-08-11 14:19:18",
  "hash": "test_hash_1000006"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "7.02",
    "currency_code": "USD",
    "transaction_id": 1000006,
    "transaction_timestamp": "2025-08-11 14:19:18",
    "round_id": 459118,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000006",
      "history_id": "test-1000006"
    }
  },
  "request_timestamp": "2025-08-11 14:19:18",
  "hash": "test_hash_1000006"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '57ac698e80d5edb08a3026db7c84eca2d8dc5e2c',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e057b606a2e-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '7.02',
      currency_code: 'USD',
      transaction_id: 1000006,
      transaction_timestamp: '2025-08-11 14:19:18',
      round_id: 459118,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:18',
    hash: 'test_hash_1000006'
  },
  timestamp: '2025-08-11T14:19:19.819Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '7.02',
    currency_code: 'USD',
    transaction_id: 1000006,
    transaction_timestamp: '2025-08-11 14:19:18',
    round_id: 459118,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000006',
      history_id: 'test-1000006'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 57ac698e80d5edb08a3026db7c84eca2d8dc5e2c
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: false
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "7.02",
      "currency_code": "USD",
      "transaction_id": 1000006,
      "transaction_timestamp": "2025-08-11 14:19:18",
      "round_id": 459118,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000006",
        "history_id": "test-1000006"
      }
    },
    "request_timestamp": "2025-08-11 14:19:18",
    "hash": "test_hash_1000006"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:19",
    "hash": "56039fc6a8919bd043ca76937a9c16cb9a8e8326",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "7.02",
      "currency_code": "USD",
      "transaction_id": 1000006,
      "transaction_timestamp": "2025-08-11 14:19:18",
      "round_id": 459118,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000006",
        "history_id": "test-1000006"
      }
    },
    "request_timestamp": "2025-08-11 14:19:18",
    "hash": "test_hash_1000006"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:19",
    "hash": "56039fc6a8919bd043ca76937a9c16cb9a8e8326",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 1.452 ms - 646[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"9.29","currency_code":"USD","transaction_id":1000018,"transaction_timestamp":"2025-08-11 14:19:21","round_id":25497,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000018","history_id":"test-1000018"}},"request_timestamp":"2025-08-11 14:19:21","hash":"test_hash_1000018"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e151d181000-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '440',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '268431cdd93586c01939bce9f754c8a08844d6e0',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e151d181000-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '9.29',
      currency_code: 'USD',
      transaction_id: 1000018,
      transaction_timestamp: '2025-08-11 14:19:21',
      round_id: 25497,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:21',
    hash: 'test_hash_1000018'
  },
  timestamp: '2025-08-11T14:19:21.873Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "9.29",
    "currency_code": "USD",
    "transaction_id": 1000018,
    "transaction_timestamp": "2025-08-11 14:19:21",
    "round_id": 25497,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000018",
      "history_id": "test-1000018"
    }
  },
  "request_timestamp": "2025-08-11 14:19:21",
  "hash": "test_hash_1000018"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "9.29",
    "currency_code": "USD",
    "transaction_id": 1000018,
    "transaction_timestamp": "2025-08-11 14:19:21",
    "round_id": 25497,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000018",
      "history_id": "test-1000018"
    }
  },
  "request_timestamp": "2025-08-11 14:19:21",
  "hash": "test_hash_1000018"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '440',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '268431cdd93586c01939bce9f754c8a08844d6e0',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e151d181000-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '9.29',
      currency_code: 'USD',
      transaction_id: 1000018,
      transaction_timestamp: '2025-08-11 14:19:21',
      round_id: 25497,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:21',
    hash: 'test_hash_1000018'
  },
  timestamp: '2025-08-11T14:19:21.873Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '9.29',
    currency_code: 'USD',
    transaction_id: 1000018,
    transaction_timestamp: '2025-08-11 14:19:21',
    round_id: 25497,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000018',
      history_id: 'test-1000018'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 268431cdd93586c01939bce9f754c8a08844d6e0
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: false
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "9.29",
      "currency_code": "USD",
      "transaction_id": 1000018,
      "transaction_timestamp": "2025-08-11 14:19:21",
      "round_id": 25497,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000018",
        "history_id": "test-1000018"
      }
    },
    "request_timestamp": "2025-08-11 14:19:21",
    "hash": "test_hash_1000018"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:21",
    "hash": "f242cd0ab84c8d13e09e2cd5f3c115e9ad5afa4e",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "9.29",
      "currency_code": "USD",
      "transaction_id": 1000018,
      "transaction_timestamp": "2025-08-11 14:19:21",
      "round_id": 25497,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000018",
        "history_id": "test-1000018"
      }
    },
    "request_timestamp": "2025-08-11 14:19:21",
    "hash": "test_hash_1000018"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:21",
    "hash": "f242cd0ab84c8d13e09e2cd5f3c115e9ad5afa4e",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 1.187 ms - 645[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"6.58","currency_code":"USD","transaction_id":1000010,"transaction_timestamp":"2025-08-11 14:19:21","round_id":149711,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000010","history_id":"test-1000010"}},"request_timestamp":"2025-08-11 14:19:21","hash":"test_hash_1000010"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e151c7d7cb0-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '0e473fc9a13b05fed587852c0df727d4013927fd',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e151c7d7cb0-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '6.58',
      currency_code: 'USD',
      transaction_id: 1000010,
      transaction_timestamp: '2025-08-11 14:19:21',
      round_id: 149711,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:21',
    hash: 'test_hash_1000010'
  },
  timestamp: '2025-08-11T14:19:21.876Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "6.58",
    "currency_code": "USD",
    "transaction_id": 1000010,
    "transaction_timestamp": "2025-08-11 14:19:21",
    "round_id": 149711,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000010",
      "history_id": "test-1000010"
    }
  },
  "request_timestamp": "2025-08-11 14:19:21",
  "hash": "test_hash_1000010"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "6.58",
    "currency_code": "USD",
    "transaction_id": 1000010,
    "transaction_timestamp": "2025-08-11 14:19:21",
    "round_id": 149711,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000010",
      "history_id": "test-1000010"
    }
  },
  "request_timestamp": "2025-08-11 14:19:21",
  "hash": "test_hash_1000010"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '0e473fc9a13b05fed587852c0df727d4013927fd',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e151c7d7cb0-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '6.58',
      currency_code: 'USD',
      transaction_id: 1000010,
      transaction_timestamp: '2025-08-11 14:19:21',
      round_id: 149711,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:21',
    hash: 'test_hash_1000010'
  },
  timestamp: '2025-08-11T14:19:21.876Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '6.58',
    currency_code: 'USD',
    transaction_id: 1000010,
    transaction_timestamp: '2025-08-11 14:19:21',
    round_id: 149711,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000010',
      history_id: 'test-1000010'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 0e473fc9a13b05fed587852c0df727d4013927fd
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: false
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "6.58",
      "currency_code": "USD",
      "transaction_id": 1000010,
      "transaction_timestamp": "2025-08-11 14:19:21",
      "round_id": 149711,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000010",
        "history_id": "test-1000010"
      }
    },
    "request_timestamp": "2025-08-11 14:19:21",
    "hash": "test_hash_1000010"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:21",
    "hash": "f242cd0ab84c8d13e09e2cd5f3c115e9ad5afa4e",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "6.58",
      "currency_code": "USD",
      "transaction_id": 1000010,
      "transaction_timestamp": "2025-08-11 14:19:21",
      "round_id": 149711,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000010",
        "history_id": "test-1000010"
      }
    },
    "request_timestamp": "2025-08-11 14:19:21",
    "hash": "test_hash_1000010"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:21",
    "hash": "f242cd0ab84c8d13e09e2cd5f3c115e9ad5afa4e",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 1.964 ms - 646[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"8.48","currency_code":"USD","transaction_id":1000019,"transaction_timestamp":"2025-08-11 14:19:21","round_id":880544,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000019","history_id":"test-1000019"}},"request_timestamp":"2025-08-11 14:19:21","hash":"test_hash_1000019"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e151e7a1015-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '73a0548dbb8d6a836612b25adc64ca73c1d2ce40',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e151e7a1015-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '8.48',
      currency_code: 'USD',
      transaction_id: 1000019,
      transaction_timestamp: '2025-08-11 14:19:21',
      round_id: 880544,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:21',
    hash: 'test_hash_1000019'
  },
  timestamp: '2025-08-11T14:19:21.880Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "8.48",
    "currency_code": "USD",
    "transaction_id": 1000019,
    "transaction_timestamp": "2025-08-11 14:19:21",
    "round_id": 880544,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000019",
      "history_id": "test-1000019"
    }
  },
  "request_timestamp": "2025-08-11 14:19:21",
  "hash": "test_hash_1000019"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "8.48",
    "currency_code": "USD",
    "transaction_id": 1000019,
    "transaction_timestamp": "2025-08-11 14:19:21",
    "round_id": 880544,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000019",
      "history_id": "test-1000019"
    }
  },
  "request_timestamp": "2025-08-11 14:19:21",
  "hash": "test_hash_1000019"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '73a0548dbb8d6a836612b25adc64ca73c1d2ce40',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e151e7a1015-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '8.48',
      currency_code: 'USD',
      transaction_id: 1000019,
      transaction_timestamp: '2025-08-11 14:19:21',
      round_id: 880544,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:21',
    hash: 'test_hash_1000019'
  },
  timestamp: '2025-08-11T14:19:21.880Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '8.48',
    currency_code: 'USD',
    transaction_id: 1000019,
    transaction_timestamp: '2025-08-11 14:19:21',
    round_id: 880544,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000019',
      history_id: 'test-1000019'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 73a0548dbb8d6a836612b25adc64ca73c1d2ce40
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: false
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "8.48",
      "currency_code": "USD",
      "transaction_id": 1000019,
      "transaction_timestamp": "2025-08-11 14:19:21",
      "round_id": 880544,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000019",
        "history_id": "test-1000019"
      }
    },
    "request_timestamp": "2025-08-11 14:19:21",
    "hash": "test_hash_1000019"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:21",
    "hash": "f242cd0ab84c8d13e09e2cd5f3c115e9ad5afa4e",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "8.48",
      "currency_code": "USD",
      "transaction_id": 1000019,
      "transaction_timestamp": "2025-08-11 14:19:21",
      "round_id": 880544,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000019",
        "history_id": "test-1000019"
      }
    },
    "request_timestamp": "2025-08-11 14:19:21",
    "hash": "test_hash_1000019"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:21",
    "hash": "f242cd0ab84c8d13e09e2cd5f3c115e9ad5afa4e",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 0.921 ms - 646[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"0.94","currency_code":"USD","transaction_id":1000015,"transaction_timestamp":"2025-08-11 14:19:21","round_id":137469,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000015","history_id":"test-1000015"}},"request_timestamp":"2025-08-11 14:19:21","hash":"test_hash_1000015"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e152f9408cd-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '47d05c7a04c4a34ba806ace2eccd8140b2405089',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e152f9408cd-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '0.94',
      currency_code: 'USD',
      transaction_id: 1000015,
      transaction_timestamp: '2025-08-11 14:19:21',
      round_id: 137469,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:21',
    hash: 'test_hash_1000015'
  },
  timestamp: '2025-08-11T14:19:21.885Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "0.94",
    "currency_code": "USD",
    "transaction_id": 1000015,
    "transaction_timestamp": "2025-08-11 14:19:21",
    "round_id": 137469,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000015",
      "history_id": "test-1000015"
    }
  },
  "request_timestamp": "2025-08-11 14:19:21",
  "hash": "test_hash_1000015"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "0.94",
    "currency_code": "USD",
    "transaction_id": 1000015,
    "transaction_timestamp": "2025-08-11 14:19:21",
    "round_id": 137469,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000015",
      "history_id": "test-1000015"
    }
  },
  "request_timestamp": "2025-08-11 14:19:21",
  "hash": "test_hash_1000015"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '47d05c7a04c4a34ba806ace2eccd8140b2405089',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e152f9408cd-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '0.94',
      currency_code: 'USD',
      transaction_id: 1000015,
      transaction_timestamp: '2025-08-11 14:19:21',
      round_id: 137469,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:21',
    hash: 'test_hash_1000015'
  },
  timestamp: '2025-08-11T14:19:21.885Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '0.94',
    currency_code: 'USD',
    transaction_id: 1000015,
    transaction_timestamp: '2025-08-11 14:19:21',
    round_id: 137469,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000015',
      history_id: 'test-1000015'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 47d05c7a04c4a34ba806ace2eccd8140b2405089
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: false
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "0.94",
      "currency_code": "USD",
      "transaction_id": 1000015,
      "transaction_timestamp": "2025-08-11 14:19:21",
      "round_id": 137469,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000015",
        "history_id": "test-1000015"
      }
    },
    "request_timestamp": "2025-08-11 14:19:21",
    "hash": "test_hash_1000015"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:21",
    "hash": "f242cd0ab84c8d13e09e2cd5f3c115e9ad5afa4e",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "0.94",
      "currency_code": "USD",
      "transaction_id": 1000015,
      "transaction_timestamp": "2025-08-11 14:19:21",
      "round_id": 137469,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000015",
        "history_id": "test-1000015"
      }
    },
    "request_timestamp": "2025-08-11 14:19:21",
    "hash": "test_hash_1000015"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:21",
    "hash": "f242cd0ab84c8d13e09e2cd5f3c115e9ad5afa4e",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 1.143 ms - 646[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"6.55","currency_code":"USD","transaction_id":1000013,"transaction_timestamp":"2025-08-11 14:19:21","round_id":438949,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000013","history_id":"test-1000013"}},"request_timestamp":"2025-08-11 14:19:21","hash":"test_hash_1000013"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e152c32f7d9-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': 'b8942188ba13799923f5903d7cafd18baeeed7a3',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e152c32f7d9-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '6.55',
      currency_code: 'USD',
      transaction_id: 1000013,
      transaction_timestamp: '2025-08-11 14:19:21',
      round_id: 438949,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:21',
    hash: 'test_hash_1000013'
  },
  timestamp: '2025-08-11T14:19:21.888Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "6.55",
    "currency_code": "USD",
    "transaction_id": 1000013,
    "transaction_timestamp": "2025-08-11 14:19:21",
    "round_id": 438949,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000013",
      "history_id": "test-1000013"
    }
  },
  "request_timestamp": "2025-08-11 14:19:21",
  "hash": "test_hash_1000013"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "6.55",
    "currency_code": "USD",
    "transaction_id": 1000013,
    "transaction_timestamp": "2025-08-11 14:19:21",
    "round_id": 438949,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000013",
      "history_id": "test-1000013"
    }
  },
  "request_timestamp": "2025-08-11 14:19:21",
  "hash": "test_hash_1000013"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': 'b8942188ba13799923f5903d7cafd18baeeed7a3',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e152c32f7d9-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '6.55',
      currency_code: 'USD',
      transaction_id: 1000013,
      transaction_timestamp: '2025-08-11 14:19:21',
      round_id: 438949,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:21',
    hash: 'test_hash_1000013'
  },
  timestamp: '2025-08-11T14:19:21.888Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '6.55',
    currency_code: 'USD',
    transaction_id: 1000013,
    transaction_timestamp: '2025-08-11 14:19:21',
    round_id: 438949,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000013',
      history_id: 'test-1000013'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: b8942188ba13799923f5903d7cafd18baeeed7a3
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: false
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "6.55",
      "currency_code": "USD",
      "transaction_id": 1000013,
      "transaction_timestamp": "2025-08-11 14:19:21",
      "round_id": 438949,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000013",
        "history_id": "test-1000013"
      }
    },
    "request_timestamp": "2025-08-11 14:19:21",
    "hash": "test_hash_1000013"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:21",
    "hash": "f242cd0ab84c8d13e09e2cd5f3c115e9ad5afa4e",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "6.55",
      "currency_code": "USD",
      "transaction_id": 1000013,
      "transaction_timestamp": "2025-08-11 14:19:21",
      "round_id": 438949,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000013",
        "history_id": "test-1000013"
      }
    },
    "request_timestamp": "2025-08-11 14:19:21",
    "hash": "test_hash_1000013"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:21",
    "hash": "f242cd0ab84c8d13e09e2cd5f3c115e9ad5afa4e",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 1.133 ms - 646[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"10.07","currency_code":"USD","transaction_id":1000011,"transaction_timestamp":"2025-08-11 14:19:21","round_id":719460,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000011","history_id":"test-1000011"}},"request_timestamp":"2025-08-11 14:19:21","hash":"test_hash_1000011"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e151c846a2e-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '442',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '49c216da6a6d9ef6be3beaa52405474f9d7ebbb8',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e151c846a2e-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '10.07',
      currency_code: 'USD',
      transaction_id: 1000011,
      transaction_timestamp: '2025-08-11 14:19:21',
      round_id: 719460,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:21',
    hash: 'test_hash_1000011'
  },
  timestamp: '2025-08-11T14:19:21.891Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "10.07",
    "currency_code": "USD",
    "transaction_id": 1000011,
    "transaction_timestamp": "2025-08-11 14:19:21",
    "round_id": 719460,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000011",
      "history_id": "test-1000011"
    }
  },
  "request_timestamp": "2025-08-11 14:19:21",
  "hash": "test_hash_1000011"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "10.07",
    "currency_code": "USD",
    "transaction_id": 1000011,
    "transaction_timestamp": "2025-08-11 14:19:21",
    "round_id": 719460,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000011",
      "history_id": "test-1000011"
    }
  },
  "request_timestamp": "2025-08-11 14:19:21",
  "hash": "test_hash_1000011"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '442',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '49c216da6a6d9ef6be3beaa52405474f9d7ebbb8',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e151c846a2e-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '10.07',
      currency_code: 'USD',
      transaction_id: 1000011,
      transaction_timestamp: '2025-08-11 14:19:21',
      round_id: 719460,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:21',
    hash: 'test_hash_1000011'
  },
  timestamp: '2025-08-11T14:19:21.891Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '10.07',
    currency_code: 'USD',
    transaction_id: 1000011,
    transaction_timestamp: '2025-08-11 14:19:21',
    round_id: 719460,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000011',
      history_id: 'test-1000011'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 49c216da6a6d9ef6be3beaa52405474f9d7ebbb8
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: false
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "10.07",
      "currency_code": "USD",
      "transaction_id": 1000011,
      "transaction_timestamp": "2025-08-11 14:19:21",
      "round_id": 719460,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000011",
        "history_id": "test-1000011"
      }
    },
    "request_timestamp": "2025-08-11 14:19:21",
    "hash": "test_hash_1000011"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:21",
    "hash": "f242cd0ab84c8d13e09e2cd5f3c115e9ad5afa4e",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "10.07",
      "currency_code": "USD",
      "transaction_id": 1000011,
      "transaction_timestamp": "2025-08-11 14:19:21",
      "round_id": 719460,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000011",
        "history_id": "test-1000011"
      }
    },
    "request_timestamp": "2025-08-11 14:19:21",
    "hash": "test_hash_1000011"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:21",
    "hash": "f242cd0ab84c8d13e09e2cd5f3c115e9ad5afa4e",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 1.096 ms - 647[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"4.81","currency_code":"USD","transaction_id":1000012,"transaction_timestamp":"2025-08-11 14:19:21","round_id":760203,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000012","history_id":"test-1000012"}},"request_timestamp":"2025-08-11 14:19:21","hash":"test_hash_1000012"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e151d712b7d-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '058ea8d63a0e06393722cb04f1b24b33966291b0',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e151d712b7d-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '4.81',
      currency_code: 'USD',
      transaction_id: 1000012,
      transaction_timestamp: '2025-08-11 14:19:21',
      round_id: 760203,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:21',
    hash: 'test_hash_1000012'
  },
  timestamp: '2025-08-11T14:19:21.894Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "4.81",
    "currency_code": "USD",
    "transaction_id": 1000012,
    "transaction_timestamp": "2025-08-11 14:19:21",
    "round_id": 760203,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000012",
      "history_id": "test-1000012"
    }
  },
  "request_timestamp": "2025-08-11 14:19:21",
  "hash": "test_hash_1000012"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "4.81",
    "currency_code": "USD",
    "transaction_id": 1000012,
    "transaction_timestamp": "2025-08-11 14:19:21",
    "round_id": 760203,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000012",
      "history_id": "test-1000012"
    }
  },
  "request_timestamp": "2025-08-11 14:19:21",
  "hash": "test_hash_1000012"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '058ea8d63a0e06393722cb04f1b24b33966291b0',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e151d712b7d-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '4.81',
      currency_code: 'USD',
      transaction_id: 1000012,
      transaction_timestamp: '2025-08-11 14:19:21',
      round_id: 760203,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:21',
    hash: 'test_hash_1000012'
  },
  timestamp: '2025-08-11T14:19:21.894Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '4.81',
    currency_code: 'USD',
    transaction_id: 1000012,
    transaction_timestamp: '2025-08-11 14:19:21',
    round_id: 760203,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000012',
      history_id: 'test-1000012'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 058ea8d63a0e06393722cb04f1b24b33966291b0
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: false
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "4.81",
      "currency_code": "USD",
      "transaction_id": 1000012,
      "transaction_timestamp": "2025-08-11 14:19:21",
      "round_id": 760203,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000012",
        "history_id": "test-1000012"
      }
    },
    "request_timestamp": "2025-08-11 14:19:21",
    "hash": "test_hash_1000012"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:21",
    "hash": "f242cd0ab84c8d13e09e2cd5f3c115e9ad5afa4e",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "4.81",
      "currency_code": "USD",
      "transaction_id": 1000012,
      "transaction_timestamp": "2025-08-11 14:19:21",
      "round_id": 760203,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000012",
        "history_id": "test-1000012"
      }
    },
    "request_timestamp": "2025-08-11 14:19:21",
    "hash": "test_hash_1000012"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:21",
    "hash": "f242cd0ab84c8d13e09e2cd5f3c115e9ad5afa4e",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 1.201 ms - 646[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"9.66","currency_code":"USD","transaction_id":1000014,"transaction_timestamp":"2025-08-11 14:19:21","round_id":603973,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000014","history_id":"test-1000014"}},"request_timestamp":"2025-08-11 14:19:21","hash":"test_hash_1000014"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e152cba2aa6-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': 'c7b051831d18514d3352f68aafa8fdf8ad7d8e96',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e152cba2aa6-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '9.66',
      currency_code: 'USD',
      transaction_id: 1000014,
      transaction_timestamp: '2025-08-11 14:19:21',
      round_id: 603973,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:21',
    hash: 'test_hash_1000014'
  },
  timestamp: '2025-08-11T14:19:21.899Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "9.66",
    "currency_code": "USD",
    "transaction_id": 1000014,
    "transaction_timestamp": "2025-08-11 14:19:21",
    "round_id": 603973,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000014",
      "history_id": "test-1000014"
    }
  },
  "request_timestamp": "2025-08-11 14:19:21",
  "hash": "test_hash_1000014"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "9.66",
    "currency_code": "USD",
    "transaction_id": 1000014,
    "transaction_timestamp": "2025-08-11 14:19:21",
    "round_id": 603973,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000014",
      "history_id": "test-1000014"
    }
  },
  "request_timestamp": "2025-08-11 14:19:21",
  "hash": "test_hash_1000014"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': 'c7b051831d18514d3352f68aafa8fdf8ad7d8e96',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e152cba2aa6-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '9.66',
      currency_code: 'USD',
      transaction_id: 1000014,
      transaction_timestamp: '2025-08-11 14:19:21',
      round_id: 603973,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:21',
    hash: 'test_hash_1000014'
  },
  timestamp: '2025-08-11T14:19:21.900Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '9.66',
    currency_code: 'USD',
    transaction_id: 1000014,
    transaction_timestamp: '2025-08-11 14:19:21',
    round_id: 603973,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000014',
      history_id: 'test-1000014'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: c7b051831d18514d3352f68aafa8fdf8ad7d8e96
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: false
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "9.66",
      "currency_code": "USD",
      "transaction_id": 1000014,
      "transaction_timestamp": "2025-08-11 14:19:21",
      "round_id": 603973,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000014",
        "history_id": "test-1000014"
      }
    },
    "request_timestamp": "2025-08-11 14:19:21",
    "hash": "test_hash_1000014"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:21",
    "hash": "f242cd0ab84c8d13e09e2cd5f3c115e9ad5afa4e",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "9.66",
      "currency_code": "USD",
      "transaction_id": 1000014,
      "transaction_timestamp": "2025-08-11 14:19:21",
      "round_id": 603973,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000014",
        "history_id": "test-1000014"
      }
    },
    "request_timestamp": "2025-08-11 14:19:21",
    "hash": "test_hash_1000014"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:21",
    "hash": "f242cd0ab84c8d13e09e2cd5f3c115e9ad5afa4e",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 1.975 ms - 646[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"0.81","currency_code":"USD","transaction_id":1000016,"transaction_timestamp":"2025-08-11 14:19:21","round_id":367284,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000016","history_id":"test-1000016"}},"request_timestamp":"2025-08-11 14:19:21","hash":"test_hash_1000016"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e152c17f7db-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '1cc978b72620115bb2665b5c1250b35400974128',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e152c17f7db-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '0.81',
      currency_code: 'USD',
      transaction_id: 1000016,
      transaction_timestamp: '2025-08-11 14:19:21',
      round_id: 367284,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:21',
    hash: 'test_hash_1000016'
  },
  timestamp: '2025-08-11T14:19:21.904Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "0.81",
    "currency_code": "USD",
    "transaction_id": 1000016,
    "transaction_timestamp": "2025-08-11 14:19:21",
    "round_id": 367284,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000016",
      "history_id": "test-1000016"
    }
  },
  "request_timestamp": "2025-08-11 14:19:21",
  "hash": "test_hash_1000016"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "0.81",
    "currency_code": "USD",
    "transaction_id": 1000016,
    "transaction_timestamp": "2025-08-11 14:19:21",
    "round_id": 367284,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000016",
      "history_id": "test-1000016"
    }
  },
  "request_timestamp": "2025-08-11 14:19:21",
  "hash": "test_hash_1000016"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '1cc978b72620115bb2665b5c1250b35400974128',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e152c17f7db-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '0.81',
      currency_code: 'USD',
      transaction_id: 1000016,
      transaction_timestamp: '2025-08-11 14:19:21',
      round_id: 367284,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:21',
    hash: 'test_hash_1000016'
  },
  timestamp: '2025-08-11T14:19:21.905Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '0.81',
    currency_code: 'USD',
    transaction_id: 1000016,
    transaction_timestamp: '2025-08-11 14:19:21',
    round_id: 367284,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000016',
      history_id: 'test-1000016'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 1cc978b72620115bb2665b5c1250b35400974128
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: false
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "0.81",
      "currency_code": "USD",
      "transaction_id": 1000016,
      "transaction_timestamp": "2025-08-11 14:19:21",
      "round_id": 367284,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000016",
        "history_id": "test-1000016"
      }
    },
    "request_timestamp": "2025-08-11 14:19:21",
    "hash": "test_hash_1000016"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:21",
    "hash": "f242cd0ab84c8d13e09e2cd5f3c115e9ad5afa4e",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "0.81",
      "currency_code": "USD",
      "transaction_id": 1000016,
      "transaction_timestamp": "2025-08-11 14:19:21",
      "round_id": 367284,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000016",
        "history_id": "test-1000016"
      }
    },
    "request_timestamp": "2025-08-11 14:19:21",
    "hash": "test_hash_1000016"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:21",
    "hash": "f242cd0ab84c8d13e09e2cd5f3c115e9ad5afa4e",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 2.645 ms - 646[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"3.30","currency_code":"USD","transaction_id":1000017,"transaction_timestamp":"2025-08-11 14:19:21","round_id":263976,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000017","history_id":"test-1000017"}},"request_timestamp":"2025-08-11 14:19:21","hash":"test_hash_1000017"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e151b3c2b83-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '3e81533bdfcf49144e0cfff7c48c82e77dd5693d',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e151b3c2b83-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '3.30',
      currency_code: 'USD',
      transaction_id: 1000017,
      transaction_timestamp: '2025-08-11 14:19:21',
      round_id: 263976,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:21',
    hash: 'test_hash_1000017'
  },
  timestamp: '2025-08-11T14:19:21.908Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "3.30",
    "currency_code": "USD",
    "transaction_id": 1000017,
    "transaction_timestamp": "2025-08-11 14:19:21",
    "round_id": 263976,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000017",
      "history_id": "test-1000017"
    }
  },
  "request_timestamp": "2025-08-11 14:19:21",
  "hash": "test_hash_1000017"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "3.30",
    "currency_code": "USD",
    "transaction_id": 1000017,
    "transaction_timestamp": "2025-08-11 14:19:21",
    "round_id": 263976,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000017",
      "history_id": "test-1000017"
    }
  },
  "request_timestamp": "2025-08-11 14:19:21",
  "hash": "test_hash_1000017"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '3e81533bdfcf49144e0cfff7c48c82e77dd5693d',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e151b3c2b83-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '3.30',
      currency_code: 'USD',
      transaction_id: 1000017,
      transaction_timestamp: '2025-08-11 14:19:21',
      round_id: 263976,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:21',
    hash: 'test_hash_1000017'
  },
  timestamp: '2025-08-11T14:19:21.909Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '3.30',
    currency_code: 'USD',
    transaction_id: 1000017,
    transaction_timestamp: '2025-08-11 14:19:21',
    round_id: 263976,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000017',
      history_id: 'test-1000017'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 3e81533bdfcf49144e0cfff7c48c82e77dd5693d
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: false
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "3.30",
      "currency_code": "USD",
      "transaction_id": 1000017,
      "transaction_timestamp": "2025-08-11 14:19:21",
      "round_id": 263976,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000017",
        "history_id": "test-1000017"
      }
    },
    "request_timestamp": "2025-08-11 14:19:21",
    "hash": "test_hash_1000017"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:21",
    "hash": "f242cd0ab84c8d13e09e2cd5f3c115e9ad5afa4e",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "3.30",
      "currency_code": "USD",
      "transaction_id": 1000017,
      "transaction_timestamp": "2025-08-11 14:19:21",
      "round_id": 263976,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000017",
        "history_id": "test-1000017"
      }
    },
    "request_timestamp": "2025-08-11 14:19:21",
    "hash": "test_hash_1000017"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:21",
    "hash": "f242cd0ab84c8d13e09e2cd5f3c115e9ad5afa4e",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 1.479 ms - 646[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"2.63","currency_code":"USD","transaction_id":1000029,"transaction_timestamp":"2025-08-11 14:19:23","round_id":893310,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000029","history_id":"test-1000029"}},"request_timestamp":"2025-08-11 14:19:23","hash":"test_hash_1000029"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e1e0b7c1000-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '5d922685b6ef8949e469ff305a63642dfdfc9dcb',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e1e0b7c1000-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '2.63',
      currency_code: 'USD',
      transaction_id: 1000029,
      transaction_timestamp: '2025-08-11 14:19:23',
      round_id: 893310,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:23',
    hash: 'test_hash_1000029'
  },
  timestamp: '2025-08-11T14:19:23.305Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "2.63",
    "currency_code": "USD",
    "transaction_id": 1000029,
    "transaction_timestamp": "2025-08-11 14:19:23",
    "round_id": 893310,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000029",
      "history_id": "test-1000029"
    }
  },
  "request_timestamp": "2025-08-11 14:19:23",
  "hash": "test_hash_1000029"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "2.63",
    "currency_code": "USD",
    "transaction_id": 1000029,
    "transaction_timestamp": "2025-08-11 14:19:23",
    "round_id": 893310,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000029",
      "history_id": "test-1000029"
    }
  },
  "request_timestamp": "2025-08-11 14:19:23",
  "hash": "test_hash_1000029"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '5d922685b6ef8949e469ff305a63642dfdfc9dcb',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e1e0b7c1000-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '2.63',
      currency_code: 'USD',
      transaction_id: 1000029,
      transaction_timestamp: '2025-08-11 14:19:23',
      round_id: 893310,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:23',
    hash: 'test_hash_1000029'
  },
  timestamp: '2025-08-11T14:19:23.306Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '2.63',
    currency_code: 'USD',
    transaction_id: 1000029,
    transaction_timestamp: '2025-08-11 14:19:23',
    round_id: 893310,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000029',
      history_id: 'test-1000029'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 5d922685b6ef8949e469ff305a63642dfdfc9dcb
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: false
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "2.63",
      "currency_code": "USD",
      "transaction_id": 1000029,
      "transaction_timestamp": "2025-08-11 14:19:23",
      "round_id": 893310,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000029",
        "history_id": "test-1000029"
      }
    },
    "request_timestamp": "2025-08-11 14:19:23",
    "hash": "test_hash_1000029"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:23",
    "hash": "9a54d4063fdb119942492e0f075f2a7c30c6f1a8",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "2.63",
      "currency_code": "USD",
      "transaction_id": 1000029,
      "transaction_timestamp": "2025-08-11 14:19:23",
      "round_id": 893310,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000029",
        "history_id": "test-1000029"
      }
    },
    "request_timestamp": "2025-08-11 14:19:23",
    "hash": "test_hash_1000029"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:23",
    "hash": "9a54d4063fdb119942492e0f075f2a7c30c6f1a8",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 1.557 ms - 646[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"0.32","currency_code":"USD","transaction_id":1000022,"transaction_timestamp":"2025-08-11 14:19:23","round_id":272068,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000022","history_id":"test-1000022"}},"request_timestamp":"2025-08-11 14:19:23","hash":"test_hash_1000022"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e1e0d3c7cb0-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '5ff5e7bb8cea06c74bd3076ac57e45befba7ccb4',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e1e0d3c7cb0-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '0.32',
      currency_code: 'USD',
      transaction_id: 1000022,
      transaction_timestamp: '2025-08-11 14:19:23',
      round_id: 272068,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:23',
    hash: 'test_hash_1000022'
  },
  timestamp: '2025-08-11T14:19:23.310Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "0.32",
    "currency_code": "USD",
    "transaction_id": 1000022,
    "transaction_timestamp": "2025-08-11 14:19:23",
    "round_id": 272068,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000022",
      "history_id": "test-1000022"
    }
  },
  "request_timestamp": "2025-08-11 14:19:23",
  "hash": "test_hash_1000022"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "0.32",
    "currency_code": "USD",
    "transaction_id": 1000022,
    "transaction_timestamp": "2025-08-11 14:19:23",
    "round_id": 272068,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000022",
      "history_id": "test-1000022"
    }
  },
  "request_timestamp": "2025-08-11 14:19:23",
  "hash": "test_hash_1000022"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '5ff5e7bb8cea06c74bd3076ac57e45befba7ccb4',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e1e0d3c7cb0-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '0.32',
      currency_code: 'USD',
      transaction_id: 1000022,
      transaction_timestamp: '2025-08-11 14:19:23',
      round_id: 272068,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:23',
    hash: 'test_hash_1000022'
  },
  timestamp: '2025-08-11T14:19:23.311Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '0.32',
    currency_code: 'USD',
    transaction_id: 1000022,
    transaction_timestamp: '2025-08-11 14:19:23',
    round_id: 272068,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000022',
      history_id: 'test-1000022'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 5ff5e7bb8cea06c74bd3076ac57e45befba7ccb4
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: false
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "0.32",
      "currency_code": "USD",
      "transaction_id": 1000022,
      "transaction_timestamp": "2025-08-11 14:19:23",
      "round_id": 272068,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000022",
        "history_id": "test-1000022"
      }
    },
    "request_timestamp": "2025-08-11 14:19:23",
    "hash": "test_hash_1000022"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:23",
    "hash": "9a54d4063fdb119942492e0f075f2a7c30c6f1a8",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "0.32",
      "currency_code": "USD",
      "transaction_id": 1000022,
      "transaction_timestamp": "2025-08-11 14:19:23",
      "round_id": 272068,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000022",
        "history_id": "test-1000022"
      }
    },
    "request_timestamp": "2025-08-11 14:19:23",
    "hash": "test_hash_1000022"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:23",
    "hash": "9a54d4063fdb119942492e0f075f2a7c30c6f1a8",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 1.267 ms - 646[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"3.30","currency_code":"USD","transaction_id":1000028,"transaction_timestamp":"2025-08-11 14:19:23","round_id":585179,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000028","history_id":"test-1000028"}},"request_timestamp":"2025-08-11 14:19:23","hash":"test_hash_1000028"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e1e0f5f1015-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': 'f4297eeeafced6acc598543b8ffc4715b2283234',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e1e0f5f1015-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '3.30',
      currency_code: 'USD',
      transaction_id: 1000028,
      transaction_timestamp: '2025-08-11 14:19:23',
      round_id: 585179,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:23',
    hash: 'test_hash_1000028'
  },
  timestamp: '2025-08-11T14:19:23.313Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "3.30",
    "currency_code": "USD",
    "transaction_id": 1000028,
    "transaction_timestamp": "2025-08-11 14:19:23",
    "round_id": 585179,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000028",
      "history_id": "test-1000028"
    }
  },
  "request_timestamp": "2025-08-11 14:19:23",
  "hash": "test_hash_1000028"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "3.30",
    "currency_code": "USD",
    "transaction_id": 1000028,
    "transaction_timestamp": "2025-08-11 14:19:23",
    "round_id": 585179,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000028",
      "history_id": "test-1000028"
    }
  },
  "request_timestamp": "2025-08-11 14:19:23",
  "hash": "test_hash_1000028"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': 'f4297eeeafced6acc598543b8ffc4715b2283234',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e1e0f5f1015-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '3.30',
      currency_code: 'USD',
      transaction_id: 1000028,
      transaction_timestamp: '2025-08-11 14:19:23',
      round_id: 585179,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:23',
    hash: 'test_hash_1000028'
  },
  timestamp: '2025-08-11T14:19:23.314Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '3.30',
    currency_code: 'USD',
    transaction_id: 1000028,
    transaction_timestamp: '2025-08-11 14:19:23',
    round_id: 585179,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000028',
      history_id: 'test-1000028'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: f4297eeeafced6acc598543b8ffc4715b2283234
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: false
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "3.30",
      "currency_code": "USD",
      "transaction_id": 1000028,
      "transaction_timestamp": "2025-08-11 14:19:23",
      "round_id": 585179,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000028",
        "history_id": "test-1000028"
      }
    },
    "request_timestamp": "2025-08-11 14:19:23",
    "hash": "test_hash_1000028"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:23",
    "hash": "9a54d4063fdb119942492e0f075f2a7c30c6f1a8",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "3.30",
      "currency_code": "USD",
      "transaction_id": 1000028,
      "transaction_timestamp": "2025-08-11 14:19:23",
      "round_id": 585179,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000028",
        "history_id": "test-1000028"
      }
    },
    "request_timestamp": "2025-08-11 14:19:23",
    "hash": "test_hash_1000028"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:23",
    "hash": "9a54d4063fdb119942492e0f075f2a7c30c6f1a8",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 1.543 ms - 646[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"7.06","currency_code":"USD","transaction_id":1000027,"transaction_timestamp":"2025-08-11 14:19:23","round_id":62386,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000027","history_id":"test-1000027"}},"request_timestamp":"2025-08-11 14:19:23","hash":"test_hash_1000027"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e1e196508cd-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '440',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '6949f214864bd5b45288532dc5d42b05d2c2d2af',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e1e196508cd-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '7.06',
      currency_code: 'USD',
      transaction_id: 1000027,
      transaction_timestamp: '2025-08-11 14:19:23',
      round_id: 62386,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:23',
    hash: 'test_hash_1000027'
  },
  timestamp: '2025-08-11T14:19:23.317Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "7.06",
    "currency_code": "USD",
    "transaction_id": 1000027,
    "transaction_timestamp": "2025-08-11 14:19:23",
    "round_id": 62386,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000027",
      "history_id": "test-1000027"
    }
  },
  "request_timestamp": "2025-08-11 14:19:23",
  "hash": "test_hash_1000027"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "7.06",
    "currency_code": "USD",
    "transaction_id": 1000027,
    "transaction_timestamp": "2025-08-11 14:19:23",
    "round_id": 62386,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000027",
      "history_id": "test-1000027"
    }
  },
  "request_timestamp": "2025-08-11 14:19:23",
  "hash": "test_hash_1000027"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '440',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '6949f214864bd5b45288532dc5d42b05d2c2d2af',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e1e196508cd-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '7.06',
      currency_code: 'USD',
      transaction_id: 1000027,
      transaction_timestamp: '2025-08-11 14:19:23',
      round_id: 62386,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:23',
    hash: 'test_hash_1000027'
  },
  timestamp: '2025-08-11T14:19:23.318Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '7.06',
    currency_code: 'USD',
    transaction_id: 1000027,
    transaction_timestamp: '2025-08-11 14:19:23',
    round_id: 62386,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000027',
      history_id: 'test-1000027'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 6949f214864bd5b45288532dc5d42b05d2c2d2af
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: false
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "7.06",
      "currency_code": "USD",
      "transaction_id": 1000027,
      "transaction_timestamp": "2025-08-11 14:19:23",
      "round_id": 62386,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000027",
        "history_id": "test-1000027"
      }
    },
    "request_timestamp": "2025-08-11 14:19:23",
    "hash": "test_hash_1000027"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:23",
    "hash": "9a54d4063fdb119942492e0f075f2a7c30c6f1a8",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "7.06",
      "currency_code": "USD",
      "transaction_id": 1000027,
      "transaction_timestamp": "2025-08-11 14:19:23",
      "round_id": 62386,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000027",
        "history_id": "test-1000027"
      }
    },
    "request_timestamp": "2025-08-11 14:19:23",
    "hash": "test_hash_1000027"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:23",
    "hash": "9a54d4063fdb119942492e0f075f2a7c30c6f1a8",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 1.311 ms - 645[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"1.27","currency_code":"USD","transaction_id":1000026,"transaction_timestamp":"2025-08-11 14:19:23","round_id":491170,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000026","history_id":"test-1000026"}},"request_timestamp":"2025-08-11 14:19:23","hash":"test_hash_1000026"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e1e1b67f7d9-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '6756824cdee0d9ef5e164430e0b445e77c9d18a5',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e1e1b67f7d9-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '1.27',
      currency_code: 'USD',
      transaction_id: 1000026,
      transaction_timestamp: '2025-08-11 14:19:23',
      round_id: 491170,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:23',
    hash: 'test_hash_1000026'
  },
  timestamp: '2025-08-11T14:19:23.321Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "1.27",
    "currency_code": "USD",
    "transaction_id": 1000026,
    "transaction_timestamp": "2025-08-11 14:19:23",
    "round_id": 491170,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000026",
      "history_id": "test-1000026"
    }
  },
  "request_timestamp": "2025-08-11 14:19:23",
  "hash": "test_hash_1000026"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "1.27",
    "currency_code": "USD",
    "transaction_id": 1000026,
    "transaction_timestamp": "2025-08-11 14:19:23",
    "round_id": 491170,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000026",
      "history_id": "test-1000026"
    }
  },
  "request_timestamp": "2025-08-11 14:19:23",
  "hash": "test_hash_1000026"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '6756824cdee0d9ef5e164430e0b445e77c9d18a5',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e1e1b67f7d9-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '1.27',
      currency_code: 'USD',
      transaction_id: 1000026,
      transaction_timestamp: '2025-08-11 14:19:23',
      round_id: 491170,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:23',
    hash: 'test_hash_1000026'
  },
  timestamp: '2025-08-11T14:19:23.321Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '1.27',
    currency_code: 'USD',
    transaction_id: 1000026,
    transaction_timestamp: '2025-08-11 14:19:23',
    round_id: 491170,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000026',
      history_id: 'test-1000026'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 6756824cdee0d9ef5e164430e0b445e77c9d18a5
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: false
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "1.27",
      "currency_code": "USD",
      "transaction_id": 1000026,
      "transaction_timestamp": "2025-08-11 14:19:23",
      "round_id": 491170,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000026",
        "history_id": "test-1000026"
      }
    },
    "request_timestamp": "2025-08-11 14:19:23",
    "hash": "test_hash_1000026"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:23",
    "hash": "9a54d4063fdb119942492e0f075f2a7c30c6f1a8",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "1.27",
      "currency_code": "USD",
      "transaction_id": 1000026,
      "transaction_timestamp": "2025-08-11 14:19:23",
      "round_id": 491170,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000026",
        "history_id": "test-1000026"
      }
    },
    "request_timestamp": "2025-08-11 14:19:23",
    "hash": "test_hash_1000026"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:23",
    "hash": "9a54d4063fdb119942492e0f075f2a7c30c6f1a8",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 0.968 ms - 646[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"5.09","currency_code":"USD","transaction_id":1000021,"transaction_timestamp":"2025-08-11 14:19:23","round_id":156630,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000021","history_id":"test-1000021"}},"request_timestamp":"2025-08-11 14:19:23","hash":"test_hash_1000021"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e1e0cfc6a2e-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '581ed8080fd52ef653323859e39c71cfcaab83c9',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e1e0cfc6a2e-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '5.09',
      currency_code: 'USD',
      transaction_id: 1000021,
      transaction_timestamp: '2025-08-11 14:19:23',
      round_id: 156630,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:23',
    hash: 'test_hash_1000021'
  },
  timestamp: '2025-08-11T14:19:23.325Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "5.09",
    "currency_code": "USD",
    "transaction_id": 1000021,
    "transaction_timestamp": "2025-08-11 14:19:23",
    "round_id": 156630,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000021",
      "history_id": "test-1000021"
    }
  },
  "request_timestamp": "2025-08-11 14:19:23",
  "hash": "test_hash_1000021"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "5.09",
    "currency_code": "USD",
    "transaction_id": 1000021,
    "transaction_timestamp": "2025-08-11 14:19:23",
    "round_id": 156630,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000021",
      "history_id": "test-1000021"
    }
  },
  "request_timestamp": "2025-08-11 14:19:23",
  "hash": "test_hash_1000021"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '581ed8080fd52ef653323859e39c71cfcaab83c9',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e1e0cfc6a2e-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '5.09',
      currency_code: 'USD',
      transaction_id: 1000021,
      transaction_timestamp: '2025-08-11 14:19:23',
      round_id: 156630,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:23',
    hash: 'test_hash_1000021'
  },
  timestamp: '2025-08-11T14:19:23.326Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '5.09',
    currency_code: 'USD',
    transaction_id: 1000021,
    transaction_timestamp: '2025-08-11 14:19:23',
    round_id: 156630,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000021',
      history_id: 'test-1000021'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 581ed8080fd52ef653323859e39c71cfcaab83c9
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: false
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "5.09",
      "currency_code": "USD",
      "transaction_id": 1000021,
      "transaction_timestamp": "2025-08-11 14:19:23",
      "round_id": 156630,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000021",
        "history_id": "test-1000021"
      }
    },
    "request_timestamp": "2025-08-11 14:19:23",
    "hash": "test_hash_1000021"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:23",
    "hash": "9a54d4063fdb119942492e0f075f2a7c30c6f1a8",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "5.09",
      "currency_code": "USD",
      "transaction_id": 1000021,
      "transaction_timestamp": "2025-08-11 14:19:23",
      "round_id": 156630,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000021",
        "history_id": "test-1000021"
      }
    },
    "request_timestamp": "2025-08-11 14:19:23",
    "hash": "test_hash_1000021"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:23",
    "hash": "9a54d4063fdb119942492e0f075f2a7c30c6f1a8",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 2.779 ms - 646[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"9.49","currency_code":"USD","transaction_id":1000025,"transaction_timestamp":"2025-08-11 14:19:23","round_id":656177,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000025","history_id":"test-1000025"}},"request_timestamp":"2025-08-11 14:19:23","hash":"test_hash_1000025"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e1e08152b7d-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': 'd5673cea3cd3ebbed8e758987573528024696698',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e1e08152b7d-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '9.49',
      currency_code: 'USD',
      transaction_id: 1000025,
      transaction_timestamp: '2025-08-11 14:19:23',
      round_id: 656177,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:23',
    hash: 'test_hash_1000025'
  },
  timestamp: '2025-08-11T14:19:23.329Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "9.49",
    "currency_code": "USD",
    "transaction_id": 1000025,
    "transaction_timestamp": "2025-08-11 14:19:23",
    "round_id": 656177,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000025",
      "history_id": "test-1000025"
    }
  },
  "request_timestamp": "2025-08-11 14:19:23",
  "hash": "test_hash_1000025"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "9.49",
    "currency_code": "USD",
    "transaction_id": 1000025,
    "transaction_timestamp": "2025-08-11 14:19:23",
    "round_id": 656177,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000025",
      "history_id": "test-1000025"
    }
  },
  "request_timestamp": "2025-08-11 14:19:23",
  "hash": "test_hash_1000025"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': 'd5673cea3cd3ebbed8e758987573528024696698',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e1e08152b7d-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '9.49',
      currency_code: 'USD',
      transaction_id: 1000025,
      transaction_timestamp: '2025-08-11 14:19:23',
      round_id: 656177,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:23',
    hash: 'test_hash_1000025'
  },
  timestamp: '2025-08-11T14:19:23.329Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '9.49',
    currency_code: 'USD',
    transaction_id: 1000025,
    transaction_timestamp: '2025-08-11 14:19:23',
    round_id: 656177,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000025',
      history_id: 'test-1000025'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: d5673cea3cd3ebbed8e758987573528024696698
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: false
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "9.49",
      "currency_code": "USD",
      "transaction_id": 1000025,
      "transaction_timestamp": "2025-08-11 14:19:23",
      "round_id": 656177,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000025",
        "history_id": "test-1000025"
      }
    },
    "request_timestamp": "2025-08-11 14:19:23",
    "hash": "test_hash_1000025"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:23",
    "hash": "9a54d4063fdb119942492e0f075f2a7c30c6f1a8",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "9.49",
      "currency_code": "USD",
      "transaction_id": 1000025,
      "transaction_timestamp": "2025-08-11 14:19:23",
      "round_id": 656177,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000025",
        "history_id": "test-1000025"
      }
    },
    "request_timestamp": "2025-08-11 14:19:23",
    "hash": "test_hash_1000025"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:23",
    "hash": "9a54d4063fdb119942492e0f075f2a7c30c6f1a8",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 1.322 ms - 646[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"4.35","currency_code":"USD","transaction_id":1000023,"transaction_timestamp":"2025-08-11 14:19:23","round_id":448644,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000023","history_id":"test-1000023"}},"request_timestamp":"2025-08-11 14:19:23","hash":"test_hash_1000023"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e1e1ce82aa6-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': 'c65a12916fa7ce007deadff5cbd967513a8ad43e',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e1e1ce82aa6-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '4.35',
      currency_code: 'USD',
      transaction_id: 1000023,
      transaction_timestamp: '2025-08-11 14:19:23',
      round_id: 448644,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:23',
    hash: 'test_hash_1000023'
  },
  timestamp: '2025-08-11T14:19:23.333Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "4.35",
    "currency_code": "USD",
    "transaction_id": 1000023,
    "transaction_timestamp": "2025-08-11 14:19:23",
    "round_id": 448644,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000023",
      "history_id": "test-1000023"
    }
  },
  "request_timestamp": "2025-08-11 14:19:23",
  "hash": "test_hash_1000023"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "4.35",
    "currency_code": "USD",
    "transaction_id": 1000023,
    "transaction_timestamp": "2025-08-11 14:19:23",
    "round_id": 448644,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000023",
      "history_id": "test-1000023"
    }
  },
  "request_timestamp": "2025-08-11 14:19:23",
  "hash": "test_hash_1000023"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': 'c65a12916fa7ce007deadff5cbd967513a8ad43e',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e1e1ce82aa6-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '4.35',
      currency_code: 'USD',
      transaction_id: 1000023,
      transaction_timestamp: '2025-08-11 14:19:23',
      round_id: 448644,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:23',
    hash: 'test_hash_1000023'
  },
  timestamp: '2025-08-11T14:19:23.333Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '4.35',
    currency_code: 'USD',
    transaction_id: 1000023,
    transaction_timestamp: '2025-08-11 14:19:23',
    round_id: 448644,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000023',
      history_id: 'test-1000023'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: c65a12916fa7ce007deadff5cbd967513a8ad43e
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: false
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "4.35",
      "currency_code": "USD",
      "transaction_id": 1000023,
      "transaction_timestamp": "2025-08-11 14:19:23",
      "round_id": 448644,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000023",
        "history_id": "test-1000023"
      }
    },
    "request_timestamp": "2025-08-11 14:19:23",
    "hash": "test_hash_1000023"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:23",
    "hash": "9a54d4063fdb119942492e0f075f2a7c30c6f1a8",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "4.35",
      "currency_code": "USD",
      "transaction_id": 1000023,
      "transaction_timestamp": "2025-08-11 14:19:23",
      "round_id": 448644,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000023",
        "history_id": "test-1000023"
      }
    },
    "request_timestamp": "2025-08-11 14:19:23",
    "hash": "test_hash_1000023"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:23",
    "hash": "9a54d4063fdb119942492e0f075f2a7c30c6f1a8",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 1.520 ms - 646[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"2.45","currency_code":"USD","transaction_id":1000024,"transaction_timestamp":"2025-08-11 14:19:23","round_id":856764,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000024","history_id":"test-1000024"}},"request_timestamp":"2025-08-11 14:19:23","hash":"test_hash_1000024"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e1e1a2cf7db-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '535fde3618ac7a1954f38e129d512f049a4c8ad0',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e1e1a2cf7db-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '2.45',
      currency_code: 'USD',
      transaction_id: 1000024,
      transaction_timestamp: '2025-08-11 14:19:23',
      round_id: 856764,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:23',
    hash: 'test_hash_1000024'
  },
  timestamp: '2025-08-11T14:19:23.336Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "2.45",
    "currency_code": "USD",
    "transaction_id": 1000024,
    "transaction_timestamp": "2025-08-11 14:19:23",
    "round_id": 856764,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000024",
      "history_id": "test-1000024"
    }
  },
  "request_timestamp": "2025-08-11 14:19:23",
  "hash": "test_hash_1000024"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "2.45",
    "currency_code": "USD",
    "transaction_id": 1000024,
    "transaction_timestamp": "2025-08-11 14:19:23",
    "round_id": 856764,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000024",
      "history_id": "test-1000024"
    }
  },
  "request_timestamp": "2025-08-11 14:19:23",
  "hash": "test_hash_1000024"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '535fde3618ac7a1954f38e129d512f049a4c8ad0',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e1e1a2cf7db-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '2.45',
      currency_code: 'USD',
      transaction_id: 1000024,
      transaction_timestamp: '2025-08-11 14:19:23',
      round_id: 856764,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:23',
    hash: 'test_hash_1000024'
  },
  timestamp: '2025-08-11T14:19:23.337Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '2.45',
    currency_code: 'USD',
    transaction_id: 1000024,
    transaction_timestamp: '2025-08-11 14:19:23',
    round_id: 856764,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000024',
      history_id: 'test-1000024'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 535fde3618ac7a1954f38e129d512f049a4c8ad0
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: false
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "2.45",
      "currency_code": "USD",
      "transaction_id": 1000024,
      "transaction_timestamp": "2025-08-11 14:19:23",
      "round_id": 856764,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000024",
        "history_id": "test-1000024"
      }
    },
    "request_timestamp": "2025-08-11 14:19:23",
    "hash": "test_hash_1000024"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:23",
    "hash": "9a54d4063fdb119942492e0f075f2a7c30c6f1a8",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "2.45",
      "currency_code": "USD",
      "transaction_id": 1000024,
      "transaction_timestamp": "2025-08-11 14:19:23",
      "round_id": 856764,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000024",
        "history_id": "test-1000024"
      }
    },
    "request_timestamp": "2025-08-11 14:19:23",
    "hash": "test_hash_1000024"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:23",
    "hash": "9a54d4063fdb119942492e0f075f2a7c30c6f1a8",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 1.287 ms - 646[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"1.88","currency_code":"USD","transaction_id":1000020,"transaction_timestamp":"2025-08-11 14:19:23","round_id":614142,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000020","history_id":"test-1000020"}},"request_timestamp":"2025-08-11 14:19:23","hash":"test_hash_1000020"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e1e0c072b83-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '346b7356c97f3cab5e0f1c48b5858b51ab37ce7a',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e1e0c072b83-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '1.88',
      currency_code: 'USD',
      transaction_id: 1000020,
      transaction_timestamp: '2025-08-11 14:19:23',
      round_id: 614142,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:23',
    hash: 'test_hash_1000020'
  },
  timestamp: '2025-08-11T14:19:23.341Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "1.88",
    "currency_code": "USD",
    "transaction_id": 1000020,
    "transaction_timestamp": "2025-08-11 14:19:23",
    "round_id": 614142,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000020",
      "history_id": "test-1000020"
    }
  },
  "request_timestamp": "2025-08-11 14:19:23",
  "hash": "test_hash_1000020"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "1.88",
    "currency_code": "USD",
    "transaction_id": 1000020,
    "transaction_timestamp": "2025-08-11 14:19:23",
    "round_id": 614142,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000020",
      "history_id": "test-1000020"
    }
  },
  "request_timestamp": "2025-08-11 14:19:23",
  "hash": "test_hash_1000020"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '441',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '346b7356c97f3cab5e0f1c48b5858b51ab37ce7a',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85e1e0c072b83-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '1.88',
      currency_code: 'USD',
      transaction_id: 1000020,
      transaction_timestamp: '2025-08-11 14:19:23',
      round_id: 614142,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:19:23',
    hash: 'test_hash_1000020'
  },
  timestamp: '2025-08-11T14:19:23.342Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '1.88',
    currency_code: 'USD',
    transaction_id: 1000020,
    transaction_timestamp: '2025-08-11 14:19:23',
    round_id: 614142,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000020',
      history_id: 'test-1000020'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 346b7356c97f3cab5e0f1c48b5858b51ab37ce7a
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: false
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "1.88",
      "currency_code": "USD",
      "transaction_id": 1000020,
      "transaction_timestamp": "2025-08-11 14:19:23",
      "round_id": 614142,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000020",
        "history_id": "test-1000020"
      }
    },
    "request_timestamp": "2025-08-11 14:19:23",
    "hash": "test_hash_1000020"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:23",
    "hash": "9a54d4063fdb119942492e0f075f2a7c30c6f1a8",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "1.88",
      "currency_code": "USD",
      "transaction_id": 1000020,
      "transaction_timestamp": "2025-08-11 14:19:23",
      "round_id": 614142,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000020",
        "history_id": "test-1000020"
      }
    },
    "request_timestamp": "2025-08-11 14:19:23",
    "hash": "test_hash_1000020"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:19:23",
    "hash": "9a54d4063fdb119942492e0f075f2a7c30c6f1a8",
    "data": {
      "error_code": "OP_99",
      "error_message": "Invalid authorization"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 3.506 ms - 646[0m
[APP DEBUG] Incoming request: GET /api/user/category-balances body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e5eaf9ddc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[APP DEBUG] Incoming request: GET /api/user/balance body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85e5eafa2dc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[0mGET /api/user/category-balances [32m200[0m 26.447 ms - 136[0m
[0mGET /api/user/balance [32m200[0m 29.199 ms - 593[0m
[APP DEBUG] Incoming request: GET /api/user/category-balances body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85f1b7840dc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[APP DEBUG] Incoming request: GET /api/user/balance body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85f1b784ddc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[0mGET /api/user/category-balances [32m200[0m 99.375 ms - 136[0m
[0mGET /api/user/balance [32m200[0m 103.713 ms - 593[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"7.27","currency_code":"USD","transaction_id":1000004,"transaction_timestamp":"2025-08-11 14:20:28","round_id":821933,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000004","history_id":"test-1000004"}},"request_timestamp":"2025-08-11 14:20:28","hash":"9c0af89d11768839db6e3040cd3ba783520ab30c"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fb7cce17d0a-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fb7cce17d0a-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '7.27',
      currency_code: 'USD',
      transaction_id: 1000004,
      transaction_timestamp: '2025-08-11 14:20:28',
      round_id: 821933,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:28',
    hash: '9c0af89d11768839db6e3040cd3ba783520ab30c'
  },
  timestamp: '2025-08-11T14:20:28.877Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "7.27",
    "currency_code": "USD",
    "transaction_id": 1000004,
    "transaction_timestamp": "2025-08-11 14:20:28",
    "round_id": 821933,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000004",
      "history_id": "test-1000004"
    }
  },
  "request_timestamp": "2025-08-11 14:20:28",
  "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "7.27",
    "currency_code": "USD",
    "transaction_id": 1000004,
    "transaction_timestamp": "2025-08-11 14:20:28",
    "round_id": 821933,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000004",
      "history_id": "test-1000004"
    }
  },
  "request_timestamp": "2025-08-11 14:20:28",
  "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fb7cce17d0a-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '7.27',
      currency_code: 'USD',
      transaction_id: 1000004,
      transaction_timestamp: '2025-08-11 14:20:28',
      round_id: 821933,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:28',
    hash: '9c0af89d11768839db6e3040cd3ba783520ab30c'
  },
  timestamp: '2025-08-11T14:20:28.877Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '7.27',
    currency_code: 'USD',
    transaction_id: 1000004,
    transaction_timestamp: '2025-08-11 14:20:28',
    round_id: 821933,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000004',
      history_id: 'test-1000004'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "7.27",
    "currency_code": "USD",
    "transaction_id": 1000004,
    "transaction_timestamp": "2025-08-11 14:20:28",
    "round_id": 821933,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000004",
      "history_id": "test-1000004"
    }
  },
  "request_timestamp": "2025-08-11 14:20:28",
  "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: WIN, amount: 7.27, parsed: 7.27, type: WIN
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($7.27)',
  transaction_type: 'WIN',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "7.27",
      "currency_code": "USD",
      "transaction_id": 1000004,
      "transaction_timestamp": "2025-08-11 14:20:28",
      "round_id": 821933,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000004",
        "history_id": "test-1000004"
      }
    },
    "request_timestamp": "2025-08-11 14:20:28",
    "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:28",
    "hash": "9e481d6a6ac727d947c60a2cfaa7a26a0551f474",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "7.27",
      "currency_code": "USD",
      "transaction_id": 1000004,
      "transaction_timestamp": "2025-08-11 14:20:28",
      "round_id": 821933,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000004",
        "history_id": "test-1000004"
      }
    },
    "request_timestamp": "2025-08-11 14:20:28",
    "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:28",
    "hash": "9e481d6a6ac727d947c60a2cfaa7a26a0551f474",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
CHANGEBALANCE user not found for token: test_token_123
[0mPOST /api/innova/changebalance [32m200[0m 115.154 ms - 679[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"5.80","currency_code":"USD","transaction_id":1000000,"transaction_timestamp":"2025-08-11 14:20:28","round_id":96118,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000000","history_id":"test-1000000"}},"request_timestamp":"2025-08-11 14:20:28","hash":"9c0af89d11768839db6e3040cd3ba783520ab30c"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fb7aeba7ceb-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '463',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fb7aeba7ceb-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '5.80',
      currency_code: 'USD',
      transaction_id: 1000000,
      transaction_timestamp: '2025-08-11 14:20:28',
      round_id: 96118,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:28',
    hash: '9c0af89d11768839db6e3040cd3ba783520ab30c'
  },
  timestamp: '2025-08-11T14:20:29.194Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "5.80",
    "currency_code": "USD",
    "transaction_id": 1000000,
    "transaction_timestamp": "2025-08-11 14:20:28",
    "round_id": 96118,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000000",
      "history_id": "test-1000000"
    }
  },
  "request_timestamp": "2025-08-11 14:20:28",
  "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "5.80",
    "currency_code": "USD",
    "transaction_id": 1000000,
    "transaction_timestamp": "2025-08-11 14:20:28",
    "round_id": 96118,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000000",
      "history_id": "test-1000000"
    }
  },
  "request_timestamp": "2025-08-11 14:20:28",
  "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '463',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fb7aeba7ceb-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '5.80',
      currency_code: 'USD',
      transaction_id: 1000000,
      transaction_timestamp: '2025-08-11 14:20:28',
      round_id: 96118,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:28',
    hash: '9c0af89d11768839db6e3040cd3ba783520ab30c'
  },
  timestamp: '2025-08-11T14:20:29.195Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '5.80',
    currency_code: 'USD',
    transaction_id: 1000000,
    transaction_timestamp: '2025-08-11 14:20:28',
    round_id: 96118,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000000',
      history_id: 'test-1000000'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "5.80",
    "currency_code": "USD",
    "transaction_id": 1000000,
    "transaction_timestamp": "2025-08-11 14:20:28",
    "round_id": 96118,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000000",
      "history_id": "test-1000000"
    }
  },
  "request_timestamp": "2025-08-11 14:20:28",
  "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: WIN, amount: 5.80, parsed: 5.8, type: WIN
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($5.80)',
  transaction_type: 'WIN',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "5.80",
      "currency_code": "USD",
      "transaction_id": 1000000,
      "transaction_timestamp": "2025-08-11 14:20:28",
      "round_id": 96118,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000000",
        "history_id": "test-1000000"
      }
    },
    "request_timestamp": "2025-08-11 14:20:28",
    "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:29",
    "hash": "3d60b0d2829e37e9028832b74cba6222c19993ec",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "5.80",
      "currency_code": "USD",
      "transaction_id": 1000000,
      "transaction_timestamp": "2025-08-11 14:20:28",
      "round_id": 96118,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000000",
        "history_id": "test-1000000"
      }
    },
    "request_timestamp": "2025-08-11 14:20:28",
    "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:29",
    "hash": "3d60b0d2829e37e9028832b74cba6222c19993ec",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 3.957 ms - 678[0m
CHANGEBALANCE user not found for token: test_token_123
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"6.26","currency_code":"USD","transaction_id":1000009,"transaction_timestamp":"2025-08-11 14:20:28","round_id":692246,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000009","history_id":"test-1000009"}},"request_timestamp":"2025-08-11 14:20:28","hash":"9c0af89d11768839db6e3040cd3ba783520ab30c"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fb78ea72ae9-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fb78ea72ae9-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '6.26',
      currency_code: 'USD',
      transaction_id: 1000009,
      transaction_timestamp: '2025-08-11 14:20:28',
      round_id: 692246,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:28',
    hash: '9c0af89d11768839db6e3040cd3ba783520ab30c'
  },
  timestamp: '2025-08-11T14:20:29.220Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "6.26",
    "currency_code": "USD",
    "transaction_id": 1000009,
    "transaction_timestamp": "2025-08-11 14:20:28",
    "round_id": 692246,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000009",
      "history_id": "test-1000009"
    }
  },
  "request_timestamp": "2025-08-11 14:20:28",
  "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "6.26",
    "currency_code": "USD",
    "transaction_id": 1000009,
    "transaction_timestamp": "2025-08-11 14:20:28",
    "round_id": 692246,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000009",
      "history_id": "test-1000009"
    }
  },
  "request_timestamp": "2025-08-11 14:20:28",
  "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fb78ea72ae9-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '6.26',
      currency_code: 'USD',
      transaction_id: 1000009,
      transaction_timestamp: '2025-08-11 14:20:28',
      round_id: 692246,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:28',
    hash: '9c0af89d11768839db6e3040cd3ba783520ab30c'
  },
  timestamp: '2025-08-11T14:20:29.221Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '6.26',
    currency_code: 'USD',
    transaction_id: 1000009,
    transaction_timestamp: '2025-08-11 14:20:28',
    round_id: 692246,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000009',
      history_id: 'test-1000009'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "6.26",
    "currency_code": "USD",
    "transaction_id": 1000009,
    "transaction_timestamp": "2025-08-11 14:20:28",
    "round_id": 692246,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000009",
      "history_id": "test-1000009"
    }
  },
  "request_timestamp": "2025-08-11 14:20:28",
  "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 6.26, parsed: -6.26, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($6.26)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "6.26",
      "currency_code": "USD",
CHANGEBALANCE user not found for token: test_token_123
      "transaction_id": 1000009,
      "transaction_timestamp": "2025-08-11 14:20:28",
      "round_id": 692246,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000009",
        "history_id": "test-1000009"
      }
    },
    "request_timestamp": "2025-08-11 14:20:28",
    "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:29",
    "hash": "3d60b0d2829e37e9028832b74cba6222c19993ec",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "6.26",
      "currency_code": "USD",
      "transaction_id": 1000009,
      "transaction_timestamp": "2025-08-11 14:20:28",
      "round_id": 692246,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000009",
        "history_id": "test-1000009"
      }
    },
    "request_timestamp": "2025-08-11 14:20:28",
    "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:29",
    "hash": "3d60b0d2829e37e9028832b74cba6222c19993ec",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 3.548 ms - 679[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"6.93","currency_code":"USD","transaction_id":1000005,"transaction_timestamp":"2025-08-11 14:20:28","round_id":257933,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000005","history_id":"test-1000005"}},"request_timestamp":"2025-08-11 14:20:28","hash":"9c0af89d11768839db6e3040cd3ba783520ab30c"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fb7ac80cd1f-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fb7ac80cd1f-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '6.93',
      currency_code: 'USD',
      transaction_id: 1000005,
      transaction_timestamp: '2025-08-11 14:20:28',
      round_id: 257933,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:28',
    hash: '9c0af89d11768839db6e3040cd3ba783520ab30c'
  },
  timestamp: '2025-08-11T14:20:29.227Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "6.93",
    "currency_code": "USD",
    "transaction_id": 1000005,
    "transaction_timestamp": "2025-08-11 14:20:28",
    "round_id": 257933,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000005",
      "history_id": "test-1000005"
    }
  },
  "request_timestamp": "2025-08-11 14:20:28",
  "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "6.93",
    "currency_code": "USD",
    "transaction_id": 1000005,
    "transaction_timestamp": "2025-08-11 14:20:28",
    "round_id": 257933,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000005",
      "history_id": "test-1000005"
    }
  },
  "request_timestamp": "2025-08-11 14:20:28",
  "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fb7ac80cd1f-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '6.93',
      currency_code: 'USD',
      transaction_id: 1000005,
      transaction_timestamp: '2025-08-11 14:20:28',
      round_id: 257933,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:28',
    hash: '9c0af89d11768839db6e3040cd3ba783520ab30c'
  },
  timestamp: '2025-08-11T14:20:29.228Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '6.93',
    currency_code: 'USD',
    transaction_id: 1000005,
    transaction_timestamp: '2025-08-11 14:20:28',
    round_id: 257933,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000005',
      history_id: 'test-1000005'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "6.93",
    "currency_code": "USD",
    "transaction_id": 1000005,
    "transaction_timestamp": "2025-08-11 14:20:28",
    "round_id": 257933,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000005",
      "history_id": "test-1000005"
    }
  },
  "request_timestamp": "2025-08-11 14:20:28",
  "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 6.93, parsed: -6.93, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($6.93)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"0.36","currency_code":"USD","transaction_id":1000007,"transaction_timestamp":"2025-08-11 14:20:28","round_id":584931,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000007","history_id":"test-1000007"}},"request_timestamp":"2025-08-11 14:20:28","hash":"9c0af89d11768839db6e3040cd3ba783520ab30c"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fb7cfb108ac-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fb7cfb108ac-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '0.36',
      currency_code: 'USD',
      transaction_id: 1000007,
      transaction_timestamp: '2025-08-11 14:20:28',
      round_id: 584931,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:28',
    hash: '9c0af89d11768839db6e3040cd3ba783520ab30c'
  },
  timestamp: '2025-08-11T14:20:29.231Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "0.36",
    "currency_code": "USD",
    "transaction_id": 1000007,
    "transaction_timestamp": "2025-08-11 14:20:28",
    "round_id": 584931,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000007",
      "history_id": "test-1000007"
    }
  },
  "request_timestamp": "2025-08-11 14:20:28",
  "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "0.36",
    "currency_code": "USD",
    "transaction_id": 1000007,
    "transaction_timestamp": "2025-08-11 14:20:28",
    "round_id": 584931,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000007",
      "history_id": "test-1000007"
    }
  },
  "request_timestamp": "2025-08-11 14:20:28",
  "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fb7cfb108ac-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '0.36',
      currency_code: 'USD',
      transaction_id: 1000007,
      transaction_timestamp: '2025-08-11 14:20:28',
      round_id: 584931,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:28',
    hash: '9c0af89d11768839db6e3040cd3ba783520ab30c'
  },
  timestamp: '2025-08-11T14:20:29.232Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '0.36',
    currency_code: 'USD',
    transaction_id: 1000007,
    transaction_timestamp: '2025-08-11 14:20:28',
    round_id: 584931,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000007',
      history_id: 'test-1000007'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "0.36",
    "currency_code": "USD",
    "transaction_id": 1000007,
    "transaction_timestamp": "2025-08-11 14:20:28",
    "round_id": 584931,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000007",
      "history_id": "test-1000007"
    }
  },
  "request_timestamp": "2025-08-11 14:20:28",
  "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: WIN, amount: 0.36, parsed: 0.36, type: WIN
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($0.36)',
  transaction_type: 'WIN',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "6.93",
      "currency_code": "USD",
      "transaction_id": 1000005,
      "transaction_timestamp": "2025-08-11 14:20:28",
      "round_id": 257933,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000005",
        "history_id": "test-1000005"
      }
    },
    "request_timestamp": "2025-08-11 14:20:28",
    "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:29",
    "hash": "3d60b0d2829e37e9028832b74cba6222c19993ec",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "6.93",
      "currency_code": "USD",
      "transaction_id": 1000005,
      "transaction_timestamp": "2025-08-11 14:20:28",
      "round_id": 257933,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000005",
        "history_id": "test-1000005"
      }
    },
    "request_timestamp": "2025-08-11 14:20:28",
    "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:29",
    "hash": "3d60b0d2829e37e9028832b74cba6222c19993ec",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 6.664 ms - 679[0m
CHANGEBALANCE user not found for token: test_token_123
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"8.93","currency_code":"USD","transaction_id":1000003,"transaction_timestamp":"2025-08-11 14:20:28","round_id":666734,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000003","history_id":"test-1000003"}},"request_timestamp":"2025-08-11 14:20:28","hash":"9c0af89d11768839db6e3040cd3ba783520ab30c"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fb7bc532abd-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fb7bc532abd-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '8.93',
      currency_code: 'USD',
      transaction_id: 1000003,
      transaction_timestamp: '2025-08-11 14:20:28',
      round_id: 666734,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:28',
CHANGEBALANCE user not found for token: test_token_123
    hash: '9c0af89d11768839db6e3040cd3ba783520ab30c'
  },
  timestamp: '2025-08-11T14:20:29.251Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "8.93",
    "currency_code": "USD",
    "transaction_id": 1000003,
    "transaction_timestamp": "2025-08-11 14:20:28",
    "round_id": 666734,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000003",
      "history_id": "test-1000003"
    }
  },
  "request_timestamp": "2025-08-11 14:20:28",
  "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "8.93",
    "currency_code": "USD",
    "transaction_id": 1000003,
    "transaction_timestamp": "2025-08-11 14:20:28",
    "round_id": 666734,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000003",
      "history_id": "test-1000003"
    }
  },
  "request_timestamp": "2025-08-11 14:20:28",
  "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fb7bc532abd-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '8.93',
      currency_code: 'USD',
      transaction_id: 1000003,
      transaction_timestamp: '2025-08-11 14:20:28',
      round_id: 666734,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:28',
    hash: '9c0af89d11768839db6e3040cd3ba783520ab30c'
  },
  timestamp: '2025-08-11T14:20:29.251Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '8.93',
    currency_code: 'USD',
    transaction_id: 1000003,
    transaction_timestamp: '2025-08-11 14:20:28',
    round_id: 666734,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000003',
      history_id: 'test-1000003'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "8.93",
    "currency_code": "USD",
    "transaction_id": 1000003,
    "transaction_timestamp": "2025-08-11 14:20:28",
    "round_id": 666734,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000003",
      "history_id": "test-1000003"
    }
  },
  "request_timestamp": "2025-08-11 14:20:28",
  "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 8.93, parsed: -8.93, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($8.93)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "0.36",
      "currency_code": "USD",
      "transaction_id": 1000007,
      "transaction_timestamp": "2025-08-11 14:20:28",
      "round_id": 584931,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000007",
        "history_id": "test-1000007"
      }
    },
    "request_timestamp": "2025-08-11 14:20:28",
    "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
  },
CHANGEBALANCE user not found for token: test_token_123
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:29",
    "hash": "3d60b0d2829e37e9028832b74cba6222c19993ec",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "0.36",
      "currency_code": "USD",
      "transaction_id": 1000007,
      "transaction_timestamp": "2025-08-11 14:20:28",
      "round_id": 584931,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000007",
        "history_id": "test-1000007"
      }
    },
    "request_timestamp": "2025-08-11 14:20:28",
    "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:29",
    "hash": "3d60b0d2829e37e9028832b74cba6222c19993ec",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 21.924 ms - 679[0m
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "8.93",
      "currency_code": "USD",
      "transaction_id": 1000003,
      "transaction_timestamp": "2025-08-11 14:20:28",
      "round_id": 666734,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000003",
        "history_id": "test-1000003"
      }
    },
    "request_timestamp": "2025-08-11 14:20:28",
    "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:29",
    "hash": "3d60b0d2829e37e9028832b74cba6222c19993ec",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "8.93",
      "currency_code": "USD",
      "transaction_id": 1000003,
      "transaction_timestamp": "2025-08-11 14:20:28",
      "round_id": 666734,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000003",
        "history_id": "test-1000003"
      }
    },
    "request_timestamp": "2025-08-11 14:20:28",
    "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:29",
    "hash": "3d60b0d2829e37e9028832b74cba6222c19993ec",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 3.342 ms - 679[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"0.71","currency_code":"USD","transaction_id":1000006,"transaction_timestamp":"2025-08-11 14:20:28","round_id":481182,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000006","history_id":"test-1000006"}},"request_timestamp":"2025-08-11 14:20:28","hash":"9c0af89d11768839db6e3040cd3ba783520ab30c"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fb7dfa82f74-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fb7dfa82f74-LAX',
    'x-operator-id': 'thinkcode_stg',
    accept: 'application/json, text/plain, */*',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG',
    'cf-visitor': '{"scheme":"https"}',
    'x-forwarded-proto': 'https'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '0.71',
      currency_code: 'USD',
      transaction_id: 1000006,
      transaction_timestamp: '2025-08-11 14:20:28',
      round_id: 481182,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:28',
    hash: '9c0af89d11768839db6e3040cd3ba783520ab30c'
  },
  timestamp: '2025-08-11T14:20:29.275Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "0.71",
    "currency_code": "USD",
    "transaction_id": 1000006,
    "transaction_timestamp": "2025-08-11 14:20:28",
    "round_id": 481182,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000006",
      "history_id": "test-1000006"
    }
  },
  "request_timestamp": "2025-08-11 14:20:28",
  "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "0.71",
    "currency_code": "USD",
    "transaction_id": 1000006,
    "transaction_timestamp": "2025-08-11 14:20:28",
    "round_id": 481182,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000006",
      "history_id": "test-1000006"
    }
  },
  "request_timestamp": "2025-08-11 14:20:28",
  "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fb7dfa82f74-LAX',
    'x-operator-id': 'thinkcode_stg',
    accept: 'application/json, text/plain, */*',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG',
    'cf-visitor': '{"scheme":"https"}',
    'x-forwarded-proto': 'https'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '0.71',
      currency_code: 'USD',
      transaction_id: 1000006,
      transaction_timestamp: '2025-08-11 14:20:28',
      round_id: 481182,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:28',
    hash: '9c0af89d11768839db6e3040cd3ba783520ab30c'
  },
  timestamp: '2025-08-11T14:20:29.275Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '0.71',
    currency_code: 'USD',
    transaction_id: 1000006,
    transaction_timestamp: '2025-08-11 14:20:28',
    round_id: 481182,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000006',
      history_id: 'test-1000006'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "0.71",
    "currency_code": "USD",
    "transaction_id": 1000006,
    "transaction_timestamp": "2025-08-11 14:20:28",
    "round_id": 481182,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000006",
      "history_id": "test-1000006"
    }
  },
  "request_timestamp": "2025-08-11 14:20:28",
  "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 0.71, parsed: -0.71, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($0.71)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "0.71",
      "currency_code": "USD",
      "transaction_id": 1000006,
      "transaction_timestamp": "2025-08-11 14:20:28",
      "round_id": 481182,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000006",
        "history_id": "test-1000006"
      }
    },
    "request_timestamp": "2025-08-11 14:20:28",
    "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:29",
    "hash": "3d60b0d2829e37e9028832b74cba6222c19993ec",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "0.71",
      "currency_code": "USD",
      "transaction_id": 1000006,
      "transaction_timestamp": "2025-08-11 14:20:28",
      "round_id": 481182,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000006",
        "history_id": "test-1000006"
      }
    },
    "request_timestamp": "2025-08-11 14:20:28",
    "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:29",
    "hash": "3d60b0d2829e37e9028832b74cba6222c19993ec",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
CHANGEBALANCE user not found for token: test_token_123
[0mPOST /api/innova/changebalance [32m200[0m 4.303 ms - 679[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"0.78","currency_code":"USD","transaction_id":1000002,"transaction_timestamp":"2025-08-11 14:20:28","round_id":829075,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000002","history_id":"test-1000002"}},"request_timestamp":"2025-08-11 14:20:28","hash":"9c0af89d11768839db6e3040cd3ba783520ab30c"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fb79aadcb91-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fb79aadcb91-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '0.78',
      currency_code: 'USD',
      transaction_id: 1000002,
      transaction_timestamp: '2025-08-11 14:20:28',
      round_id: 829075,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:28',
    hash: '9c0af89d11768839db6e3040cd3ba783520ab30c'
  },
  timestamp: '2025-08-11T14:20:29.287Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "0.78",
    "currency_code": "USD",
    "transaction_id": 1000002,
    "transaction_timestamp": "2025-08-11 14:20:28",
    "round_id": 829075,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000002",
      "history_id": "test-1000002"
    }
  },
  "request_timestamp": "2025-08-11 14:20:28",
  "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "0.78",
    "currency_code": "USD",
    "transaction_id": 1000002,
    "transaction_timestamp": "2025-08-11 14:20:28",
    "round_id": 829075,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000002",
      "history_id": "test-1000002"
    }
  },
  "request_timestamp": "2025-08-11 14:20:28",
  "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fb79aadcb91-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '0.78',
      currency_code: 'USD',
      transaction_id: 1000002,
      transaction_timestamp: '2025-08-11 14:20:28',
      round_id: 829075,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:28',
    hash: '9c0af89d11768839db6e3040cd3ba783520ab30c'
  },
  timestamp: '2025-08-11T14:20:29.288Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '0.78',
    currency_code: 'USD',
    transaction_id: 1000002,
    transaction_timestamp: '2025-08-11 14:20:28',
    round_id: 829075,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000002',
      history_id: 'test-1000002'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "0.78",
    "currency_code": "USD",
    "transaction_id": 1000002,
    "transaction_timestamp": "2025-08-11 14:20:28",
    "round_id": 829075,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000002",
      "history_id": "test-1000002"
    }
  },
  "request_timestamp": "2025-08-11 14:20:28",
  "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: WIN, amount: 0.78, parsed: 0.78, type: WIN
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($0.78)',
  transaction_type: 'WIN',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
CHANGEBALANCE user not found for token: test_token_123
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "0.78",
      "currency_code": "USD",
      "transaction_id": 1000002,
      "transaction_timestamp": "2025-08-11 14:20:28",
      "round_id": 829075,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000002",
        "history_id": "test-1000002"
      }
    },
    "request_timestamp": "2025-08-11 14:20:28",
    "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:29",
    "hash": "3d60b0d2829e37e9028832b74cba6222c19993ec",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "0.78",
      "currency_code": "USD",
      "transaction_id": 1000002,
      "transaction_timestamp": "2025-08-11 14:20:28",
      "round_id": 829075,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000002",
        "history_id": "test-1000002"
      }
    },
    "request_timestamp": "2025-08-11 14:20:28",
    "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:29",
    "hash": "3d60b0d2829e37e9028832b74cba6222c19993ec",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 4.434 ms - 679[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"1.74","currency_code":"USD","transaction_id":1000001,"transaction_timestamp":"2025-08-11 14:20:28","round_id":985032,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000001","history_id":"test-1000001"}},"request_timestamp":"2025-08-11 14:20:28","hash":"9c0af89d11768839db6e3040cd3ba783520ab30c"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fb7dcd51028-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fb7dcd51028-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '1.74',
      currency_code: 'USD',
      transaction_id: 1000001,
      transaction_timestamp: '2025-08-11 14:20:28',
      round_id: 985032,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:28',
    hash: '9c0af89d11768839db6e3040cd3ba783520ab30c'
  },
  timestamp: '2025-08-11T14:20:29.319Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "1.74",
    "currency_code": "USD",
    "transaction_id": 1000001,
    "transaction_timestamp": "2025-08-11 14:20:28",
    "round_id": 985032,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000001",
      "history_id": "test-1000001"
    }
  },
  "request_timestamp": "2025-08-11 14:20:28",
  "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "1.74",
    "currency_code": "USD",
    "transaction_id": 1000001,
    "transaction_timestamp": "2025-08-11 14:20:28",
    "round_id": 985032,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000001",
      "history_id": "test-1000001"
    }
  },
  "request_timestamp": "2025-08-11 14:20:28",
  "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fb7dcd51028-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '1.74',
      currency_code: 'USD',
      transaction_id: 1000001,
      transaction_timestamp: '2025-08-11 14:20:28',
      round_id: 985032,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:28',
    hash: '9c0af89d11768839db6e3040cd3ba783520ab30c'
  },
  timestamp: '2025-08-11T14:20:29.320Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '1.74',
    currency_code: 'USD',
    transaction_id: 1000001,
    transaction_timestamp: '2025-08-11 14:20:28',
    round_id: 985032,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000001',
      history_id: 'test-1000001'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "1.74",
    "currency_code": "USD",
    "transaction_id": 1000001,
    "transaction_timestamp": "2025-08-11 14:20:28",
    "round_id": 985032,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000001",
      "history_id": "test-1000001"
    }
  },
  "request_timestamp": "2025-08-11 14:20:28",
  "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 1.74, parsed: -1.74, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($1.74)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"6.36","currency_code":"USD","transaction_id":1000008,"transaction_timestamp":"2025-08-11 14:20:28","round_id":335015,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000008","history_id":"test-1000008"}},"request_timestamp":"2025-08-11 14:20:28","hash":"9c0af89d11768839db6e3040cd3ba783520ab30c"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fb7cddf0f19-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fb7cddf0f19-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '6.36',
      currency_code: 'USD',
      transaction_id: 1000008,
      transaction_timestamp: '2025-08-11 14:20:28',
      round_id: 335015,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:28',
    hash: '9c0af89d11768839db6e3040cd3ba783520ab30c'
  },
  timestamp: '2025-08-11T14:20:29.322Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "6.36",
    "currency_code": "USD",
    "transaction_id": 1000008,
    "transaction_timestamp": "2025-08-11 14:20:28",
    "round_id": 335015,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000008",
      "history_id": "test-1000008"
    }
  },
  "request_timestamp": "2025-08-11 14:20:28",
  "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "6.36",
    "currency_code": "USD",
    "transaction_id": 1000008,
    "transaction_timestamp": "2025-08-11 14:20:28",
    "round_id": 335015,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000008",
      "history_id": "test-1000008"
    }
  },
  "request_timestamp": "2025-08-11 14:20:28",
  "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fb7cddf0f19-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '6.36',
      currency_code: 'USD',
      transaction_id: 1000008,
      transaction_timestamp: '2025-08-11 14:20:28',
      round_id: 335015,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:28',
    hash: '9c0af89d11768839db6e3040cd3ba783520ab30c'
  },
  timestamp: '2025-08-11T14:20:29.322Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '6.36',
    currency_code: 'USD',
    transaction_id: 1000008,
    transaction_timestamp: '2025-08-11 14:20:28',
    round_id: 335015,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000008',
      history_id: 'test-1000008'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "6.36",
    "currency_code": "USD",
    "transaction_id": 1000008,
    "transaction_timestamp": "2025-08-11 14:20:28",
    "round_id": 335015,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000008",
      "history_id": "test-1000008"
    }
  },
  "request_timestamp": "2025-08-11 14:20:28",
  "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: WIN, amount: 6.36, parsed: 6.36, type: WIN
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($6.36)',
  transaction_type: 'WIN',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
CHANGEBALANCE user not found for token: test_token_123
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "1.74",
      "currency_code": "USD",
      "transaction_id": 1000001,
      "transaction_timestamp": "2025-08-11 14:20:28",
      "round_id": 985032,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000001",
        "history_id": "test-1000001"
      }
    },
    "request_timestamp": "2025-08-11 14:20:28",
    "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:29",
    "hash": "3d60b0d2829e37e9028832b74cba6222c19993ec",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "1.74",
      "currency_code": "USD",
      "transaction_id": 1000001,
      "transaction_timestamp": "2025-08-11 14:20:28",
      "round_id": 985032,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000001",
        "history_id": "test-1000001"
      }
    },
    "request_timestamp": "2025-08-11 14:20:28",
    "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:29",
    "hash": "3d60b0d2829e37e9028832b74cba6222c19993ec",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 4.234 ms - 679[0m
CHANGEBALANCE user not found for token: test_token_123
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "6.36",
      "currency_code": "USD",
      "transaction_id": 1000008,
      "transaction_timestamp": "2025-08-11 14:20:28",
      "round_id": 335015,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000008",
        "history_id": "test-1000008"
      }
    },
    "request_timestamp": "2025-08-11 14:20:28",
    "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:29",
    "hash": "3d60b0d2829e37e9028832b74cba6222c19993ec",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "6.36",
      "currency_code": "USD",
      "transaction_id": 1000008,
      "transaction_timestamp": "2025-08-11 14:20:28",
      "round_id": 335015,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000008",
        "history_id": "test-1000008"
      }
    },
    "request_timestamp": "2025-08-11 14:20:28",
    "hash": "9c0af89d11768839db6e3040cd3ba783520ab30c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:29",
    "hash": "3d60b0d2829e37e9028832b74cba6222c19993ec",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 4.044 ms - 679[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"3.32","currency_code":"USD","transaction_id":1000012,"transaction_timestamp":"2025-08-11 14:20:30","round_id":345195,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000012","history_id":"test-1000012"}},"request_timestamp":"2025-08-11 14:20:30","hash":"eb80975483d1a6e78df609e7d3171672bc9f8d7d"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fc518e2cb91-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fc518e2cb91-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '3.32',
      currency_code: 'USD',
      transaction_id: 1000012,
      transaction_timestamp: '2025-08-11 14:20:30',
      round_id: 345195,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:30',
    hash: 'eb80975483d1a6e78df609e7d3171672bc9f8d7d'
  },
  timestamp: '2025-08-11T14:20:30.987Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "3.32",
    "currency_code": "USD",
    "transaction_id": 1000012,
    "transaction_timestamp": "2025-08-11 14:20:30",
    "round_id": 345195,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000012",
      "history_id": "test-1000012"
    }
  },
  "request_timestamp": "2025-08-11 14:20:30",
  "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "3.32",
    "currency_code": "USD",
    "transaction_id": 1000012,
    "transaction_timestamp": "2025-08-11 14:20:30",
    "round_id": 345195,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000012",
      "history_id": "test-1000012"
    }
  },
  "request_timestamp": "2025-08-11 14:20:30",
  "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fc518e2cb91-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '3.32',
      currency_code: 'USD',
      transaction_id: 1000012,
      transaction_timestamp: '2025-08-11 14:20:30',
      round_id: 345195,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:30',
    hash: 'eb80975483d1a6e78df609e7d3171672bc9f8d7d'
  },
  timestamp: '2025-08-11T14:20:30.989Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '3.32',
    currency_code: 'USD',
    transaction_id: 1000012,
    transaction_timestamp: '2025-08-11 14:20:30',
    round_id: 345195,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000012',
      history_id: 'test-1000012'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "3.32",
    "currency_code": "USD",
    "transaction_id": 1000012,
    "transaction_timestamp": "2025-08-11 14:20:30",
    "round_id": 345195,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000012",
      "history_id": "test-1000012"
    }
  },
  "request_timestamp": "2025-08-11 14:20:30",
  "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: WIN, amount: 3.32, parsed: 3.32, type: WIN
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($3.32)',
  transaction_type: 'WIN',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "3.32",
      "currency_code": "USD",
      "transaction_id": 1000012,
      "transaction_timestamp": "2025-08-11 14:20:30",
      "round_id": 345195,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000012",
        "history_id": "test-1000012"
CHANGEBALANCE user not found for token: test_token_123
      }
    },
    "request_timestamp": "2025-08-11 14:20:30",
    "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:30",
    "hash": "fc87bf511bef86b022ada3ccddb5ea3e225d8877",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "3.32",
      "currency_code": "USD",
      "transaction_id": 1000012,
      "transaction_timestamp": "2025-08-11 14:20:30",
      "round_id": 345195,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000012",
        "history_id": "test-1000012"
      }
    },
    "request_timestamp": "2025-08-11 14:20:30",
    "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:30",
    "hash": "fc87bf511bef86b022ada3ccddb5ea3e225d8877",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 5.539 ms - 679[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"4.17","currency_code":"USD","transaction_id":1000018,"transaction_timestamp":"2025-08-11 14:20:30","round_id":575930,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000018","history_id":"test-1000018"}},"request_timestamp":"2025-08-11 14:20:30","hash":"eb80975483d1a6e78df609e7d3171672bc9f8d7d"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fc518c07ceb-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fc518c07ceb-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '4.17',
      currency_code: 'USD',
      transaction_id: 1000018,
      transaction_timestamp: '2025-08-11 14:20:30',
      round_id: 575930,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:30',
    hash: 'eb80975483d1a6e78df609e7d3171672bc9f8d7d'
  },
  timestamp: '2025-08-11T14:20:30.994Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "4.17",
    "currency_code": "USD",
    "transaction_id": 1000018,
    "transaction_timestamp": "2025-08-11 14:20:30",
    "round_id": 575930,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000018",
      "history_id": "test-1000018"
    }
  },
  "request_timestamp": "2025-08-11 14:20:30",
  "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "4.17",
    "currency_code": "USD",
    "transaction_id": 1000018,
    "transaction_timestamp": "2025-08-11 14:20:30",
    "round_id": 575930,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000018",
      "history_id": "test-1000018"
    }
  },
  "request_timestamp": "2025-08-11 14:20:30",
  "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fc518c07ceb-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '4.17',
      currency_code: 'USD',
      transaction_id: 1000018,
      transaction_timestamp: '2025-08-11 14:20:30',
      round_id: 575930,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:30',
    hash: 'eb80975483d1a6e78df609e7d3171672bc9f8d7d'
  },
  timestamp: '2025-08-11T14:20:30.995Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '4.17',
    currency_code: 'USD',
    transaction_id: 1000018,
    transaction_timestamp: '2025-08-11 14:20:30',
    round_id: 575930,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000018',
      history_id: 'test-1000018'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "4.17",
    "currency_code": "USD",
    "transaction_id": 1000018,
    "transaction_timestamp": "2025-08-11 14:20:30",
    "round_id": 575930,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000018",
      "history_id": "test-1000018"
    }
  },
  "request_timestamp": "2025-08-11 14:20:30",
  "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 4.17, parsed: -4.17, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($4.17)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"7.33","currency_code":"USD","transaction_id":1000015,"transaction_timestamp":"2025-08-11 14:20:30","round_id":371597,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000015","history_id":"test-1000015"}},"request_timestamp":"2025-08-11 14:20:30","hash":"eb80975483d1a6e78df609e7d3171672bc9f8d7d"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fc51df108ac-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fc51df108ac-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '7.33',
      currency_code: 'USD',
      transaction_id: 1000015,
      transaction_timestamp: '2025-08-11 14:20:30',
      round_id: 371597,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:30',
    hash: 'eb80975483d1a6e78df609e7d3171672bc9f8d7d'
  },
  timestamp: '2025-08-11T14:20:30.998Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "7.33",
    "currency_code": "USD",
    "transaction_id": 1000015,
    "transaction_timestamp": "2025-08-11 14:20:30",
    "round_id": 371597,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000015",
      "history_id": "test-1000015"
    }
  },
  "request_timestamp": "2025-08-11 14:20:30",
  "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "7.33",
    "currency_code": "USD",
    "transaction_id": 1000015,
    "transaction_timestamp": "2025-08-11 14:20:30",
    "round_id": 371597,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000015",
      "history_id": "test-1000015"
    }
  },
  "request_timestamp": "2025-08-11 14:20:30",
  "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fc51df108ac-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '7.33',
      currency_code: 'USD',
      transaction_id: 1000015,
      transaction_timestamp: '2025-08-11 14:20:30',
      round_id: 371597,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:30',
    hash: 'eb80975483d1a6e78df609e7d3171672bc9f8d7d'
  },
  timestamp: '2025-08-11T14:20:30.998Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '7.33',
    currency_code: 'USD',
    transaction_id: 1000015,
    transaction_timestamp: '2025-08-11 14:20:30',
    round_id: 371597,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000015',
      history_id: 'test-1000015'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "7.33",
    "currency_code": "USD",
    "transaction_id": 1000015,
    "transaction_timestamp": "2025-08-11 14:20:30",
    "round_id": 371597,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000015",
      "history_id": "test-1000015"
    }
  },
  "request_timestamp": "2025-08-11 14:20:30",
  "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 7.33, parsed: -7.33, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($7.33)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
CHANGEBALANCE user not found for token: test_token_123
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "4.17",
      "currency_code": "USD",
      "transaction_id": 1000018,
      "transaction_timestamp": "2025-08-11 14:20:30",
      "round_id": 575930,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000018",
        "history_id": "test-1000018"
      }
    },
    "request_timestamp": "2025-08-11 14:20:30",
    "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:31",
    "hash": "0b70c64a582fffc4eae661065b854cd792db8fbc",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "4.17",
      "currency_code": "USD",
      "transaction_id": 1000018,
      "transaction_timestamp": "2025-08-11 14:20:30",
      "round_id": 575930,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000018",
        "history_id": "test-1000018"
      }
    },
    "request_timestamp": "2025-08-11 14:20:30",
    "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:31",
    "hash": "0b70c64a582fffc4eae661065b854cd792db8fbc",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 10.678 ms - 679[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"0.94","currency_code":"USD","transaction_id":1000017,"transaction_timestamp":"2025-08-11 14:20:30","round_id":179403,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000017","history_id":"test-1000017"}},"request_timestamp":"2025-08-11 14:20:30","hash":"eb80975483d1a6e78df609e7d3171672bc9f8d7d"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fc50b552ae9-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fc50b552ae9-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '0.94',
      currency_code: 'USD',
      transaction_id: 1000017,
      transaction_timestamp: '2025-08-11 14:20:30',
      round_id: 179403,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:30',
    hash: 'eb80975483d1a6e78df609e7d3171672bc9f8d7d'
  },
  timestamp: '2025-08-11T14:20:31.007Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "0.94",
    "currency_code": "USD",
    "transaction_id": 1000017,
    "transaction_timestamp": "2025-08-11 14:20:30",
    "round_id": 179403,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000017",
      "history_id": "test-1000017"
    }
  },
  "request_timestamp": "2025-08-11 14:20:30",
  "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "0.94",
    "currency_code": "USD",
    "transaction_id": 1000017,
    "transaction_timestamp": "2025-08-11 14:20:30",
    "round_id": 179403,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000017",
      "history_id": "test-1000017"
    }
  },
  "request_timestamp": "2025-08-11 14:20:30",
  "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fc50b552ae9-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '0.94',
      currency_code: 'USD',
      transaction_id: 1000017,
      transaction_timestamp: '2025-08-11 14:20:30',
      round_id: 179403,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:30',
    hash: 'eb80975483d1a6e78df609e7d3171672bc9f8d7d'
  },
  timestamp: '2025-08-11T14:20:31.007Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '0.94',
    currency_code: 'USD',
    transaction_id: 1000017,
    transaction_timestamp: '2025-08-11 14:20:30',
    round_id: 179403,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000017',
      history_id: 'test-1000017'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "0.94",
    "currency_code": "USD",
    "transaction_id": 1000017,
    "transaction_timestamp": "2025-08-11 14:20:30",
    "round_id": 179403,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000017",
      "history_id": "test-1000017"
    }
  },
  "request_timestamp": "2025-08-11 14:20:30",
  "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: WIN, amount: 0.94, parsed: 0.94, type: WIN
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($0.94)',
  transaction_type: 'WIN',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
CHANGEBALANCE user not found for token: test_token_123
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "7.33",
      "currency_code": "USD",
      "transaction_id": 1000015,
      "transaction_timestamp": "2025-08-11 14:20:30",
      "round_id": 371597,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000015",
        "history_id": "test-1000015"
      }
    },
    "request_timestamp": "2025-08-11 14:20:30",
    "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:31",
    "hash": "0b70c64a582fffc4eae661065b854cd792db8fbc",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "7.33",
      "currency_code": "USD",
      "transaction_id": 1000015,
      "transaction_timestamp": "2025-08-11 14:20:30",
      "round_id": 371597,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000015",
        "history_id": "test-1000015"
      }
    },
    "request_timestamp": "2025-08-11 14:20:30",
    "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:31",
    "hash": "0b70c64a582fffc4eae661065b854cd792db8fbc",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 11.647 ms - 679[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"5.08","currency_code":"USD","transaction_id":1000019,"transaction_timestamp":"2025-08-11 14:20:30","round_id":403064,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000019","history_id":"test-1000019"}},"request_timestamp":"2025-08-11 14:20:30","hash":"eb80975483d1a6e78df609e7d3171672bc9f8d7d"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fc519b37d0a-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fc519b37d0a-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '5.08',
      currency_code: 'USD',
      transaction_id: 1000019,
      transaction_timestamp: '2025-08-11 14:20:30',
      round_id: 403064,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:30',
    hash: 'eb80975483d1a6e78df609e7d3171672bc9f8d7d'
  },
  timestamp: '2025-08-11T14:20:31.011Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "5.08",
    "currency_code": "USD",
    "transaction_id": 1000019,
    "transaction_timestamp": "2025-08-11 14:20:30",
    "round_id": 403064,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000019",
      "history_id": "test-1000019"
    }
  },
  "request_timestamp": "2025-08-11 14:20:30",
  "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "5.08",
    "currency_code": "USD",
    "transaction_id": 1000019,
    "transaction_timestamp": "2025-08-11 14:20:30",
    "round_id": 403064,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000019",
      "history_id": "test-1000019"
    }
  },
  "request_timestamp": "2025-08-11 14:20:30",
  "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fc519b37d0a-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '5.08',
      currency_code: 'USD',
      transaction_id: 1000019,
      transaction_timestamp: '2025-08-11 14:20:30',
      round_id: 403064,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:30',
    hash: 'eb80975483d1a6e78df609e7d3171672bc9f8d7d'
  },
  timestamp: '2025-08-11T14:20:31.012Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '5.08',
    currency_code: 'USD',
    transaction_id: 1000019,
    transaction_timestamp: '2025-08-11 14:20:30',
    round_id: 403064,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000019',
      history_id: 'test-1000019'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "5.08",
    "currency_code": "USD",
    "transaction_id": 1000019,
    "transaction_timestamp": "2025-08-11 14:20:30",
    "round_id": 403064,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000019",
      "history_id": "test-1000019"
    }
  },
  "request_timestamp": "2025-08-11 14:20:30",
  "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 5.08, parsed: -5.08, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($5.08)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "0.94",
      "currency_code": "USD",
      "transaction_id": 1000017,
      "transaction_timestamp": "2025-08-11 14:20:30",
      "round_id": 179403,
      "round_finished": false,
CHANGEBALANCE user not found for token: test_token_123
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000017",
        "history_id": "test-1000017"
      }
    },
    "request_timestamp": "2025-08-11 14:20:30",
    "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:31",
    "hash": "0b70c64a582fffc4eae661065b854cd792db8fbc",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "0.94",
      "currency_code": "USD",
      "transaction_id": 1000017,
      "transaction_timestamp": "2025-08-11 14:20:30",
      "round_id": 179403,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000017",
        "history_id": "test-1000017"
      }
    },
    "request_timestamp": "2025-08-11 14:20:30",
    "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:31",
    "hash": "0b70c64a582fffc4eae661065b854cd792db8fbc",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 8.262 ms - 679[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"3.34","currency_code":"USD","transaction_id":1000016,"transaction_timestamp":"2025-08-11 14:20:30","round_id":993852,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000016","history_id":"test-1000016"}},"request_timestamp":"2025-08-11 14:20:30","hash":"eb80975483d1a6e78df609e7d3171672bc9f8d7d"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fc51d23cd1f-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fc51d23cd1f-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '3.34',
      currency_code: 'USD',
      transaction_id: 1000016,
      transaction_timestamp: '2025-08-11 14:20:30',
      round_id: 993852,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:30',
    hash: 'eb80975483d1a6e78df609e7d3171672bc9f8d7d'
  },
  timestamp: '2025-08-11T14:20:31.017Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "3.34",
    "currency_code": "USD",
    "transaction_id": 1000016,
    "transaction_timestamp": "2025-08-11 14:20:30",
    "round_id": 993852,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000016",
      "history_id": "test-1000016"
    }
  },
  "request_timestamp": "2025-08-11 14:20:30",
  "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "3.34",
    "currency_code": "USD",
    "transaction_id": 1000016,
    "transaction_timestamp": "2025-08-11 14:20:30",
    "round_id": 993852,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000016",
      "history_id": "test-1000016"
    }
  },
  "request_timestamp": "2025-08-11 14:20:30",
  "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fc51d23cd1f-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '3.34',
      currency_code: 'USD',
      transaction_id: 1000016,
      transaction_timestamp: '2025-08-11 14:20:30',
      round_id: 993852,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:30',
    hash: 'eb80975483d1a6e78df609e7d3171672bc9f8d7d'
  },
  timestamp: '2025-08-11T14:20:31.017Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '3.34',
    currency_code: 'USD',
    transaction_id: 1000016,
    transaction_timestamp: '2025-08-11 14:20:30',
    round_id: 993852,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000016',
      history_id: 'test-1000016'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "3.34",
    "currency_code": "USD",
    "transaction_id": 1000016,
    "transaction_timestamp": "2025-08-11 14:20:30",
    "round_id": 993852,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000016",
      "history_id": "test-1000016"
    }
  },
  "request_timestamp": "2025-08-11 14:20:30",
  "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: WIN, amount: 3.34, parsed: 3.34, type: WIN
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($3.34)',
  transaction_type: 'WIN',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
CHANGEBALANCE user not found for token: test_token_123
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "5.08",
      "currency_code": "USD",
      "transaction_id": 1000019,
      "transaction_timestamp": "2025-08-11 14:20:30",
      "round_id": 403064,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000019",
        "history_id": "test-1000019"
      }
    },
    "request_timestamp": "2025-08-11 14:20:30",
    "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:31",
    "hash": "0b70c64a582fffc4eae661065b854cd792db8fbc",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "5.08",
      "currency_code": "USD",
      "transaction_id": 1000019,
      "transaction_timestamp": "2025-08-11 14:20:30",
      "round_id": 403064,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000019",
        "history_id": "test-1000019"
      }
    },
    "request_timestamp": "2025-08-11 14:20:30",
    "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:31",
    "hash": "0b70c64a582fffc4eae661065b854cd792db8fbc",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 8.478 ms - 679[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"8.93","currency_code":"USD","transaction_id":1000011,"transaction_timestamp":"2025-08-11 14:20:30","round_id":58528,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000011","history_id":"test-1000011"}},"request_timestamp":"2025-08-11 14:20:30","hash":"eb80975483d1a6e78df609e7d3171672bc9f8d7d"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fc51af00f19-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '463',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fc51af00f19-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '8.93',
      currency_code: 'USD',
      transaction_id: 1000011,
      transaction_timestamp: '2025-08-11 14:20:30',
      round_id: 58528,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:30',
    hash: 'eb80975483d1a6e78df609e7d3171672bc9f8d7d'
  },
  timestamp: '2025-08-11T14:20:31.026Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "8.93",
    "currency_code": "USD",
    "transaction_id": 1000011,
    "transaction_timestamp": "2025-08-11 14:20:30",
    "round_id": 58528,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000011",
      "history_id": "test-1000011"
    }
  },
  "request_timestamp": "2025-08-11 14:20:30",
  "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "8.93",
    "currency_code": "USD",
    "transaction_id": 1000011,
    "transaction_timestamp": "2025-08-11 14:20:30",
    "round_id": 58528,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000011",
      "history_id": "test-1000011"
    }
  },
  "request_timestamp": "2025-08-11 14:20:30",
  "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '463',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fc51af00f19-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '8.93',
      currency_code: 'USD',
      transaction_id: 1000011,
      transaction_timestamp: '2025-08-11 14:20:30',
      round_id: 58528,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:30',
    hash: 'eb80975483d1a6e78df609e7d3171672bc9f8d7d'
  },
  timestamp: '2025-08-11T14:20:31.026Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '8.93',
    currency_code: 'USD',
    transaction_id: 1000011,
    transaction_timestamp: '2025-08-11 14:20:30',
    round_id: 58528,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000011',
      history_id: 'test-1000011'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "8.93",
    "currency_code": "USD",
    "transaction_id": 1000011,
    "transaction_timestamp": "2025-08-11 14:20:30",
    "round_id": 58528,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000011",
      "history_id": "test-1000011"
    }
  },
  "request_timestamp": "2025-08-11 14:20:30",
  "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 8.93, parsed: -8.93, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($8.93)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
CHANGEBALANCE user not found for token: test_token_123
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "3.34",
      "currency_code": "USD",
      "transaction_id": 1000016,
      "transaction_timestamp": "2025-08-11 14:20:30",
      "round_id": 993852,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000016",
        "history_id": "test-1000016"
      }
    },
    "request_timestamp": "2025-08-11 14:20:30",
    "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:31",
    "hash": "0b70c64a582fffc4eae661065b854cd792db8fbc",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "3.34",
      "currency_code": "USD",
      "transaction_id": 1000016,
      "transaction_timestamp": "2025-08-11 14:20:30",
      "round_id": 993852,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000016",
        "history_id": "test-1000016"
      }
    },
    "request_timestamp": "2025-08-11 14:20:30",
    "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:31",
    "hash": "0b70c64a582fffc4eae661065b854cd792db8fbc",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 15.252 ms - 679[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"9.52","currency_code":"USD","transaction_id":1000013,"transaction_timestamp":"2025-08-11 14:20:30","round_id":85939,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000013","history_id":"test-1000013"}},"request_timestamp":"2025-08-11 14:20:30","hash":"eb80975483d1a6e78df609e7d3171672bc9f8d7d"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fc51c132f74-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '463',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fc51c132f74-LAX',
    'x-operator-id': 'thinkcode_stg',
    accept: 'application/json, text/plain, */*',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG',
    'cf-visitor': '{"scheme":"https"}',
    'x-forwarded-proto': 'https'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '9.52',
      currency_code: 'USD',
      transaction_id: 1000013,
      transaction_timestamp: '2025-08-11 14:20:30',
      round_id: 85939,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:30',
    hash: 'eb80975483d1a6e78df609e7d3171672bc9f8d7d'
  },
  timestamp: '2025-08-11T14:20:31.034Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "9.52",
    "currency_code": "USD",
    "transaction_id": 1000013,
    "transaction_timestamp": "2025-08-11 14:20:30",
    "round_id": 85939,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000013",
      "history_id": "test-1000013"
    }
  },
  "request_timestamp": "2025-08-11 14:20:30",
  "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "9.52",
    "currency_code": "USD",
    "transaction_id": 1000013,
    "transaction_timestamp": "2025-08-11 14:20:30",
    "round_id": 85939,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000013",
      "history_id": "test-1000013"
    }
  },
  "request_timestamp": "2025-08-11 14:20:30",
  "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '463',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fc51c132f74-LAX',
    'x-operator-id': 'thinkcode_stg',
    accept: 'application/json, text/plain, */*',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG',
    'cf-visitor': '{"scheme":"https"}',
    'x-forwarded-proto': 'https'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '9.52',
      currency_code: 'USD',
      transaction_id: 1000013,
      transaction_timestamp: '2025-08-11 14:20:30',
      round_id: 85939,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:30',
    hash: 'eb80975483d1a6e78df609e7d3171672bc9f8d7d'
  },
  timestamp: '2025-08-11T14:20:31.034Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '9.52',
    currency_code: 'USD',
    transaction_id: 1000013,
    transaction_timestamp: '2025-08-11 14:20:30',
    round_id: 85939,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000013',
      history_id: 'test-1000013'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "9.52",
    "currency_code": "USD",
    "transaction_id": 1000013,
    "transaction_timestamp": "2025-08-11 14:20:30",
    "round_id": 85939,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000013",
      "history_id": "test-1000013"
    }
  },
  "request_timestamp": "2025-08-11 14:20:30",
  "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: WIN, amount: 9.52, parsed: 9.52, type: WIN
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($9.52)',
  transaction_type: 'WIN',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
CHANGEBALANCE user not found for token: test_token_123
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "8.93",
      "currency_code": "USD",
      "transaction_id": 1000011,
      "transaction_timestamp": "2025-08-11 14:20:30",
      "round_id": 58528,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000011",
        "history_id": "test-1000011"
      }
    },
    "request_timestamp": "2025-08-11 14:20:30",
    "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:31",
    "hash": "0b70c64a582fffc4eae661065b854cd792db8fbc",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "8.93",
      "currency_code": "USD",
      "transaction_id": 1000011,
      "transaction_timestamp": "2025-08-11 14:20:30",
      "round_id": 58528,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000011",
        "history_id": "test-1000011"
      }
    },
    "request_timestamp": "2025-08-11 14:20:30",
    "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:31",
    "hash": "0b70c64a582fffc4eae661065b854cd792db8fbc",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 10.853 ms - 678[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"6.67","currency_code":"USD","transaction_id":1000014,"transaction_timestamp":"2025-08-11 14:20:30","round_id":98636,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000014","history_id":"test-1000014"}},"request_timestamp":"2025-08-11 14:20:30","hash":"eb80975483d1a6e78df609e7d3171672bc9f8d7d"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fc51d752abd-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '463',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fc51d752abd-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '6.67',
      currency_code: 'USD',
      transaction_id: 1000014,
      transaction_timestamp: '2025-08-11 14:20:30',
      round_id: 98636,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:30',
    hash: 'eb80975483d1a6e78df609e7d3171672bc9f8d7d'
  },
  timestamp: '2025-08-11T14:20:31.038Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "6.67",
    "currency_code": "USD",
    "transaction_id": 1000014,
    "transaction_timestamp": "2025-08-11 14:20:30",
    "round_id": 98636,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000014",
      "history_id": "test-1000014"
    }
  },
  "request_timestamp": "2025-08-11 14:20:30",
  "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "6.67",
    "currency_code": "USD",
    "transaction_id": 1000014,
    "transaction_timestamp": "2025-08-11 14:20:30",
    "round_id": 98636,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000014",
      "history_id": "test-1000014"
    }
  },
  "request_timestamp": "2025-08-11 14:20:30",
  "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '463',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fc51d752abd-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '6.67',
      currency_code: 'USD',
      transaction_id: 1000014,
      transaction_timestamp: '2025-08-11 14:20:30',
      round_id: 98636,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:30',
    hash: 'eb80975483d1a6e78df609e7d3171672bc9f8d7d'
  },
  timestamp: '2025-08-11T14:20:31.039Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '6.67',
    currency_code: 'USD',
    transaction_id: 1000014,
    transaction_timestamp: '2025-08-11 14:20:30',
    round_id: 98636,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000014',
      history_id: 'test-1000014'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "6.67",
    "currency_code": "USD",
    "transaction_id": 1000014,
    "transaction_timestamp": "2025-08-11 14:20:30",
    "round_id": 98636,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000014",
      "history_id": "test-1000014"
    }
  },
  "request_timestamp": "2025-08-11 14:20:30",
  "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: WIN, amount: 6.67, parsed: 6.67, type: WIN
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($6.67)',
  transaction_type: 'WIN',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
CHANGEBALANCE user not found for token: test_token_123
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "9.52",
      "currency_code": "USD",
      "transaction_id": 1000013,
      "transaction_timestamp": "2025-08-11 14:20:30",
      "round_id": 85939,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000013",
        "history_id": "test-1000013"
      }
    },
    "request_timestamp": "2025-08-11 14:20:30",
    "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:31",
    "hash": "0b70c64a582fffc4eae661065b854cd792db8fbc",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "9.52",
      "currency_code": "USD",
      "transaction_id": 1000013,
      "transaction_timestamp": "2025-08-11 14:20:30",
      "round_id": 85939,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000013",
        "history_id": "test-1000013"
      }
    },
    "request_timestamp": "2025-08-11 14:20:30",
    "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:31",
    "hash": "0b70c64a582fffc4eae661065b854cd792db8fbc",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 7.007 ms - 678[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"6.59","currency_code":"USD","transaction_id":1000010,"transaction_timestamp":"2025-08-11 14:20:30","round_id":762817,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000010","history_id":"test-1000010"}},"request_timestamp":"2025-08-11 14:20:30","hash":"eb80975483d1a6e78df609e7d3171672bc9f8d7d"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fc5185c1028-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fc5185c1028-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '6.59',
      currency_code: 'USD',
      transaction_id: 1000010,
      transaction_timestamp: '2025-08-11 14:20:30',
      round_id: 762817,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:30',
    hash: 'eb80975483d1a6e78df609e7d3171672bc9f8d7d'
  },
  timestamp: '2025-08-11T14:20:31.042Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "6.59",
    "currency_code": "USD",
    "transaction_id": 1000010,
    "transaction_timestamp": "2025-08-11 14:20:30",
    "round_id": 762817,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000010",
      "history_id": "test-1000010"
    }
  },
  "request_timestamp": "2025-08-11 14:20:30",
  "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "6.59",
    "currency_code": "USD",
    "transaction_id": 1000010,
    "transaction_timestamp": "2025-08-11 14:20:30",
    "round_id": 762817,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000010",
      "history_id": "test-1000010"
    }
  },
  "request_timestamp": "2025-08-11 14:20:30",
  "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fc5185c1028-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '6.59',
      currency_code: 'USD',
      transaction_id: 1000010,
      transaction_timestamp: '2025-08-11 14:20:30',
      round_id: 762817,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:30',
    hash: 'eb80975483d1a6e78df609e7d3171672bc9f8d7d'
  },
  timestamp: '2025-08-11T14:20:31.043Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '6.59',
    currency_code: 'USD',
    transaction_id: 1000010,
    transaction_timestamp: '2025-08-11 14:20:30',
    round_id: 762817,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000010',
      history_id: 'test-1000010'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "6.59",
    "currency_code": "USD",
    "transaction_id": 1000010,
    "transaction_timestamp": "2025-08-11 14:20:30",
    "round_id": 762817,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000010",
      "history_id": "test-1000010"
    }
  },
  "request_timestamp": "2025-08-11 14:20:30",
  "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: WIN, amount: 6.59, parsed: 6.59, type: WIN
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($6.59)',
  transaction_type: 'WIN',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "6.67",
      "currency_code": "USD",
      "transaction_id": 1000014,
      "transaction_timestamp": "2025-08-11 14:20:30",
CHANGEBALANCE user not found for token: test_token_123
CHANGEBALANCE user not found for token: test_token_123
      "round_id": 98636,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000014",
        "history_id": "test-1000014"
      }
    },
    "request_timestamp": "2025-08-11 14:20:30",
    "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:31",
    "hash": "0b70c64a582fffc4eae661065b854cd792db8fbc",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "6.67",
      "currency_code": "USD",
      "transaction_id": 1000014,
      "transaction_timestamp": "2025-08-11 14:20:30",
      "round_id": 98636,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000014",
        "history_id": "test-1000014"
      }
    },
    "request_timestamp": "2025-08-11 14:20:30",
    "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:31",
    "hash": "0b70c64a582fffc4eae661065b854cd792db8fbc",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 6.827 ms - 678[0m
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "6.59",
      "currency_code": "USD",
      "transaction_id": 1000010,
      "transaction_timestamp": "2025-08-11 14:20:30",
      "round_id": 762817,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000010",
        "history_id": "test-1000010"
      }
    },
    "request_timestamp": "2025-08-11 14:20:30",
    "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:31",
    "hash": "0b70c64a582fffc4eae661065b854cd792db8fbc",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "6.59",
      "currency_code": "USD",
      "transaction_id": 1000010,
      "transaction_timestamp": "2025-08-11 14:20:30",
      "round_id": 762817,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000010",
        "history_id": "test-1000010"
      }
    },
    "request_timestamp": "2025-08-11 14:20:30",
    "hash": "eb80975483d1a6e78df609e7d3171672bc9f8d7d"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:31",
    "hash": "0b70c64a582fffc4eae661065b854cd792db8fbc",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 4.478 ms - 679[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"8.65","currency_code":"USD","transaction_id":1000024,"transaction_timestamp":"2025-08-11 14:20:32","round_id":578919,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000024","history_id":"test-1000024"}},"request_timestamp":"2025-08-11 14:20:32","hash":"2f13604f611d5bb210c51be437cfb05c1f43c17c"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fce3906cb91-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fce3906cb91-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '8.65',
      currency_code: 'USD',
      transaction_id: 1000024,
      transaction_timestamp: '2025-08-11 14:20:32',
      round_id: 578919,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:32',
    hash: '2f13604f611d5bb210c51be437cfb05c1f43c17c'
  },
  timestamp: '2025-08-11T14:20:32.449Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "8.65",
    "currency_code": "USD",
    "transaction_id": 1000024,
    "transaction_timestamp": "2025-08-11 14:20:32",
    "round_id": 578919,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000024",
      "history_id": "test-1000024"
    }
  },
  "request_timestamp": "2025-08-11 14:20:32",
  "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "8.65",
    "currency_code": "USD",
    "transaction_id": 1000024,
    "transaction_timestamp": "2025-08-11 14:20:32",
    "round_id": 578919,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000024",
      "history_id": "test-1000024"
    }
  },
  "request_timestamp": "2025-08-11 14:20:32",
  "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fce3906cb91-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '8.65',
      currency_code: 'USD',
      transaction_id: 1000024,
      transaction_timestamp: '2025-08-11 14:20:32',
      round_id: 578919,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:32',
    hash: '2f13604f611d5bb210c51be437cfb05c1f43c17c'
  },
  timestamp: '2025-08-11T14:20:32.450Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '8.65',
    currency_code: 'USD',
    transaction_id: 1000024,
    transaction_timestamp: '2025-08-11 14:20:32',
    round_id: 578919,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000024',
      history_id: 'test-1000024'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "8.65",
    "currency_code": "USD",
    "transaction_id": 1000024,
    "transaction_timestamp": "2025-08-11 14:20:32",
    "round_id": 578919,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000024",
      "history_id": "test-1000024"
    }
  },
  "request_timestamp": "2025-08-11 14:20:32",
  "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 8.65, parsed: -8.65, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($8.65)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"2.06","currency_code":"USD","transaction_id":1000029,"transaction_timestamp":"2025-08-11 14:20:32","round_id":194793,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000029","history_id":"test-1000029"}},"request_timestamp":"2025-08-11 14:20:32","hash":"2f13604f611d5bb210c51be437cfb05c1f43c17c"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fce3d1f7ceb-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fce3d1f7ceb-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '2.06',
      currency_code: 'USD',
      transaction_id: 1000029,
      transaction_timestamp: '2025-08-11 14:20:32',
      round_id: 194793,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:32',
    hash: '2f13604f611d5bb210c51be437cfb05c1f43c17c'
  },
  timestamp: '2025-08-11T14:20:32.455Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "2.06",
    "currency_code": "USD",
    "transaction_id": 1000029,
    "transaction_timestamp": "2025-08-11 14:20:32",
    "round_id": 194793,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000029",
      "history_id": "test-1000029"
    }
  },
  "request_timestamp": "2025-08-11 14:20:32",
  "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "2.06",
    "currency_code": "USD",
    "transaction_id": 1000029,
    "transaction_timestamp": "2025-08-11 14:20:32",
    "round_id": 194793,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000029",
      "history_id": "test-1000029"
    }
  },
  "request_timestamp": "2025-08-11 14:20:32",
  "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fce3d1f7ceb-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '2.06',
      currency_code: 'USD',
      transaction_id: 1000029,
      transaction_timestamp: '2025-08-11 14:20:32',
      round_id: 194793,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:32',
    hash: '2f13604f611d5bb210c51be437cfb05c1f43c17c'
  },
  timestamp: '2025-08-11T14:20:32.456Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '2.06',
    currency_code: 'USD',
    transaction_id: 1000029,
    transaction_timestamp: '2025-08-11 14:20:32',
    round_id: 194793,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000029',
      history_id: 'test-1000029'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "2.06",
    "currency_code": "USD",
    "transaction_id": 1000029,
    "transaction_timestamp": "2025-08-11 14:20:32",
    "round_id": 194793,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000029",
      "history_id": "test-1000029"
    }
  },
  "request_timestamp": "2025-08-11 14:20:32",
  "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 2.06, parsed: -2.06, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($2.06)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
CHANGEBALANCE user not found for token: test_token_123
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "8.65",
      "currency_code": "USD",
      "transaction_id": 1000024,
      "transaction_timestamp": "2025-08-11 14:20:32",
      "round_id": 578919,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000024",
        "history_id": "test-1000024"
      }
    },
    "request_timestamp": "2025-08-11 14:20:32",
    "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:32",
    "hash": "96946030208be0039b265b12b485f3d68334585e",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "8.65",
      "currency_code": "USD",
      "transaction_id": 1000024,
      "transaction_timestamp": "2025-08-11 14:20:32",
      "round_id": 578919,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000024",
        "history_id": "test-1000024"
      }
    },
    "request_timestamp": "2025-08-11 14:20:32",
    "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:32",
    "hash": "96946030208be0039b265b12b485f3d68334585e",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 9.283 ms - 679[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"9.93","currency_code":"USD","transaction_id":1000026,"transaction_timestamp":"2025-08-11 14:20:32","round_id":724957,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000026","history_id":"test-1000026"}},"request_timestamp":"2025-08-11 14:20:32","hash":"2f13604f611d5bb210c51be437cfb05c1f43c17c"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fce3a527d0a-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fce3a527d0a-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '9.93',
      currency_code: 'USD',
      transaction_id: 1000026,
      transaction_timestamp: '2025-08-11 14:20:32',
      round_id: 724957,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:32',
    hash: '2f13604f611d5bb210c51be437cfb05c1f43c17c'
  },
  timestamp: '2025-08-11T14:20:32.460Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "9.93",
    "currency_code": "USD",
    "transaction_id": 1000026,
    "transaction_timestamp": "2025-08-11 14:20:32",
    "round_id": 724957,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000026",
      "history_id": "test-1000026"
    }
  },
  "request_timestamp": "2025-08-11 14:20:32",
  "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "9.93",
    "currency_code": "USD",
    "transaction_id": 1000026,
    "transaction_timestamp": "2025-08-11 14:20:32",
    "round_id": 724957,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000026",
      "history_id": "test-1000026"
    }
  },
  "request_timestamp": "2025-08-11 14:20:32",
  "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fce3a527d0a-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '9.93',
      currency_code: 'USD',
      transaction_id: 1000026,
      transaction_timestamp: '2025-08-11 14:20:32',
      round_id: 724957,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
CHANGEBALANCE user not found for token: test_token_123
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:32',
    hash: '2f13604f611d5bb210c51be437cfb05c1f43c17c'
  },
  timestamp: '2025-08-11T14:20:32.460Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '9.93',
    currency_code: 'USD',
    transaction_id: 1000026,
    transaction_timestamp: '2025-08-11 14:20:32',
    round_id: 724957,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000026',
      history_id: 'test-1000026'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "9.93",
    "currency_code": "USD",
    "transaction_id": 1000026,
    "transaction_timestamp": "2025-08-11 14:20:32",
    "round_id": 724957,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000026",
      "history_id": "test-1000026"
    }
  },
  "request_timestamp": "2025-08-11 14:20:32",
  "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: WIN, amount: 9.93, parsed: 9.93, type: WIN
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($9.93)',
  transaction_type: 'WIN',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "2.06",
      "currency_code": "USD",
      "transaction_id": 1000029,
      "transaction_timestamp": "2025-08-11 14:20:32",
      "round_id": 194793,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000029",
        "history_id": "test-1000029"
      }
    },
    "request_timestamp": "2025-08-11 14:20:32",
    "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:32",
    "hash": "96946030208be0039b265b12b485f3d68334585e",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "2.06",
      "currency_code": "USD",
      "transaction_id": 1000029,
      "transaction_timestamp": "2025-08-11 14:20:32",
      "round_id": 194793,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000029",
        "history_id": "test-1000029"
      }
    },
    "request_timestamp": "2025-08-11 14:20:32",
    "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:32",
    "hash": "96946030208be0039b265b12b485f3d68334585e",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 7.775 ms - 679[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"6.15","currency_code":"USD","transaction_id":1000027,"transaction_timestamp":"2025-08-11 14:20:32","round_id":67176,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000027","history_id":"test-1000027"}},"request_timestamp":"2025-08-11 14:20:32","hash":"2f13604f611d5bb210c51be437cfb05c1f43c17c"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fce2c232ae9-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '463',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fce2c232ae9-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '6.15',
      currency_code: 'USD',
      transaction_id: 1000027,
      transaction_timestamp: '2025-08-11 14:20:32',
      round_id: 67176,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:32',
    hash: '2f13604f611d5bb210c51be437cfb05c1f43c17c'
  },
  timestamp: '2025-08-11T14:20:32.465Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "6.15",
    "currency_code": "USD",
    "transaction_id": 1000027,
    "transaction_timestamp": "2025-08-11 14:20:32",
    "round_id": 67176,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000027",
      "history_id": "test-1000027"
    }
  },
  "request_timestamp": "2025-08-11 14:20:32",
  "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "6.15",
    "currency_code": "USD",
    "transaction_id": 1000027,
    "transaction_timestamp": "2025-08-11 14:20:32",
    "round_id": 67176,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000027",
      "history_id": "test-1000027"
    }
  },
  "request_timestamp": "2025-08-11 14:20:32",
  "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '463',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fce2c232ae9-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '6.15',
      currency_code: 'USD',
      transaction_id: 1000027,
      transaction_timestamp: '2025-08-11 14:20:32',
      round_id: 67176,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:32',
    hash: '2f13604f611d5bb210c51be437cfb05c1f43c17c'
  },
  timestamp: '2025-08-11T14:20:32.465Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '6.15',
    currency_code: 'USD',
    transaction_id: 1000027,
    transaction_timestamp: '2025-08-11 14:20:32',
    round_id: 67176,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000027',
      history_id: 'test-1000027'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "6.15",
    "currency_code": "USD",
    "transaction_id": 1000027,
    "transaction_timestamp": "2025-08-11 14:20:32",
    "round_id": 67176,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000027",
      "history_id": "test-1000027"
    }
  },
  "request_timestamp": "2025-08-11 14:20:32",
  "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: WIN, amount: 6.15, parsed: 6.15, type: WIN
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($6.15)',
  transaction_type: 'WIN',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
CHANGEBALANCE user not found for token: test_token_123
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "9.93",
      "currency_code": "USD",
      "transaction_id": 1000026,
      "transaction_timestamp": "2025-08-11 14:20:32",
      "round_id": 724957,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000026",
        "history_id": "test-1000026"
      }
    },
    "request_timestamp": "2025-08-11 14:20:32",
    "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:32",
    "hash": "96946030208be0039b265b12b485f3d68334585e",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "9.93",
      "currency_code": "USD",
      "transaction_id": 1000026,
      "transaction_timestamp": "2025-08-11 14:20:32",
      "round_id": 724957,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000026",
        "history_id": "test-1000026"
      }
    },
    "request_timestamp": "2025-08-11 14:20:32",
    "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:32",
    "hash": "96946030208be0039b265b12b485f3d68334585e",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 9.858 ms - 679[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"2.55","currency_code":"USD","transaction_id":1000028,"transaction_timestamp":"2025-08-11 14:20:32","round_id":450539,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000028","history_id":"test-1000028"}},"request_timestamp":"2025-08-11 14:20:32","hash":"2f13604f611d5bb210c51be437cfb05c1f43c17c"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fce3eec08ac-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fce3eec08ac-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '2.55',
      currency_code: 'USD',
      transaction_id: 1000028,
      transaction_timestamp: '2025-08-11 14:20:32',
      round_id: 450539,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:32',
    hash: '2f13604f611d5bb210c51be437cfb05c1f43c17c'
  },
  timestamp: '2025-08-11T14:20:32.472Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "2.55",
    "currency_code": "USD",
    "transaction_id": 1000028,
    "transaction_timestamp": "2025-08-11 14:20:32",
    "round_id": 450539,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000028",
      "history_id": "test-1000028"
    }
  },
  "request_timestamp": "2025-08-11 14:20:32",
  "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "2.55",
    "currency_code": "USD",
    "transaction_id": 1000028,
    "transaction_timestamp": "2025-08-11 14:20:32",
    "round_id": 450539,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000028",
      "history_id": "test-1000028"
    }
  },
  "request_timestamp": "2025-08-11 14:20:32",
  "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fce3eec08ac-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '2.55',
      currency_code: 'USD',
      transaction_id: 1000028,
      transaction_timestamp: '2025-08-11 14:20:32',
      round_id: 450539,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:32',
    hash: '2f13604f611d5bb210c51be437cfb05c1f43c17c'
  },
  timestamp: '2025-08-11T14:20:32.472Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '2.55',
    currency_code: 'USD',
    transaction_id: 1000028,
    transaction_timestamp: '2025-08-11 14:20:32',
    round_id: 450539,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000028',
      history_id: 'test-1000028'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "2.55",
    "currency_code": "USD",
    "transaction_id": 1000028,
    "transaction_timestamp": "2025-08-11 14:20:32",
    "round_id": 450539,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000028",
      "history_id": "test-1000028"
    }
  },
  "request_timestamp": "2025-08-11 14:20:32",
  "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 2.55, parsed: -2.55, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($2.55)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
CHANGEBALANCE user not found for token: test_token_123
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "6.15",
      "currency_code": "USD",
      "transaction_id": 1000027,
      "transaction_timestamp": "2025-08-11 14:20:32",
      "round_id": 67176,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000027",
        "history_id": "test-1000027"
      }
    },
    "request_timestamp": "2025-08-11 14:20:32",
    "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:32",
    "hash": "96946030208be0039b265b12b485f3d68334585e",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "6.15",
      "currency_code": "USD",
      "transaction_id": 1000027,
      "transaction_timestamp": "2025-08-11 14:20:32",
      "round_id": 67176,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000027",
        "history_id": "test-1000027"
      }
    },
    "request_timestamp": "2025-08-11 14:20:32",
    "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:32",
    "hash": "96946030208be0039b265b12b485f3d68334585e",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 11.971 ms - 678[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"0.23","currency_code":"USD","transaction_id":1000025,"transaction_timestamp":"2025-08-11 14:20:32","round_id":164801,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000025","history_id":"test-1000025"}},"request_timestamp":"2025-08-11 14:20:32","hash":"2f13604f611d5bb210c51be437cfb05c1f43c17c"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fce3f1acd1f-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fce3f1acd1f-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '0.23',
      currency_code: 'USD',
      transaction_id: 1000025,
      transaction_timestamp: '2025-08-11 14:20:32',
      round_id: 164801,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:32',
    hash: '2f13604f611d5bb210c51be437cfb05c1f43c17c'
  },
  timestamp: '2025-08-11T14:20:32.479Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "0.23",
    "currency_code": "USD",
    "transaction_id": 1000025,
    "transaction_timestamp": "2025-08-11 14:20:32",
    "round_id": 164801,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000025",
      "history_id": "test-1000025"
    }
  },
  "request_timestamp": "2025-08-11 14:20:32",
  "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "0.23",
    "currency_code": "USD",
    "transaction_id": 1000025,
    "transaction_timestamp": "2025-08-11 14:20:32",
    "round_id": 164801,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000025",
      "history_id": "test-1000025"
    }
  },
  "request_timestamp": "2025-08-11 14:20:32",
  "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fce3f1acd1f-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '0.23',
      currency_code: 'USD',
      transaction_id: 1000025,
      transaction_timestamp: '2025-08-11 14:20:32',
      round_id: 164801,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:32',
    hash: '2f13604f611d5bb210c51be437cfb05c1f43c17c'
  },
  timestamp: '2025-08-11T14:20:32.479Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '0.23',
    currency_code: 'USD',
    transaction_id: 1000025,
    transaction_timestamp: '2025-08-11 14:20:32',
    round_id: 164801,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000025',
      history_id: 'test-1000025'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "0.23",
    "currency_code": "USD",
    "transaction_id": 1000025,
    "transaction_timestamp": "2025-08-11 14:20:32",
    "round_id": 164801,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000025",
      "history_id": "test-1000025"
    }
  },
  "request_timestamp": "2025-08-11 14:20:32",
  "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 0.23, parsed: -0.23, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($0.23)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
CHANGEBALANCE user not found for token: test_token_123
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "2.55",
      "currency_code": "USD",
      "transaction_id": 1000028,
      "transaction_timestamp": "2025-08-11 14:20:32",
      "round_id": 450539,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000028",
        "history_id": "test-1000028"
      }
    },
    "request_timestamp": "2025-08-11 14:20:32",
    "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:32",
    "hash": "96946030208be0039b265b12b485f3d68334585e",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "2.55",
      "currency_code": "USD",
      "transaction_id": 1000028,
      "transaction_timestamp": "2025-08-11 14:20:32",
      "round_id": 450539,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000028",
        "history_id": "test-1000028"
      }
    },
    "request_timestamp": "2025-08-11 14:20:32",
    "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:32",
    "hash": "96946030208be0039b265b12b485f3d68334585e",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 9.319 ms - 679[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"1.79","currency_code":"USD","transaction_id":1000022,"transaction_timestamp":"2025-08-11 14:20:32","round_id":786749,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000022","history_id":"test-1000022"}},"request_timestamp":"2025-08-11 14:20:32","hash":"2f13604f611d5bb210c51be437cfb05c1f43c17c"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fce3e4b2abd-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fce3e4b2abd-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '1.79',
      currency_code: 'USD',
      transaction_id: 1000022,
      transaction_timestamp: '2025-08-11 14:20:32',
      round_id: 786749,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:32',
    hash: '2f13604f611d5bb210c51be437cfb05c1f43c17c'
  },
  timestamp: '2025-08-11T14:20:32.485Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "1.79",
    "currency_code": "USD",
    "transaction_id": 1000022,
    "transaction_timestamp": "2025-08-11 14:20:32",
    "round_id": 786749,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000022",
      "history_id": "test-1000022"
    }
  },
  "request_timestamp": "2025-08-11 14:20:32",
  "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "1.79",
    "currency_code": "USD",
    "transaction_id": 1000022,
    "transaction_timestamp": "2025-08-11 14:20:32",
    "round_id": 786749,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000022",
      "history_id": "test-1000022"
    }
  },
  "request_timestamp": "2025-08-11 14:20:32",
  "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fce3e4b2abd-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '1.79',
      currency_code: 'USD',
      transaction_id: 1000022,
      transaction_timestamp: '2025-08-11 14:20:32',
      round_id: 786749,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:32',
    hash: '2f13604f611d5bb210c51be437cfb05c1f43c17c'
  },
  timestamp: '2025-08-11T14:20:32.486Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '1.79',
    currency_code: 'USD',
    transaction_id: 1000022,
    transaction_timestamp: '2025-08-11 14:20:32',
    round_id: 786749,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000022',
      history_id: 'test-1000022'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "1.79",
    "currency_code": "USD",
    "transaction_id": 1000022,
    "transaction_timestamp": "2025-08-11 14:20:32",
    "round_id": 786749,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000022",
      "history_id": "test-1000022"
    }
  },
  "request_timestamp": "2025-08-11 14:20:32",
  "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 1.79, parsed: -1.79, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($1.79)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
CHANGEBALANCE user not found for token: test_token_123
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "0.23",
      "currency_code": "USD",
      "transaction_id": 1000025,
      "transaction_timestamp": "2025-08-11 14:20:32",
      "round_id": 164801,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000025",
        "history_id": "test-1000025"
      }
    },
    "request_timestamp": "2025-08-11 14:20:32",
    "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:32",
    "hash": "96946030208be0039b265b12b485f3d68334585e",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "0.23",
      "currency_code": "USD",
      "transaction_id": 1000025,
      "transaction_timestamp": "2025-08-11 14:20:32",
      "round_id": 164801,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000025",
        "history_id": "test-1000025"
      }
    },
    "request_timestamp": "2025-08-11 14:20:32",
    "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:32",
    "hash": "96946030208be0039b265b12b485f3d68334585e",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 14.343 ms - 679[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"4.59","currency_code":"USD","transaction_id":1000021,"transaction_timestamp":"2025-08-11 14:20:32","round_id":503781,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000021","history_id":"test-1000021"}},"request_timestamp":"2025-08-11 14:20:32","hash":"2f13604f611d5bb210c51be437cfb05c1f43c17c"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fce39f60f19-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fce39f60f19-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '4.59',
      currency_code: 'USD',
      transaction_id: 1000021,
      transaction_timestamp: '2025-08-11 14:20:32',
      round_id: 503781,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:32',
    hash: '2f13604f611d5bb210c51be437cfb05c1f43c17c'
  },
  timestamp: '2025-08-11T14:20:32.494Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "4.59",
    "currency_code": "USD",
    "transaction_id": 1000021,
    "transaction_timestamp": "2025-08-11 14:20:32",
    "round_id": 503781,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000021",
      "history_id": "test-1000021"
    }
  },
  "request_timestamp": "2025-08-11 14:20:32",
  "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "4.59",
    "currency_code": "USD",
    "transaction_id": 1000021,
    "transaction_timestamp": "2025-08-11 14:20:32",
    "round_id": 503781,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000021",
      "history_id": "test-1000021"
    }
  },
  "request_timestamp": "2025-08-11 14:20:32",
  "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fce39f60f19-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '4.59',
      currency_code: 'USD',
      transaction_id: 1000021,
      transaction_timestamp: '2025-08-11 14:20:32',
      round_id: 503781,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:32',
    hash: '2f13604f611d5bb210c51be437cfb05c1f43c17c'
  },
  timestamp: '2025-08-11T14:20:32.497Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '4.59',
    currency_code: 'USD',
    transaction_id: 1000021,
    transaction_timestamp: '2025-08-11 14:20:32',
    round_id: 503781,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000021',
      history_id: 'test-1000021'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "4.59",
    "currency_code": "USD",
    "transaction_id": 1000021,
    "transaction_timestamp": "2025-08-11 14:20:32",
    "round_id": 503781,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000021",
      "history_id": "test-1000021"
    }
  },
  "request_timestamp": "2025-08-11 14:20:32",
  "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 4.59, parsed: -4.59, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($4.59)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "1.79",
      "currency_code": "USD",
      "transaction_id": 1000022,
      "transaction_timestamp": "2025-08-11 14:20:32",
      "round_id": 786749,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000022",
        "history_id": "test-1000022"
      }
    },
    "request_timestamp": "2025-08-11 14:20:32",
    "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:32",
    "hash": "96946030208be0039b265b12b485f3d68334585e",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "1.79",
      "currency_code": "USD",
      "transaction_id": 1000022,
      "transaction_timestamp": "2025-08-11 14:20:32",
      "round_id": 786749,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
CHANGEBALANCE user not found for token: test_token_123
        "urid": "TEST1000022",
        "history_id": "test-1000022"
      }
    },
    "request_timestamp": "2025-08-11 14:20:32",
    "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:32",
    "hash": "96946030208be0039b265b12b485f3d68334585e",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 13.739 ms - 679[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"6.40","currency_code":"USD","transaction_id":1000020,"transaction_timestamp":"2025-08-11 14:20:32","round_id":831180,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000020","history_id":"test-1000020"}},"request_timestamp":"2025-08-11 14:20:32","hash":"2f13604f611d5bb210c51be437cfb05c1f43c17c"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fce392c1028-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fce392c1028-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '6.40',
      currency_code: 'USD',
      transaction_id: 1000020,
      transaction_timestamp: '2025-08-11 14:20:32',
      round_id: 831180,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:32',
    hash: '2f13604f611d5bb210c51be437cfb05c1f43c17c'
  },
  timestamp: '2025-08-11T14:20:32.500Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "6.40",
    "currency_code": "USD",
    "transaction_id": 1000020,
    "transaction_timestamp": "2025-08-11 14:20:32",
    "round_id": 831180,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000020",
      "history_id": "test-1000020"
    }
  },
  "request_timestamp": "2025-08-11 14:20:32",
  "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "6.40",
    "currency_code": "USD",
    "transaction_id": 1000020,
    "transaction_timestamp": "2025-08-11 14:20:32",
    "round_id": 831180,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000020",
      "history_id": "test-1000020"
    }
  },
  "request_timestamp": "2025-08-11 14:20:32",
  "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fce392c1028-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '6.40',
      currency_code: 'USD',
      transaction_id: 1000020,
      transaction_timestamp: '2025-08-11 14:20:32',
      round_id: 831180,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:32',
    hash: '2f13604f611d5bb210c51be437cfb05c1f43c17c'
  },
  timestamp: '2025-08-11T14:20:32.501Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '6.40',
    currency_code: 'USD',
    transaction_id: 1000020,
    transaction_timestamp: '2025-08-11 14:20:32',
    round_id: 831180,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000020',
      history_id: 'test-1000020'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "6.40",
    "currency_code": "USD",
    "transaction_id": 1000020,
    "transaction_timestamp": "2025-08-11 14:20:32",
    "round_id": 831180,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000020",
      "history_id": "test-1000020"
    }
  },
  "request_timestamp": "2025-08-11 14:20:32",
  "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: WIN, amount: 6.40, parsed: 6.4, type: WIN
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($6.40)',
  transaction_type: 'WIN',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
CHANGEBALANCE user not found for token: test_token_123
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "4.59",
      "currency_code": "USD",
      "transaction_id": 1000021,
      "transaction_timestamp": "2025-08-11 14:20:32",
      "round_id": 503781,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000021",
        "history_id": "test-1000021"
      }
    },
    "request_timestamp": "2025-08-11 14:20:32",
    "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:32",
    "hash": "96946030208be0039b265b12b485f3d68334585e",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "4.59",
      "currency_code": "USD",
      "transaction_id": 1000021,
      "transaction_timestamp": "2025-08-11 14:20:32",
      "round_id": 503781,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000021",
        "history_id": "test-1000021"
      }
    },
    "request_timestamp": "2025-08-11 14:20:32",
    "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:32",
    "hash": "96946030208be0039b265b12b485f3d68334585e",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 8.440 ms - 679[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"5.34","currency_code":"USD","transaction_id":1000023,"transaction_timestamp":"2025-08-11 14:20:32","round_id":657960,"round_finished":false,"game_id":4,"user_id":"48","token":"test_token_123","context":{"reason":"not_provided","urid":"TEST1000023","history_id":"test-1000023"}},"request_timestamp":"2025-08-11 14:20:32","hash":"2f13604f611d5bb210c51be437cfb05c1f43c17c"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fce3c382f74-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fce3c382f74-LAX',
    'x-operator-id': 'thinkcode_stg',
    accept: 'application/json, text/plain, */*',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG',
    'cf-visitor': '{"scheme":"https"}',
    'x-forwarded-proto': 'https'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '5.34',
      currency_code: 'USD',
      transaction_id: 1000023,
      transaction_timestamp: '2025-08-11 14:20:32',
      round_id: 657960,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:32',
    hash: '2f13604f611d5bb210c51be437cfb05c1f43c17c'
  },
  timestamp: '2025-08-11T14:20:32.505Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "5.34",
    "currency_code": "USD",
    "transaction_id": 1000023,
    "transaction_timestamp": "2025-08-11 14:20:32",
    "round_id": 657960,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000023",
      "history_id": "test-1000023"
    }
  },
  "request_timestamp": "2025-08-11 14:20:32",
  "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "5.34",
    "currency_code": "USD",
    "transaction_id": 1000023,
    "transaction_timestamp": "2025-08-11 14:20:32",
    "round_id": 657960,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000023",
      "history_id": "test-1000023"
    }
  },
  "request_timestamp": "2025-08-11 14:20:32",
  "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '464',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d85fce3c382f74-LAX',
    'x-operator-id': 'thinkcode_stg',
    accept: 'application/json, text/plain, */*',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG',
    'cf-visitor': '{"scheme":"https"}',
    'x-forwarded-proto': 'https'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '5.34',
      currency_code: 'USD',
      transaction_id: 1000023,
      transaction_timestamp: '2025-08-11 14:20:32',
      round_id: 657960,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: 'test_token_123',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:20:32',
    hash: '2f13604f611d5bb210c51be437cfb05c1f43c17c'
  },
  timestamp: '2025-08-11T14:20:32.505Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '5.34',
    currency_code: 'USD',
    transaction_id: 1000023,
    transaction_timestamp: '2025-08-11 14:20:32',
    round_id: 657960,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: 'test_token_123',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000023',
      history_id: 'test-1000023'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "5.34",
    "currency_code": "USD",
    "transaction_id": 1000023,
    "transaction_timestamp": "2025-08-11 14:20:32",
    "round_id": 657960,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "test_token_123",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000023",
      "history_id": "test-1000023"
    }
  },
  "request_timestamp": "2025-08-11 14:20:32",
  "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 5.34, parsed: -5.34, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($5.34)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
CHANGEBALANCE user not found for token: test_token_123
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "6.40",
      "currency_code": "USD",
      "transaction_id": 1000020,
      "transaction_timestamp": "2025-08-11 14:20:32",
      "round_id": 831180,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000020",
        "history_id": "test-1000020"
      }
    },
    "request_timestamp": "2025-08-11 14:20:32",
    "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:32",
    "hash": "96946030208be0039b265b12b485f3d68334585e",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "6.40",
      "currency_code": "USD",
      "transaction_id": 1000020,
      "transaction_timestamp": "2025-08-11 14:20:32",
      "round_id": 831180,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000020",
        "history_id": "test-1000020"
      }
    },
    "request_timestamp": "2025-08-11 14:20:32",
    "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:32",
    "hash": "96946030208be0039b265b12b485f3d68334585e",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 6.507 ms - 679[0m
CHANGEBALANCE user not found for token: test_token_123
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "5.34",
      "currency_code": "USD",
      "transaction_id": 1000023,
      "transaction_timestamp": "2025-08-11 14:20:32",
      "round_id": 657960,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000023",
        "history_id": "test-1000023"
      }
    },
    "request_timestamp": "2025-08-11 14:20:32",
    "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:32",
    "hash": "96946030208be0039b265b12b485f3d68334585e",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "5.34",
      "currency_code": "USD",
      "transaction_id": 1000023,
      "transaction_timestamp": "2025-08-11 14:20:32",
      "round_id": 657960,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "test_token_123",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000023",
        "history_id": "test-1000023"
      }
    },
    "request_timestamp": "2025-08-11 14:20:32",
    "hash": "2f13604f611d5bb210c51be437cfb05c1f43c17c"
  },
  "response": {
    "status": "ERROR",
    "response_timestamp": "2025-08-11 14:20:32",
    "hash": "96946030208be0039b265b12b485f3d68334585e",
    "data": {
      "error_code": "OP_21",
      "error_message": "User not found or token expired"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 3.636 ms - 679[0m
[APP DEBUG] Incoming request: GET /api/user/balance body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fd79ae0dc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[APP DEBUG] Incoming request: GET /api/user/category-balances body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d85fd79ae2dc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[0mGET /api/user/category-balances [32m200[0m 5.242 ms - 136[0m
[0mGET /api/user/balance [32m200[0m 8.849 ms - 593[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"6.18","currency_code":"USD","transaction_id":1000007,"transaction_timestamp":"2025-08-11 14:21:00","round_id":850676,"round_finished":false,"game_id":4,"user_id":"48","token":"78d0de2e8724b03a0ec34c869e44ceae","context":{"reason":"not_provided","urid":"TEST1000007","history_id":"test-1000007"}},"request_timestamp":"2025-08-11 14:21:00","hash":"af694eaad402dedd261566cbec3120c36b53de30"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d860815f70db66-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860815f70db66-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '6.18',
      currency_code: 'USD',
      transaction_id: 1000007,
      transaction_timestamp: '2025-08-11 14:21:00',
      round_id: 850676,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:00',
    hash: 'af694eaad402dedd261566cbec3120c36b53de30'
  },
  timestamp: '2025-08-11T14:21:01.128Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "6.18",
    "currency_code": "USD",
    "transaction_id": 1000007,
    "transaction_timestamp": "2025-08-11 14:21:00",
    "round_id": 850676,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000007",
      "history_id": "test-1000007"
    }
  },
  "request_timestamp": "2025-08-11 14:21:00",
  "hash": "af694eaad402dedd261566cbec3120c36b53de30"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "6.18",
    "currency_code": "USD",
    "transaction_id": 1000007,
    "transaction_timestamp": "2025-08-11 14:21:00",
    "round_id": 850676,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000007",
      "history_id": "test-1000007"
    }
  },
  "request_timestamp": "2025-08-11 14:21:00",
  "hash": "af694eaad402dedd261566cbec3120c36b53de30"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860815f70db66-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '6.18',
      currency_code: 'USD',
      transaction_id: 1000007,
      transaction_timestamp: '2025-08-11 14:21:00',
      round_id: 850676,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:00',
    hash: 'af694eaad402dedd261566cbec3120c36b53de30'
  },
  timestamp: '2025-08-11T14:21:01.129Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '6.18',
    currency_code: 'USD',
    transaction_id: 1000007,
    transaction_timestamp: '2025-08-11 14:21:00',
    round_id: 850676,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: '78d0de2e8724b03a0ec34c869e44ceae',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000007',
      history_id: 'test-1000007'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "6.18",
    "currency_code": "USD",
    "transaction_id": 1000007,
    "transaction_timestamp": "2025-08-11 14:21:00",
    "round_id": 850676,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000007",
      "history_id": "test-1000007"
    }
  },
  "request_timestamp": "2025-08-11 14:21:00",
  "hash": "af694eaad402dedd261566cbec3120c36b53de30"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: WIN, amount: 6.18, parsed: 6.18, type: WIN
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($6.18)',
  transaction_type: 'WIN',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[DEBUG] CHANGEBALANCE: Starting game validation - game_id: 4, transactionType: WIN
[DEBUG] CHANGEBALANCE: Validating game 4
[IDEMPOTENCY] Checking for duplicate transactions for user 48
[IDEMPOTENCY] Found 0 recent bet transactions with same amount
[IDEMPOTENCY] Transaction 1000007 is new, proceeding with processing
[DEBUG] CHANGEBALANCE: Processing win of $6.18
[PROFIT_CONTROL] Processing win: $6.18, Provider RTP: 96.00%
[PROFIT_CONTROL] Validated metrics: {
  originalAmount: 6.18,
  adjustedAmount: 6.18,
  profitReduction: 0,
  effectiveRtp: '100.00',
  providerRtp: '96.00'
}
[PROFIT_CONTROL] Win adjustment: $6.18 → $6.18 (reduction: $0.00)
[DEBUG] No bet found with session_id undefined, looking for bet with same round_id 850676
[DEBUG] No bet found with round_id 850676, looking for most recent bet for game 4
[DEBUG] Updated bet 1247 with adjusted win amount 6.18
[WALLET_FIX] Processing win with category balance: $6.18
[WALLET_FIX] Category balance calculation: 28.12 + 6.18 = 34.3
[WALLET_FIX] Category balance updated: 28.12 + 6.18 = 34.3
CHANGEBALANCE win processed: {
  bet_id: 1247,
  transaction_id: 2736,
  balance_before: '$28.12',
  balance_after: '$34.30',
  win_amount: '$6.18'
}
[BALANCE_AUDIT] Win processed - Category: slots, Balance: 28.12 -> 34.3
[TRANSACTION] Successfully committed transaction
[TRANSACTION] Client released
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "6.18",
      "currency_code": "USD",
      "transaction_id": 1000007,
      "transaction_timestamp": "2025-08-11 14:21:00",
      "round_id": 850676,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000007",
        "history_id": "test-1000007"
      }
    },
    "request_timestamp": "2025-08-11 14:21:00",
    "hash": "af694eaad402dedd261566cbec3120c36b53de30"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:01",
    "hash": "bc27b3be36ca9c0e39df8bcd843cfd54132ae19e",
    "data": {
      "transaction_id": 1000007,
      "status": "OK",
      "balance": 34.3,
      "currency_code": "USD"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "6.18",
      "currency_code": "USD",
      "transaction_id": 1000007,
      "transaction_timestamp": "2025-08-11 14:21:00",
      "round_id": 850676,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000007",
        "history_id": "test-1000007"
      }
    },
    "request_timestamp": "2025-08-11 14:21:00",
    "hash": "af694eaad402dedd261566cbec3120c36b53de30"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:01",
    "hash": "bc27b3be36ca9c0e39df8bcd843cfd54132ae19e",
    "data": {
      "transaction_id": 1000007,
      "status": "OK",
      "balance": 34.3,
      "currency_code": "USD"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 228.869 ms - 699[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"3.30","currency_code":"USD","transaction_id":1000009,"transaction_timestamp":"2025-08-11 14:21:00","round_id":966790,"round_finished":false,"game_id":4,"user_id":"48","token":"78d0de2e8724b03a0ec34c869e44ceae","context":{"reason":"not_provided","urid":"TEST1000009","history_id":"test-1000009"}},"request_timestamp":"2025-08-11 14:21:00","hash":"af694eaad402dedd261566cbec3120c36b53de30"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d86081697fcb92-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d86081697fcb92-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '3.30',
      currency_code: 'USD',
      transaction_id: 1000009,
      transaction_timestamp: '2025-08-11 14:21:00',
      round_id: 966790,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:00',
    hash: 'af694eaad402dedd261566cbec3120c36b53de30'
  },
  timestamp: '2025-08-11T14:21:01.470Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "3.30",
    "currency_code": "USD",
    "transaction_id": 1000009,
    "transaction_timestamp": "2025-08-11 14:21:00",
    "round_id": 966790,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000009",
      "history_id": "test-1000009"
    }
  },
  "request_timestamp": "2025-08-11 14:21:00",
  "hash": "af694eaad402dedd261566cbec3120c36b53de30"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "3.30",
    "currency_code": "USD",
    "transaction_id": 1000009,
    "transaction_timestamp": "2025-08-11 14:21:00",
    "round_id": 966790,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000009",
      "history_id": "test-1000009"
    }
  },
  "request_timestamp": "2025-08-11 14:21:00",
  "hash": "af694eaad402dedd261566cbec3120c36b53de30"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d86081697fcb92-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '3.30',
      currency_code: 'USD',
      transaction_id: 1000009,
      transaction_timestamp: '2025-08-11 14:21:00',
      round_id: 966790,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:00',
    hash: 'af694eaad402dedd261566cbec3120c36b53de30'
  },
  timestamp: '2025-08-11T14:21:01.471Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '3.30',
    currency_code: 'USD',
    transaction_id: 1000009,
    transaction_timestamp: '2025-08-11 14:21:00',
    round_id: 966790,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: '78d0de2e8724b03a0ec34c869e44ceae',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000009',
      history_id: 'test-1000009'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "3.30",
    "currency_code": "USD",
    "transaction_id": 1000009,
    "transaction_timestamp": "2025-08-11 14:21:00",
    "round_id": 966790,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000009",
      "history_id": "test-1000009"
    }
  },
  "request_timestamp": "2025-08-11 14:21:00",
  "hash": "af694eaad402dedd261566cbec3120c36b53de30"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 3.30, parsed: -3.3, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($3.30)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[DEBUG] CHANGEBALANCE: Starting game validation - game_id: 4, transactionType: BET
[DEBUG] CHANGEBALANCE: Validating game 4
[IDEMPOTENCY] Checking for duplicate transactions for user 48
[IDEMPOTENCY] Found 0 recent bet transactions with same amount
[IDEMPOTENCY] Transaction 1000009 is new, proceeding with processing
[DEBUG] CHANGEBALANCE: Processing bet of $3.30
[PROFIT_CONTROL] Validated metrics: {
  originalAmount: 3.3,
  adjustedAmount: 3.3,
  profitReduction: 0,
  effectiveRtp: '100.00',
  providerRtp: '96.00'
}
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"1.58","currency_code":"USD","transaction_id":1000008,"transaction_timestamp":"2025-08-11 14:21:00","round_id":246564,"round_finished":false,"game_id":4,"user_id":"48","token":"78d0de2e8724b03a0ec34c869e44ceae","context":{"reason":"not_provided","urid":"TEST1000008","history_id":"test-1000008"}},"request_timestamp":"2025-08-11 14:21:00","hash":"af694eaad402dedd261566cbec3120c36b53de30"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d860817fc1102d-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860817fc1102d-LAX',
    'x-operator-id': 'thinkcode_stg',
    accept: 'application/json, text/plain, */*',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG',
    'cf-visitor': '{"scheme":"https"}',
    'x-forwarded-proto': 'https'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '1.58',
      currency_code: 'USD',
      transaction_id: 1000008,
      transaction_timestamp: '2025-08-11 14:21:00',
      round_id: 246564,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:00',
    hash: 'af694eaad402dedd261566cbec3120c36b53de30'
  },
  timestamp: '2025-08-11T14:21:01.499Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "1.58",
    "currency_code": "USD",
    "transaction_id": 1000008,
    "transaction_timestamp": "2025-08-11 14:21:00",
    "round_id": 246564,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000008",
      "history_id": "test-1000008"
    }
  },
  "request_timestamp": "2025-08-11 14:21:00",
  "hash": "af694eaad402dedd261566cbec3120c36b53de30"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "1.58",
    "currency_code": "USD",
    "transaction_id": 1000008,
    "transaction_timestamp": "2025-08-11 14:21:00",
    "round_id": 246564,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000008",
      "history_id": "test-1000008"
    }
  },
  "request_timestamp": "2025-08-11 14:21:00",
  "hash": "af694eaad402dedd261566cbec3120c36b53de30"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860817fc1102d-LAX',
    'x-operator-id': 'thinkcode_stg',
    accept: 'application/json, text/plain, */*',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG',
    'cf-visitor': '{"scheme":"https"}',
    'x-forwarded-proto': 'https'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '1.58',
      currency_code: 'USD',
      transaction_id: 1000008,
      transaction_timestamp: '2025-08-11 14:21:00',
      round_id: 246564,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:00',
    hash: 'af694eaad402dedd261566cbec3120c36b53de30'
  },
  timestamp: '2025-08-11T14:21:01.500Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '1.58',
    currency_code: 'USD',
    transaction_id: 1000008,
    transaction_timestamp: '2025-08-11 14:21:00',
    round_id: 246564,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: '78d0de2e8724b03a0ec34c869e44ceae',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000008',
      history_id: 'test-1000008'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "1.58",
    "currency_code": "USD",
    "transaction_id": 1000008,
    "transaction_timestamp": "2025-08-11 14:21:00",
    "round_id": 246564,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000008",
      "history_id": "test-1000008"
    }
  },
  "request_timestamp": "2025-08-11 14:21:00",
  "hash": "af694eaad402dedd261566cbec3120c36b53de30"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 1.58, parsed: -1.58, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($1.58)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"6.63","currency_code":"USD","transaction_id":1000002,"transaction_timestamp":"2025-08-11 14:21:00","round_id":692277,"round_finished":false,"game_id":4,"user_id":"48","token":"78d0de2e8724b03a0ec34c869e44ceae","context":{"reason":"not_provided","urid":"TEST1000002","history_id":"test-1000002"}},"request_timestamp":"2025-08-11 14:21:00","hash":"af694eaad402dedd261566cbec3120c36b53de30"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d860819d71cb93-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860819d71cb93-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '6.63',
      currency_code: 'USD',
      transaction_id: 1000002,
      transaction_timestamp: '2025-08-11 14:21:00',
      round_id: 692277,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:00',
    hash: 'af694eaad402dedd261566cbec3120c36b53de30'
  },
  timestamp: '2025-08-11T14:21:01.529Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "6.63",
    "currency_code": "USD",
    "transaction_id": 1000002,
    "transaction_timestamp": "2025-08-11 14:21:00",
    "round_id": 692277,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000002",
      "history_id": "test-1000002"
    }
  },
  "request_timestamp": "2025-08-11 14:21:00",
  "hash": "af694eaad402dedd261566cbec3120c36b53de30"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "6.63",
    "currency_code": "USD",
    "transaction_id": 1000002,
    "transaction_timestamp": "2025-08-11 14:21:00",
    "round_id": 692277,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000002",
      "history_id": "test-1000002"
    }
  },
  "request_timestamp": "2025-08-11 14:21:00",
  "hash": "af694eaad402dedd261566cbec3120c36b53de30"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860819d71cb93-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '6.63',
      currency_code: 'USD',
      transaction_id: 1000002,
      transaction_timestamp: '2025-08-11 14:21:00',
      round_id: 692277,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:00',
    hash: 'af694eaad402dedd261566cbec3120c36b53de30'
  },
  timestamp: '2025-08-11T14:21:01.529Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '6.63',
    currency_code: 'USD',
    transaction_id: 1000002,
    transaction_timestamp: '2025-08-11 14:21:00',
    round_id: 692277,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: '78d0de2e8724b03a0ec34c869e44ceae',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000002',
      history_id: 'test-1000002'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "6.63",
    "currency_code": "USD",
    "transaction_id": 1000002,
    "transaction_timestamp": "2025-08-11 14:21:00",
    "round_id": 692277,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000002",
      "history_id": "test-1000002"
    }
  },
  "request_timestamp": "2025-08-11 14:21:00",
  "hash": "af694eaad402dedd261566cbec3120c36b53de30"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 6.63, parsed: -6.63, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($6.63)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"8.23","currency_code":"USD","transaction_id":1000004,"transaction_timestamp":"2025-08-11 14:21:00","round_id":236262,"round_finished":false,"game_id":4,"user_id":"48","token":"78d0de2e8724b03a0ec34c869e44ceae","context":{"reason":"not_provided","urid":"TEST1000004","history_id":"test-1000004"}},"request_timestamp":"2025-08-11 14:21:00","hash":"af694eaad402dedd261566cbec3120c36b53de30"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d860818da07c04-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860818da07c04-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '8.23',
      currency_code: 'USD',
      transaction_id: 1000004,
      transaction_timestamp: '2025-08-11 14:21:00',
      round_id: 236262,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:00',
    hash: 'af694eaad402dedd261566cbec3120c36b53de30'
  },
  timestamp: '2025-08-11T14:21:01.531Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "8.23",
    "currency_code": "USD",
    "transaction_id": 1000004,
    "transaction_timestamp": "2025-08-11 14:21:00",
    "round_id": 236262,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000004",
      "history_id": "test-1000004"
    }
  },
  "request_timestamp": "2025-08-11 14:21:00",
  "hash": "af694eaad402dedd261566cbec3120c36b53de30"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "8.23",
    "currency_code": "USD",
    "transaction_id": 1000004,
    "transaction_timestamp": "2025-08-11 14:21:00",
    "round_id": 236262,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000004",
      "history_id": "test-1000004"
    }
  },
  "request_timestamp": "2025-08-11 14:21:00",
  "hash": "af694eaad402dedd261566cbec3120c36b53de30"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860818da07c04-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '8.23',
      currency_code: 'USD',
      transaction_id: 1000004,
      transaction_timestamp: '2025-08-11 14:21:00',
      round_id: 236262,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:00',
    hash: 'af694eaad402dedd261566cbec3120c36b53de30'
  },
  timestamp: '2025-08-11T14:21:01.531Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '8.23',
    currency_code: 'USD',
    transaction_id: 1000004,
    transaction_timestamp: '2025-08-11 14:21:00',
    round_id: 236262,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: '78d0de2e8724b03a0ec34c869e44ceae',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000004',
      history_id: 'test-1000004'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "8.23",
    "currency_code": "USD",
    "transaction_id": 1000004,
    "transaction_timestamp": "2025-08-11 14:21:00",
    "round_id": 236262,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000004",
      "history_id": "test-1000004"
    }
  },
  "request_timestamp": "2025-08-11 14:21:00",
  "hash": "af694eaad402dedd261566cbec3120c36b53de30"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 8.23, parsed: -8.23, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($8.23)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"4.32","currency_code":"USD","transaction_id":1000006,"transaction_timestamp":"2025-08-11 14:21:00","round_id":996302,"round_finished":false,"game_id":4,"user_id":"48","token":"78d0de2e8724b03a0ec34c869e44ceae","context":{"reason":"not_provided","urid":"TEST1000006","history_id":"test-1000006"}},"request_timestamp":"2025-08-11 14:21:00","hash":"af694eaad402dedd261566cbec3120c36b53de30"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d86081a9f22f57-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d86081a9f22f57-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '4.32',
      currency_code: 'USD',
      transaction_id: 1000006,
      transaction_timestamp: '2025-08-11 14:21:00',
      round_id: 996302,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:00',
    hash: 'af694eaad402dedd261566cbec3120c36b53de30'
  },
  timestamp: '2025-08-11T14:21:01.540Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "4.32",
    "currency_code": "USD",
    "transaction_id": 1000006,
    "transaction_timestamp": "2025-08-11 14:21:00",
    "round_id": 996302,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000006",
      "history_id": "test-1000006"
    }
  },
  "request_timestamp": "2025-08-11 14:21:00",
  "hash": "af694eaad402dedd261566cbec3120c36b53de30"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "4.32",
    "currency_code": "USD",
    "transaction_id": 1000006,
    "transaction_timestamp": "2025-08-11 14:21:00",
    "round_id": 996302,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000006",
      "history_id": "test-1000006"
    }
  },
  "request_timestamp": "2025-08-11 14:21:00",
  "hash": "af694eaad402dedd261566cbec3120c36b53de30"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d86081a9f22f57-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '4.32',
      currency_code: 'USD',
      transaction_id: 1000006,
      transaction_timestamp: '2025-08-11 14:21:00',
      round_id: 996302,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:00',
    hash: 'af694eaad402dedd261566cbec3120c36b53de30'
  },
  timestamp: '2025-08-11T14:21:01.541Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '4.32',
    currency_code: 'USD',
    transaction_id: 1000006,
    transaction_timestamp: '2025-08-11 14:21:00',
    round_id: 996302,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: '78d0de2e8724b03a0ec34c869e44ceae',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000006',
      history_id: 'test-1000006'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "4.32",
    "currency_code": "USD",
    "transaction_id": 1000006,
    "transaction_timestamp": "2025-08-11 14:21:00",
    "round_id": 996302,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000006",
      "history_id": "test-1000006"
    }
  },
  "request_timestamp": "2025-08-11 14:21:00",
  "hash": "af694eaad402dedd261566cbec3120c36b53de30"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: WIN, amount: 4.32, parsed: 4.32, type: WIN
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($4.32)',
  transaction_type: 'WIN',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[DEBUG] CHANGEBALANCE: Starting game validation - game_id: 4, transactionType: BET
[DEBUG] CHANGEBALANCE: Validating game 4
[IDEMPOTENCY] Checking for duplicate transactions for user 48
[IDEMPOTENCY] Found 0 recent bet transactions with same amount
[IDEMPOTENCY] Transaction 1000002 is new, proceeding with processing
[DEBUG] CHANGEBALANCE: Processing bet of $6.63
[TRANSACTION] Successfully committed transaction
[TRANSACTION] Client released
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "3.30",
      "currency_code": "USD",
      "transaction_id": 1000009,
      "transaction_timestamp": "2025-08-11 14:21:00",
      "round_id": 966790,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000009",
        "history_id": "test-1000009"
      }
    },
    "request_timestamp": "2025-08-11 14:21:00",
    "hash": "af694eaad402dedd261566cbec3120c36b53de30"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:01",
    "hash": "bc27b3be36ca9c0e39df8bcd843cfd54132ae19e",
    "data": {
      "transaction_id": 1000009,
      "status": "OK",
      "balance": 31,
      "currency_code": "USD"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "3.30",
      "currency_code": "USD",
      "transaction_id": 1000009,
      "transaction_timestamp": "2025-08-11 14:21:00",
      "round_id": 966790,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000009",
        "history_id": "test-1000009"
      }
    },
    "request_timestamp": "2025-08-11 14:21:00",
    "hash": "af694eaad402dedd261566cbec3120c36b53de30"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:01",
    "hash": "bc27b3be36ca9c0e39df8bcd843cfd54132ae19e",
    "data": {
      "transaction_id": 1000009,
      "status": "OK",
      "balance": 31,
      "currency_code": "USD"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 87.379 ms - 697[0m
[DEBUG] CHANGEBALANCE: Starting game validation - game_id: 4, transactionType: BET
[DEBUG] CHANGEBALANCE: Validating game 4
[IDEMPOTENCY] Checking for duplicate transactions for user 48
[PROFIT_CONTROL] Validated metrics: {
  originalAmount: 6.63,
  adjustedAmount: 6.63,
  profitReduction: 0,
  effectiveRtp: '100.00',
  providerRtp: '96.00'
}
[IDEMPOTENCY] Found 0 recent bet transactions with same amount
[IDEMPOTENCY] Transaction 1000008 is new, proceeding with processing
[DEBUG] CHANGEBALANCE: Processing bet of $1.58
[DEBUG] CHANGEBALANCE: Starting game validation - game_id: 4, transactionType: BET
[DEBUG] CHANGEBALANCE: Validating game 4
[IDEMPOTENCY] Checking for duplicate transactions for user 48
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"8.79","currency_code":"USD","transaction_id":1000005,"transaction_timestamp":"2025-08-11 14:21:00","round_id":334935,"round_finished":false,"game_id":4,"user_id":"48","token":"78d0de2e8724b03a0ec34c869e44ceae","context":{"reason":"not_provided","urid":"TEST1000005","history_id":"test-1000005"}},"request_timestamp":"2025-08-11 14:21:00","hash":"af694eaad402dedd261566cbec3120c36b53de30"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d860819da3f049-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860819da3f049-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '8.79',
      currency_code: 'USD',
      transaction_id: 1000005,
      transaction_timestamp: '2025-08-11 14:21:00',
      round_id: 334935,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:00',
    hash: 'af694eaad402dedd261566cbec3120c36b53de30'
  },
  timestamp: '2025-08-11T14:21:01.585Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "8.79",
    "currency_code": "USD",
    "transaction_id": 1000005,
    "transaction_timestamp": "2025-08-11 14:21:00",
    "round_id": 334935,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000005",
      "history_id": "test-1000005"
    }
  },
  "request_timestamp": "2025-08-11 14:21:00",
  "hash": "af694eaad402dedd261566cbec3120c36b53de30"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "8.79",
    "currency_code": "USD",
    "transaction_id": 1000005,
    "transaction_timestamp": "2025-08-11 14:21:00",
    "round_id": 334935,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000005",
      "history_id": "test-1000005"
    }
  },
  "request_timestamp": "2025-08-11 14:21:00",
  "hash": "af694eaad402dedd261566cbec3120c36b53de30"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860819da3f049-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '8.79',
      currency_code: 'USD',
      transaction_id: 1000005,
      transaction_timestamp: '2025-08-11 14:21:00',
      round_id: 334935,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:00',
    hash: 'af694eaad402dedd261566cbec3120c36b53de30'
  },
  timestamp: '2025-08-11T14:21:01.586Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '8.79',
    currency_code: 'USD',
    transaction_id: 1000005,
    transaction_timestamp: '2025-08-11 14:21:00',
    round_id: 334935,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: '78d0de2e8724b03a0ec34c869e44ceae',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000005',
      history_id: 'test-1000005'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "8.79",
    "currency_code": "USD",
    "transaction_id": 1000005,
    "transaction_timestamp": "2025-08-11 14:21:00",
    "round_id": 334935,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000005",
      "history_id": "test-1000005"
    }
  },
  "request_timestamp": "2025-08-11 14:21:00",
  "hash": "af694eaad402dedd261566cbec3120c36b53de30"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: WIN, amount: 8.79, parsed: 8.79, type: WIN
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($8.79)',
  transaction_type: 'WIN',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[DEBUG] CHANGEBALANCE: Starting game validation - game_id: 4, transactionType: WIN
[DEBUG] CHANGEBALANCE: Validating game 4
[IDEMPOTENCY] Found 0 recent bet transactions with same amount
[IDEMPOTENCY] Transaction 1000004 is new, proceeding with processing
[DEBUG] CHANGEBALANCE: Processing bet of $8.23
[IDEMPOTENCY] Checking for duplicate transactions for user 48
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"2.16","currency_code":"USD","transaction_id":1000000,"transaction_timestamp":"2025-08-11 14:21:00","round_id":628222,"round_finished":false,"game_id":4,"user_id":"48","token":"78d0de2e8724b03a0ec34c869e44ceae","context":{"reason":"not_provided","urid":"TEST1000000","history_id":"test-1000000"}},"request_timestamp":"2025-08-11 14:21:00","hash":"af694eaad402dedd261566cbec3120c36b53de30"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d860818cd497ca-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860818cd497ca-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '2.16',
      currency_code: 'USD',
      transaction_id: 1000000,
      transaction_timestamp: '2025-08-11 14:21:00',
      round_id: 628222,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:00',
    hash: 'af694eaad402dedd261566cbec3120c36b53de30'
  },
  timestamp: '2025-08-11T14:21:01.638Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "2.16",
    "currency_code": "USD",
    "transaction_id": 1000000,
    "transaction_timestamp": "2025-08-11 14:21:00",
    "round_id": 628222,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000000",
      "history_id": "test-1000000"
    }
  },
  "request_timestamp": "2025-08-11 14:21:00",
  "hash": "af694eaad402dedd261566cbec3120c36b53de30"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "2.16",
    "currency_code": "USD",
    "transaction_id": 1000000,
    "transaction_timestamp": "2025-08-11 14:21:00",
    "round_id": 628222,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000000",
      "history_id": "test-1000000"
    }
  },
  "request_timestamp": "2025-08-11 14:21:00",
  "hash": "af694eaad402dedd261566cbec3120c36b53de30"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860818cd497ca-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '2.16',
      currency_code: 'USD',
      transaction_id: 1000000,
      transaction_timestamp: '2025-08-11 14:21:00',
      round_id: 628222,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:00',
    hash: 'af694eaad402dedd261566cbec3120c36b53de30'
  },
  timestamp: '2025-08-11T14:21:01.640Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '2.16',
    currency_code: 'USD',
    transaction_id: 1000000,
    transaction_timestamp: '2025-08-11 14:21:00',
    round_id: 628222,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: '78d0de2e8724b03a0ec34c869e44ceae',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000000',
      history_id: 'test-1000000'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "2.16",
    "currency_code": "USD",
    "transaction_id": 1000000,
    "transaction_timestamp": "2025-08-11 14:21:00",
    "round_id": 628222,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000000",
      "history_id": "test-1000000"
    }
  },
  "request_timestamp": "2025-08-11 14:21:00",
  "hash": "af694eaad402dedd261566cbec3120c36b53de30"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: WIN, amount: 2.16, parsed: 2.16, type: WIN
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($2.16)',
  transaction_type: 'WIN',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[IDEMPOTENCY] Found 0 recent bet transactions with same amount
[IDEMPOTENCY] Transaction 1000006 is new, proceeding with processing
[DEBUG] CHANGEBALANCE: Processing win of $4.32
[DEBUG] CHANGEBALANCE: Starting game validation - game_id: 4, transactionType: WIN
[DEBUG] CHANGEBALANCE: Validating game 4
[TRANSACTION] Successfully committed transaction
[TRANSACTION] Client released
[IDEMPOTENCY] Checking for duplicate transactions for user 48
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "6.63",
      "currency_code": "USD",
      "transaction_id": 1000002,
      "transaction_timestamp": "2025-08-11 14:21:00",
      "round_id": 692277,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000002",
        "history_id": "test-1000002"
      }
    },
    "request_timestamp": "2025-08-11 14:21:00",
    "hash": "af694eaad402dedd261566cbec3120c36b53de30"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:01",
    "hash": "bc27b3be36ca9c0e39df8bcd843cfd54132ae19e",
    "data": {
      "transaction_id": 1000002,
      "status": "OK",
      "balance": 24.37,
      "currency_code": "USD"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "6.63",
      "currency_code": "USD",
      "transaction_id": 1000002,
      "transaction_timestamp": "2025-08-11 14:21:00",
      "round_id": 692277,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000002",
        "history_id": "test-1000002"
      }
    },
    "request_timestamp": "2025-08-11 14:21:00",
    "hash": "af694eaad402dedd261566cbec3120c36b53de30"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:01",
    "hash": "bc27b3be36ca9c0e39df8bcd843cfd54132ae19e",
    "data": {
      "transaction_id": 1000002,
      "status": "OK",
      "balance": 24.37,
      "currency_code": "USD"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 125.656 ms - 700[0m
[IDEMPOTENCY] Found 0 recent bet transactions with same amount
[IDEMPOTENCY] Transaction 1000000 is new, proceeding with processing
[DEBUG] CHANGEBALANCE: Processing win of $2.16
[DEBUG] CHANGEBALANCE: Starting game validation - game_id: 4, transactionType: WIN
[DEBUG] CHANGEBALANCE: Validating game 4
[IDEMPOTENCY] Checking for duplicate transactions for user 48
[IDEMPOTENCY] Found 0 recent bet transactions with same amount
[IDEMPOTENCY] Transaction 1000005 is new, proceeding with processing
[DEBUG] CHANGEBALANCE: Processing win of $8.79
[PROFIT_CONTROL] Processing win: $2.16, Provider RTP: 96.00%
[PROFIT_CONTROL] Validated metrics: {
  originalAmount: 2.16,
  adjustedAmount: 2.16,
  profitReduction: 0,
  effectiveRtp: '100.00',
  providerRtp: '96.00'
}
[PROFIT_CONTROL] Win adjustment: $2.16 → $2.16 (reduction: $0.00)
[DEBUG] No bet found with session_id undefined, looking for bet with same round_id 628222
[DEBUG] No bet found with round_id 628222, looking for most recent bet for game 4
[DEBUG] Updated bet 1249 with adjusted win amount 2.16
[WALLET_FIX] Processing win with category balance: $2.16
[WALLET_FIX] Category balance calculation: 24.37 + 2.16 = 26.53
[WALLET_FIX] Category balance updated: 24.37 + 2.16 = 26.53
CHANGEBALANCE win processed: {
  bet_id: 1249,
  transaction_id: 2739,
  balance_before: '$24.37',
  balance_after: '$26.53',
  win_amount: '$2.16'
}
[BALANCE_AUDIT] Win processed - Category: slots, Balance: 24.37 -> 26.53
[TRANSACTION] Successfully committed transaction
[TRANSACTION] Client released
[PROFIT_CONTROL] Processing win: $8.79, Provider RTP: 96.00%
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "2.16",
      "currency_code": "USD",
      "transaction_id": 1000000,
      "transaction_timestamp": "2025-08-11 14:21:00",
      "round_id": 628222,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000000",
        "history_id": "test-1000000"
      }
    },
    "request_timestamp": "2025-08-11 14:21:00",
    "hash": "af694eaad402dedd261566cbec3120c36b53de30"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:01",
    "hash": "bc27b3be36ca9c0e39df8bcd843cfd54132ae19e",
    "data": {
      "transaction_id": 1000000,
      "status": "OK",
      "balance": 26.53,
      "currency_code": "USD"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "2.16",
      "currency_code": "USD",
      "transaction_id": 1000000,
      "transaction_timestamp": "2025-08-11 14:21:00",
      "round_id": 628222,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000000",
        "history_id": "test-1000000"
      }
    },
    "request_timestamp": "2025-08-11 14:21:00",
    "hash": "af694eaad402dedd261566cbec3120c36b53de30"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:01",
    "hash": "bc27b3be36ca9c0e39df8bcd843cfd54132ae19e",
    "data": {
      "transaction_id": 1000000,
      "status": "OK",
      "balance": 26.53,
      "currency_code": "USD"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 241.240 ms - 700[0m
[PROFIT_CONTROL] Validated metrics: {
  originalAmount: 8.79,
  adjustedAmount: 8.79,
  profitReduction: 0,
  effectiveRtp: '100.00',
  providerRtp: '96.00'
}
[PROFIT_CONTROL] Win adjustment: $8.79 → $8.79 (reduction: $0.00)
[DEBUG] No bet found with session_id undefined, looking for bet with same round_id 334935
[DEBUG] No bet found with round_id 334935, looking for most recent bet for game 4
[DEBUG] Updated bet 1249 with adjusted win amount 8.79
[WALLET_FIX] Processing win with category balance: $8.79
[WALLET_FIX] Category balance calculation: 26.53 + 8.79 = 35.32
[WALLET_FIX] Category balance updated: 26.53 + 8.79 = 35.32
CHANGEBALANCE win processed: {
  bet_id: 1249,
  transaction_id: 2740,
  balance_before: '$26.53',
  balance_after: '$35.32',
  win_amount: '$8.79'
}
[BALANCE_AUDIT] Win processed - Category: slots, Balance: 26.53 -> 35.32
[TRANSACTION] Successfully committed transaction
[TRANSACTION] Client released
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "8.79",
      "currency_code": "USD",
      "transaction_id": 1000005,
      "transaction_timestamp": "2025-08-11 14:21:00",
      "round_id": 334935,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000005",
        "history_id": "test-1000005"
      }
    },
    "request_timestamp": "2025-08-11 14:21:00",
    "hash": "af694eaad402dedd261566cbec3120c36b53de30"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:02",
    "hash": "929f905f4937d3ad1588b0b94d31b5d01c338ff6",
    "data": {
      "transaction_id": 1000005,
      "status": "OK",
      "balance": 33.16,
      "currency_code": "USD"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "8.79",
      "currency_code": "USD",
      "transaction_id": 1000005,
      "transaction_timestamp": "2025-08-11 14:21:00",
      "round_id": 334935,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000005",
        "history_id": "test-1000005"
      }
    },
    "request_timestamp": "2025-08-11 14:21:00",
    "hash": "af694eaad402dedd261566cbec3120c36b53de30"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:02",
    "hash": "929f905f4937d3ad1588b0b94d31b5d01c338ff6",
    "data": {
      "transaction_id": 1000005,
      "status": "OK",
      "balance": 33.16,
      "currency_code": "USD"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 432.011 ms - 700[0m
[PROFIT_CONTROL] Validated metrics: {
  originalAmount: 8.23,
  adjustedAmount: 8.23,
  profitReduction: 0,
  effectiveRtp: '100.00',
  providerRtp: '96.00'
}
[PROFIT_CONTROL] Processing win: $4.32, Provider RTP: 96.00%
[TRANSACTION] Successfully committed transaction
[TRANSACTION] Client released
[PROFIT_CONTROL] Validated metrics: {
  originalAmount: 4.32,
  adjustedAmount: 4.32,
  profitReduction: 0,
  effectiveRtp: '100.00',
  providerRtp: '96.00'
}
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "8.23",
      "currency_code": "USD",
      "transaction_id": 1000004,
      "transaction_timestamp": "2025-08-11 14:21:00",
      "round_id": 236262,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000004",
        "history_id": "test-1000004"
      }
    },
    "request_timestamp": "2025-08-11 14:21:00",
    "hash": "af694eaad402dedd261566cbec3120c36b53de30"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:02",
    "hash": "929f905f4937d3ad1588b0b94d31b5d01c338ff6",
    "data": {
      "transaction_id": 1000004,
      "status": "OK",
      "balance": 24.93,
      "currency_code": "USD"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "8.23",
      "currency_code": "USD",
      "transaction_id": 1000004,
      "transaction_timestamp": "2025-08-11 14:21:00",
      "round_id": 236262,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000004",
        "history_id": "test-1000004"
      }
    },
    "request_timestamp": "2025-08-11 14:21:00",
    "hash": "af694eaad402dedd261566cbec3120c36b53de30"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:02",
    "hash": "929f905f4937d3ad1588b0b94d31b5d01c338ff6",
    "data": {
      "transaction_id": 1000004,
      "status": "OK",
      "balance": 24.93,
      "currency_code": "USD"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 565.318 ms - 700[0m
[PROFIT_CONTROL] Win adjustment: $4.32 → $4.32 (reduction: $0.00)
[DEBUG] No bet found with session_id undefined, looking for bet with same round_id 996302
[DEBUG] No bet found with round_id 996302, looking for most recent bet for game 4
[DEBUG] Updated bet 1250 with adjusted win amount 4.32
[WALLET_FIX] Processing win with category balance: $4.32
[WALLET_FIX] Category balance calculation: 24.93 + 4.32 = 29.25
[WALLET_FIX] Category balance updated: 24.93 + 4.32 = 29.25
CHANGEBALANCE win processed: {
  bet_id: 1250,
  transaction_id: 2742,
  balance_before: '$24.93',
  balance_after: '$29.25',
  win_amount: '$4.32'
}
[BALANCE_AUDIT] Win processed - Category: slots, Balance: 24.93 -> 29.25
[TRANSACTION] Successfully committed transaction
[TRANSACTION] Client released
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "4.32",
      "currency_code": "USD",
      "transaction_id": 1000006,
      "transaction_timestamp": "2025-08-11 14:21:00",
      "round_id": 996302,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000006",
        "history_id": "test-1000006"
      }
    },
    "request_timestamp": "2025-08-11 14:21:00",
    "hash": "af694eaad402dedd261566cbec3120c36b53de30"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:02",
    "hash": "929f905f4937d3ad1588b0b94d31b5d01c338ff6",
    "data": {
      "transaction_id": 1000006,
      "status": "OK",
      "balance": 35.32,
      "currency_code": "USD"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "4.32",
      "currency_code": "USD",
      "transaction_id": 1000006,
      "transaction_timestamp": "2025-08-11 14:21:00",
      "round_id": 996302,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000006",
        "history_id": "test-1000006"
      }
    },
    "request_timestamp": "2025-08-11 14:21:00",
    "hash": "af694eaad402dedd261566cbec3120c36b53de30"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:02",
    "hash": "929f905f4937d3ad1588b0b94d31b5d01c338ff6",
    "data": {
      "transaction_id": 1000006,
      "status": "OK",
      "balance": 35.32,
      "currency_code": "USD"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 800.196 ms - 700[0m
[PROFIT_CONTROL] Validated metrics: {
  originalAmount: 1.58,
  adjustedAmount: 1.58,
  profitReduction: 0,
  effectiveRtp: '100.00',
  providerRtp: '96.00'
}
[TRANSACTION] Successfully committed transaction
[TRANSACTION] Client released
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "1.58",
      "currency_code": "USD",
      "transaction_id": 1000008,
      "transaction_timestamp": "2025-08-11 14:21:00",
      "round_id": 246564,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000008",
        "history_id": "test-1000008"
      }
    },
    "request_timestamp": "2025-08-11 14:21:00",
    "hash": "af694eaad402dedd261566cbec3120c36b53de30"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:02",
    "hash": "929f905f4937d3ad1588b0b94d31b5d01c338ff6",
    "data": {
      "transaction_id": 1000008,
      "status": "OK",
      "balance": 33.74,
      "currency_code": "USD"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "1.58",
      "currency_code": "USD",
      "transaction_id": 1000008,
      "transaction_timestamp": "2025-08-11 14:21:00",
      "round_id": 246564,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000008",
        "history_id": "test-1000008"
      }
    },
    "request_timestamp": "2025-08-11 14:21:00",
    "hash": "af694eaad402dedd261566cbec3120c36b53de30"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:02",
    "hash": "929f905f4937d3ad1588b0b94d31b5d01c338ff6",
    "data": {
      "transaction_id": 1000008,
      "status": "OK",
      "balance": 33.74,
      "currency_code": "USD"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 988.128 ms - 700[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"1.30","currency_code":"USD","transaction_id":1000003,"transaction_timestamp":"2025-08-11 14:21:00","round_id":435297,"round_finished":false,"game_id":4,"user_id":"48","token":"78d0de2e8724b03a0ec34c869e44ceae","context":{"reason":"not_provided","urid":"TEST1000003","history_id":"test-1000003"}},"request_timestamp":"2025-08-11 14:21:00","hash":"af694eaad402dedd261566cbec3120c36b53de30"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d860817e9c14f4-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860817e9c14f4-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '1.30',
      currency_code: 'USD',
      transaction_id: 1000003,
      transaction_timestamp: '2025-08-11 14:21:00',
      round_id: 435297,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:00',
    hash: 'af694eaad402dedd261566cbec3120c36b53de30'
  },
  timestamp: '2025-08-11T14:21:02.803Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "1.30",
    "currency_code": "USD",
    "transaction_id": 1000003,
    "transaction_timestamp": "2025-08-11 14:21:00",
    "round_id": 435297,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000003",
      "history_id": "test-1000003"
    }
  },
  "request_timestamp": "2025-08-11 14:21:00",
  "hash": "af694eaad402dedd261566cbec3120c36b53de30"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "1.30",
    "currency_code": "USD",
    "transaction_id": 1000003,
    "transaction_timestamp": "2025-08-11 14:21:00",
    "round_id": 435297,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000003",
      "history_id": "test-1000003"
    }
  },
  "request_timestamp": "2025-08-11 14:21:00",
  "hash": "af694eaad402dedd261566cbec3120c36b53de30"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860817e9c14f4-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '1.30',
      currency_code: 'USD',
      transaction_id: 1000003,
      transaction_timestamp: '2025-08-11 14:21:00',
      round_id: 435297,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:00',
    hash: 'af694eaad402dedd261566cbec3120c36b53de30'
  },
  timestamp: '2025-08-11T14:21:02.804Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '1.30',
    currency_code: 'USD',
    transaction_id: 1000003,
    transaction_timestamp: '2025-08-11 14:21:00',
    round_id: 435297,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: '78d0de2e8724b03a0ec34c869e44ceae',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000003',
      history_id: 'test-1000003'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "1.30",
    "currency_code": "USD",
    "transaction_id": 1000003,
    "transaction_timestamp": "2025-08-11 14:21:00",
    "round_id": 435297,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000003",
      "history_id": "test-1000003"
    }
  },
  "request_timestamp": "2025-08-11 14:21:00",
  "hash": "af694eaad402dedd261566cbec3120c36b53de30"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: WIN, amount: 1.30, parsed: 1.3, type: WIN
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($1.30)',
  transaction_type: 'WIN',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[DEBUG] CHANGEBALANCE: Starting game validation - game_id: 4, transactionType: WIN
[DEBUG] CHANGEBALANCE: Validating game 4
[IDEMPOTENCY] Checking for duplicate transactions for user 48
[IDEMPOTENCY] Found 0 recent bet transactions with same amount
[IDEMPOTENCY] Transaction 1000003 is new, proceeding with processing
[DEBUG] CHANGEBALANCE: Processing win of $1.30
[PROFIT_CONTROL] Processing win: $1.30, Provider RTP: 96.00%
[PROFIT_CONTROL] Validated metrics: {
  originalAmount: 1.3,
  adjustedAmount: 1.3,
  profitReduction: 0,
  effectiveRtp: '100.00',
  providerRtp: '96.00'
}
[PROFIT_CONTROL] Win adjustment: $1.30 → $1.30 (reduction: $0.00)
[DEBUG] No bet found with session_id undefined, looking for bet with same round_id 435297
[DEBUG] No bet found with round_id 435297, looking for most recent bet for game 4
[DEBUG] Updated bet 1250 with adjusted win amount 1.3
[WALLET_FIX] Processing win with category balance: $1.30
[WALLET_FIX] Category balance calculation: 33.74 + 1.3 = 35.04
[WALLET_FIX] Category balance updated: 33.74 + 1.3 = 35.04
CHANGEBALANCE win processed: {
  bet_id: 1250,
  transaction_id: 2744,
  balance_before: '$33.74',
  balance_after: '$35.04',
  win_amount: '$1.30'
}
[BALANCE_AUDIT] Win processed - Category: slots, Balance: 33.74 -> 35.04
[TRANSACTION] Successfully committed transaction
[TRANSACTION] Client released
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "1.30",
      "currency_code": "USD",
      "transaction_id": 1000003,
      "transaction_timestamp": "2025-08-11 14:21:00",
      "round_id": 435297,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000003",
        "history_id": "test-1000003"
      }
    },
    "request_timestamp": "2025-08-11 14:21:00",
    "hash": "af694eaad402dedd261566cbec3120c36b53de30"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:02",
    "hash": "929f905f4937d3ad1588b0b94d31b5d01c338ff6",
    "data": {
      "transaction_id": 1000003,
      "status": "OK",
      "balance": 35.04,
      "currency_code": "USD"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "1.30",
      "currency_code": "USD",
      "transaction_id": 1000003,
      "transaction_timestamp": "2025-08-11 14:21:00",
      "round_id": 435297,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000003",
        "history_id": "test-1000003"
      }
    },
    "request_timestamp": "2025-08-11 14:21:00",
    "hash": "af694eaad402dedd261566cbec3120c36b53de30"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:02",
    "hash": "929f905f4937d3ad1588b0b94d31b5d01c338ff6",
    "data": {
      "transaction_id": 1000003,
      "status": "OK",
      "balance": 35.04,
      "currency_code": "USD"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 136.552 ms - 700[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"8.08","currency_code":"USD","transaction_id":1000001,"transaction_timestamp":"2025-08-11 14:21:00","round_id":298463,"round_finished":false,"game_id":4,"user_id":"48","token":"78d0de2e8724b03a0ec34c869e44ceae","context":{"reason":"not_provided","urid":"TEST1000001","history_id":"test-1000001"}},"request_timestamp":"2025-08-11 14:21:00","hash":"af694eaad402dedd261566cbec3120c36b53de30"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d860816c632b5f-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860816c632b5f-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '8.08',
      currency_code: 'USD',
      transaction_id: 1000001,
      transaction_timestamp: '2025-08-11 14:21:00',
      round_id: 298463,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:00',
    hash: 'af694eaad402dedd261566cbec3120c36b53de30'
  },
  timestamp: '2025-08-11T14:21:03.147Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "8.08",
    "currency_code": "USD",
    "transaction_id": 1000001,
    "transaction_timestamp": "2025-08-11 14:21:00",
    "round_id": 298463,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000001",
      "history_id": "test-1000001"
    }
  },
  "request_timestamp": "2025-08-11 14:21:00",
  "hash": "af694eaad402dedd261566cbec3120c36b53de30"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "8.08",
    "currency_code": "USD",
    "transaction_id": 1000001,
    "transaction_timestamp": "2025-08-11 14:21:00",
    "round_id": 298463,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000001",
      "history_id": "test-1000001"
    }
  },
  "request_timestamp": "2025-08-11 14:21:00",
  "hash": "af694eaad402dedd261566cbec3120c36b53de30"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860816c632b5f-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '8.08',
      currency_code: 'USD',
      transaction_id: 1000001,
      transaction_timestamp: '2025-08-11 14:21:00',
      round_id: 298463,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:00',
    hash: 'af694eaad402dedd261566cbec3120c36b53de30'
  },
  timestamp: '2025-08-11T14:21:03.159Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '8.08',
    currency_code: 'USD',
    transaction_id: 1000001,
    transaction_timestamp: '2025-08-11 14:21:00',
    round_id: 298463,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: '78d0de2e8724b03a0ec34c869e44ceae',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000001',
      history_id: 'test-1000001'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "8.08",
    "currency_code": "USD",
    "transaction_id": 1000001,
    "transaction_timestamp": "2025-08-11 14:21:00",
    "round_id": 298463,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000001",
      "history_id": "test-1000001"
    }
  },
  "request_timestamp": "2025-08-11 14:21:00",
  "hash": "af694eaad402dedd261566cbec3120c36b53de30"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 8.08, parsed: -8.08, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($8.08)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[DEBUG] CHANGEBALANCE: Starting game validation - game_id: 4, transactionType: BET
[DEBUG] CHANGEBALANCE: Validating game 4
[IDEMPOTENCY] Checking for duplicate transactions for user 48
[IDEMPOTENCY] Found 0 recent bet transactions with same amount
[IDEMPOTENCY] Transaction 1000001 is new, proceeding with processing
[DEBUG] CHANGEBALANCE: Processing bet of $8.08
[PROFIT_CONTROL] Validated metrics: {
  originalAmount: 8.08,
  adjustedAmount: 8.08,
  profitReduction: 0,
  effectiveRtp: '100.00',
  providerRtp: '96.00'
}
[TRANSACTION] Successfully committed transaction
[TRANSACTION] Client released
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "8.08",
      "currency_code": "USD",
      "transaction_id": 1000001,
      "transaction_timestamp": "2025-08-11 14:21:00",
      "round_id": 298463,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000001",
        "history_id": "test-1000001"
      }
    },
    "request_timestamp": "2025-08-11 14:21:00",
    "hash": "af694eaad402dedd261566cbec3120c36b53de30"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:03",
    "hash": "2bfea609eda002fc9ae729fce41a0a4c4fc781ac",
    "data": {
      "transaction_id": 1000001,
      "status": "OK",
      "balance": 26.96,
      "currency_code": "USD"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "8.08",
      "currency_code": "USD",
      "transaction_id": 1000001,
      "transaction_timestamp": "2025-08-11 14:21:00",
      "round_id": 298463,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000001",
        "history_id": "test-1000001"
      }
    },
    "request_timestamp": "2025-08-11 14:21:00",
    "hash": "af694eaad402dedd261566cbec3120c36b53de30"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:03",
    "hash": "2bfea609eda002fc9ae729fce41a0a4c4fc781ac",
    "data": {
      "transaction_id": 1000001,
      "status": "OK",
      "balance": 26.96,
      "currency_code": "USD"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 103.204 ms - 700[0m
[APP DEBUG] Incoming request: GET /api/user/balance body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d860945ca9dc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[APP DEBUG] Incoming request: GET /api/user/category-balances body: undefined
[CLOUDFLARE] Request from Cloudflare - Ray: 96d860944ca4dc3d-KUL, IP: 2001:e68:542f:1230:851b:9a6f:6a57:55ea
[0mGET /api/user/category-balances [32m200[0m 5.104 ms - 136[0m
[0mGET /api/user/balance [32m200[0m 15.076 ms - 593[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"1.29","currency_code":"USD","transaction_id":1000018,"transaction_timestamp":"2025-08-11 14:21:05","round_id":106547,"round_finished":false,"game_id":4,"user_id":"48","token":"78d0de2e8724b03a0ec34c869e44ceae","context":{"reason":"not_provided","urid":"TEST1000018","history_id":"test-1000018"}},"request_timestamp":"2025-08-11 14:21:05","hash":"630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d8609ad911cb92-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d8609ad911cb92-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '1.29',
      currency_code: 'USD',
      transaction_id: 1000018,
      transaction_timestamp: '2025-08-11 14:21:05',
      round_id: 106547,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:05',
    hash: '630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1'
  },
  timestamp: '2025-08-11T14:21:05.189Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "1.29",
    "currency_code": "USD",
    "transaction_id": 1000018,
    "transaction_timestamp": "2025-08-11 14:21:05",
    "round_id": 106547,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000018",
      "history_id": "test-1000018"
    }
  },
  "request_timestamp": "2025-08-11 14:21:05",
  "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "1.29",
    "currency_code": "USD",
    "transaction_id": 1000018,
    "transaction_timestamp": "2025-08-11 14:21:05",
    "round_id": 106547,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000018",
      "history_id": "test-1000018"
    }
  },
  "request_timestamp": "2025-08-11 14:21:05",
  "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d8609ad911cb92-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '1.29',
      currency_code: 'USD',
      transaction_id: 1000018,
      transaction_timestamp: '2025-08-11 14:21:05',
      round_id: 106547,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:05',
    hash: '630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1'
  },
  timestamp: '2025-08-11T14:21:05.190Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '1.29',
    currency_code: 'USD',
    transaction_id: 1000018,
    transaction_timestamp: '2025-08-11 14:21:05',
    round_id: 106547,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: '78d0de2e8724b03a0ec34c869e44ceae',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000018',
      history_id: 'test-1000018'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "1.29",
    "currency_code": "USD",
    "transaction_id": 1000018,
    "transaction_timestamp": "2025-08-11 14:21:05",
    "round_id": 106547,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000018",
      "history_id": "test-1000018"
    }
  },
  "request_timestamp": "2025-08-11 14:21:05",
  "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 1.29, parsed: -1.29, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($1.29)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"1.37","currency_code":"USD","transaction_id":1000019,"transaction_timestamp":"2025-08-11 14:21:05","round_id":57866,"round_finished":false,"game_id":4,"user_id":"48","token":"78d0de2e8724b03a0ec34c869e44ceae","context":{"reason":"not_provided","urid":"TEST1000019","history_id":"test-1000019"}},"request_timestamp":"2025-08-11 14:21:05","hash":"630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d8609adfdcdb66-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '481',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d8609adfdcdb66-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '1.37',
      currency_code: 'USD',
      transaction_id: 1000019,
      transaction_timestamp: '2025-08-11 14:21:05',
      round_id: 57866,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:05',
    hash: '630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1'
  },
  timestamp: '2025-08-11T14:21:05.198Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "1.37",
    "currency_code": "USD",
    "transaction_id": 1000019,
    "transaction_timestamp": "2025-08-11 14:21:05",
    "round_id": 57866,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000019",
      "history_id": "test-1000019"
    }
  },
  "request_timestamp": "2025-08-11 14:21:05",
  "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "1.37",
    "currency_code": "USD",
    "transaction_id": 1000019,
    "transaction_timestamp": "2025-08-11 14:21:05",
    "round_id": 57866,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000019",
      "history_id": "test-1000019"
    }
  },
  "request_timestamp": "2025-08-11 14:21:05",
  "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '481',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d8609adfdcdb66-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '1.37',
      currency_code: 'USD',
      transaction_id: 1000019,
      transaction_timestamp: '2025-08-11 14:21:05',
      round_id: 57866,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:05',
    hash: '630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1'
  },
  timestamp: '2025-08-11T14:21:05.198Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '1.37',
    currency_code: 'USD',
    transaction_id: 1000019,
    transaction_timestamp: '2025-08-11 14:21:05',
    round_id: 57866,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: '78d0de2e8724b03a0ec34c869e44ceae',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000019',
      history_id: 'test-1000019'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "1.37",
    "currency_code": "USD",
    "transaction_id": 1000019,
    "transaction_timestamp": "2025-08-11 14:21:05",
    "round_id": 57866,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000019",
      "history_id": "test-1000019"
    }
  },
  "request_timestamp": "2025-08-11 14:21:05",
  "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: WIN, amount: 1.37, parsed: 1.37, type: WIN
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($1.37)',
  transaction_type: 'WIN',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"3.46","currency_code":"USD","transaction_id":1000014,"transaction_timestamp":"2025-08-11 14:21:05","round_id":234929,"round_finished":false,"game_id":4,"user_id":"48","token":"78d0de2e8724b03a0ec34c869e44ceae","context":{"reason":"not_provided","urid":"TEST1000014","history_id":"test-1000014"}},"request_timestamp":"2025-08-11 14:21:05","hash":"630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d8609ade397c04-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d8609ade397c04-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '3.46',
      currency_code: 'USD',
      transaction_id: 1000014,
      transaction_timestamp: '2025-08-11 14:21:05',
      round_id: 234929,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:05',
    hash: '630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1'
  },
  timestamp: '2025-08-11T14:21:05.213Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "3.46",
    "currency_code": "USD",
    "transaction_id": 1000014,
    "transaction_timestamp": "2025-08-11 14:21:05",
    "round_id": 234929,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000014",
      "history_id": "test-1000014"
    }
  },
  "request_timestamp": "2025-08-11 14:21:05",
  "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "3.46",
    "currency_code": "USD",
    "transaction_id": 1000014,
    "transaction_timestamp": "2025-08-11 14:21:05",
    "round_id": 234929,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000014",
      "history_id": "test-1000014"
    }
  },
  "request_timestamp": "2025-08-11 14:21:05",
  "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d8609ade397c04-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '3.46',
      currency_code: 'USD',
      transaction_id: 1000014,
      transaction_timestamp: '2025-08-11 14:21:05',
      round_id: 234929,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:05',
    hash: '630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1'
  },
  timestamp: '2025-08-11T14:21:05.213Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '3.46',
    currency_code: 'USD',
    transaction_id: 1000014,
    transaction_timestamp: '2025-08-11 14:21:05',
    round_id: 234929,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: '78d0de2e8724b03a0ec34c869e44ceae',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000014',
      history_id: 'test-1000014'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "3.46",
    "currency_code": "USD",
    "transaction_id": 1000014,
    "transaction_timestamp": "2025-08-11 14:21:05",
    "round_id": 234929,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000014",
      "history_id": "test-1000014"
    }
  },
  "request_timestamp": "2025-08-11 14:21:05",
  "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 3.46, parsed: -3.46, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($3.46)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[DEBUG] CHANGEBALANCE: Starting game validation - game_id: 4, transactionType: BET
[DEBUG] CHANGEBALANCE: Validating game 4
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"5.69","currency_code":"USD","transaction_id":1000010,"transaction_timestamp":"2025-08-11 14:21:05","round_id":800674,"round_finished":false,"game_id":4,"user_id":"48","token":"78d0de2e8724b03a0ec34c869e44ceae","context":{"reason":"not_provided","urid":"TEST1000010","history_id":"test-1000010"}},"request_timestamp":"2025-08-11 14:21:05","hash":"630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d8609addbf2b5f-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d8609addbf2b5f-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '5.69',
      currency_code: 'USD',
      transaction_id: 1000010,
      transaction_timestamp: '2025-08-11 14:21:05',
      round_id: 800674,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:05',
    hash: '630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1'
  },
  timestamp: '2025-08-11T14:21:05.244Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "5.69",
    "currency_code": "USD",
    "transaction_id": 1000010,
    "transaction_timestamp": "2025-08-11 14:21:05",
    "round_id": 800674,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000010",
      "history_id": "test-1000010"
    }
  },
  "request_timestamp": "2025-08-11 14:21:05",
  "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "5.69",
    "currency_code": "USD",
    "transaction_id": 1000010,
    "transaction_timestamp": "2025-08-11 14:21:05",
    "round_id": 800674,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000010",
      "history_id": "test-1000010"
    }
  },
  "request_timestamp": "2025-08-11 14:21:05",
  "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d8609addbf2b5f-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '5.69',
      currency_code: 'USD',
      transaction_id: 1000010,
      transaction_timestamp: '2025-08-11 14:21:05',
      round_id: 800674,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:05',
    hash: '630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1'
  },
  timestamp: '2025-08-11T14:21:05.244Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '5.69',
    currency_code: 'USD',
    transaction_id: 1000010,
    transaction_timestamp: '2025-08-11 14:21:05',
    round_id: 800674,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: '78d0de2e8724b03a0ec34c869e44ceae',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000010',
      history_id: 'test-1000010'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "5.69",
    "currency_code": "USD",
    "transaction_id": 1000010,
    "transaction_timestamp": "2025-08-11 14:21:05",
    "round_id": 800674,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000010",
      "history_id": "test-1000010"
    }
  },
  "request_timestamp": "2025-08-11 14:21:05",
  "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: WIN, amount: 5.69, parsed: 5.69, type: WIN
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($5.69)',
  transaction_type: 'WIN',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[DEBUG] CHANGEBALANCE: Starting game validation - game_id: 4, transactionType: WIN
[DEBUG] CHANGEBALANCE: Validating game 4
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"7.13","currency_code":"USD","transaction_id":1000013,"transaction_timestamp":"2025-08-11 14:21:05","round_id":568054,"round_finished":false,"game_id":4,"user_id":"48","token":"78d0de2e8724b03a0ec34c869e44ceae","context":{"reason":"not_provided","urid":"TEST1000013","history_id":"test-1000013"}},"request_timestamp":"2025-08-11 14:21:05","hash":"630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d8609adb632f57-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d8609adb632f57-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '7.13',
      currency_code: 'USD',
      transaction_id: 1000013,
      transaction_timestamp: '2025-08-11 14:21:05',
      round_id: 568054,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:05',
    hash: '630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1'
  },
  timestamp: '2025-08-11T14:21:05.268Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "7.13",
    "currency_code": "USD",
    "transaction_id": 1000013,
    "transaction_timestamp": "2025-08-11 14:21:05",
    "round_id": 568054,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000013",
      "history_id": "test-1000013"
    }
  },
  "request_timestamp": "2025-08-11 14:21:05",
  "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "7.13",
    "currency_code": "USD",
    "transaction_id": 1000013,
    "transaction_timestamp": "2025-08-11 14:21:05",
    "round_id": 568054,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000013",
      "history_id": "test-1000013"
    }
  },
  "request_timestamp": "2025-08-11 14:21:05",
  "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d8609adb632f57-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '7.13',
      currency_code: 'USD',
      transaction_id: 1000013,
      transaction_timestamp: '2025-08-11 14:21:05',
      round_id: 568054,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:05',
    hash: '630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1'
  },
  timestamp: '2025-08-11T14:21:05.269Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '7.13',
    currency_code: 'USD',
    transaction_id: 1000013,
    transaction_timestamp: '2025-08-11 14:21:05',
    round_id: 568054,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: '78d0de2e8724b03a0ec34c869e44ceae',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000013',
      history_id: 'test-1000013'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "7.13",
    "currency_code": "USD",
    "transaction_id": 1000013,
    "transaction_timestamp": "2025-08-11 14:21:05",
    "round_id": 568054,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000013",
      "history_id": "test-1000013"
    }
  },
  "request_timestamp": "2025-08-11 14:21:05",
  "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 7.13, parsed: -7.13, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($7.13)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[DEBUG] CHANGEBALANCE: Starting game validation - game_id: 4, transactionType: BET
[DEBUG] CHANGEBALANCE: Validating game 4
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"2.74","currency_code":"USD","transaction_id":1000012,"transaction_timestamp":"2025-08-11 14:21:05","round_id":283122,"round_finished":false,"game_id":4,"user_id":"48","token":"78d0de2e8724b03a0ec34c869e44ceae","context":{"reason":"not_provided","urid":"TEST1000012","history_id":"test-1000012"}},"request_timestamp":"2025-08-11 14:21:05","hash":"630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d8609ad913102d-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d8609ad913102d-LAX',
    'x-operator-id': 'thinkcode_stg',
    accept: 'application/json, text/plain, */*',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG',
    'cf-visitor': '{"scheme":"https"}',
    'x-forwarded-proto': 'https'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '2.74',
      currency_code: 'USD',
      transaction_id: 1000012,
      transaction_timestamp: '2025-08-11 14:21:05',
      round_id: 283122,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:05',
    hash: '630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1'
  },
  timestamp: '2025-08-11T14:21:05.274Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "2.74",
    "currency_code": "USD",
    "transaction_id": 1000012,
    "transaction_timestamp": "2025-08-11 14:21:05",
    "round_id": 283122,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000012",
      "history_id": "test-1000012"
    }
  },
  "request_timestamp": "2025-08-11 14:21:05",
  "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "2.74",
    "currency_code": "USD",
    "transaction_id": 1000012,
    "transaction_timestamp": "2025-08-11 14:21:05",
    "round_id": 283122,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000012",
      "history_id": "test-1000012"
    }
  },
  "request_timestamp": "2025-08-11 14:21:05",
  "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d8609ad913102d-LAX',
    'x-operator-id': 'thinkcode_stg',
    accept: 'application/json, text/plain, */*',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG',
    'cf-visitor': '{"scheme":"https"}',
    'x-forwarded-proto': 'https'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '2.74',
      currency_code: 'USD',
      transaction_id: 1000012,
      transaction_timestamp: '2025-08-11 14:21:05',
      round_id: 283122,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:05',
    hash: '630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1'
  },
  timestamp: '2025-08-11T14:21:05.274Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '2.74',
    currency_code: 'USD',
    transaction_id: 1000012,
    transaction_timestamp: '2025-08-11 14:21:05',
    round_id: 283122,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: '78d0de2e8724b03a0ec34c869e44ceae',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000012',
      history_id: 'test-1000012'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "2.74",
    "currency_code": "USD",
    "transaction_id": 1000012,
    "transaction_timestamp": "2025-08-11 14:21:05",
    "round_id": 283122,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000012",
      "history_id": "test-1000012"
    }
  },
  "request_timestamp": "2025-08-11 14:21:05",
  "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: WIN, amount: 2.74, parsed: 2.74, type: WIN
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($2.74)',
  transaction_type: 'WIN',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[IDEMPOTENCY] Checking for duplicate transactions for user 48
[DEBUG] CHANGEBALANCE: Starting game validation - game_id: 4, transactionType: WIN
[DEBUG] CHANGEBALANCE: Validating game 4
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"8.97","currency_code":"USD","transaction_id":1000011,"transaction_timestamp":"2025-08-11 14:21:05","round_id":321125,"round_finished":false,"game_id":4,"user_id":"48","token":"78d0de2e8724b03a0ec34c869e44ceae","context":{"reason":"not_provided","urid":"TEST1000011","history_id":"test-1000011"}},"request_timestamp":"2025-08-11 14:21:05","hash":"630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d8609adf0514f4-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d8609adf0514f4-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '8.97',
      currency_code: 'USD',
      transaction_id: 1000011,
      transaction_timestamp: '2025-08-11 14:21:05',
      round_id: 321125,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:05',
    hash: '630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1'
  },
  timestamp: '2025-08-11T14:21:05.281Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "8.97",
    "currency_code": "USD",
    "transaction_id": 1000011,
    "transaction_timestamp": "2025-08-11 14:21:05",
    "round_id": 321125,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000011",
      "history_id": "test-1000011"
    }
  },
  "request_timestamp": "2025-08-11 14:21:05",
  "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "8.97",
    "currency_code": "USD",
    "transaction_id": 1000011,
    "transaction_timestamp": "2025-08-11 14:21:05",
    "round_id": 321125,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000011",
      "history_id": "test-1000011"
    }
  },
  "request_timestamp": "2025-08-11 14:21:05",
  "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d8609adf0514f4-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '8.97',
      currency_code: 'USD',
      transaction_id: 1000011,
      transaction_timestamp: '2025-08-11 14:21:05',
      round_id: 321125,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:05',
    hash: '630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1'
  },
  timestamp: '2025-08-11T14:21:05.281Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '8.97',
    currency_code: 'USD',
    transaction_id: 1000011,
    transaction_timestamp: '2025-08-11 14:21:05',
    round_id: 321125,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: '78d0de2e8724b03a0ec34c869e44ceae',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000011',
      history_id: 'test-1000011'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "8.97",
    "currency_code": "USD",
    "transaction_id": 1000011,
    "transaction_timestamp": "2025-08-11 14:21:05",
    "round_id": 321125,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000011",
      "history_id": "test-1000011"
    }
  },
  "request_timestamp": "2025-08-11 14:21:05",
  "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: WIN, amount: 8.97, parsed: 8.97, type: WIN
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($8.97)',
  transaction_type: 'WIN',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[IDEMPOTENCY] Checking for duplicate transactions for user 48
[DEBUG] CHANGEBALANCE: Starting game validation - game_id: 4, transactionType: BET
[DEBUG] CHANGEBALANCE: Validating game 4
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"0.90","currency_code":"USD","transaction_id":1000015,"transaction_timestamp":"2025-08-11 14:21:05","round_id":596418,"round_finished":false,"game_id":4,"user_id":"48","token":"78d0de2e8724b03a0ec34c869e44ceae","context":{"reason":"not_provided","urid":"TEST1000015","history_id":"test-1000015"}},"request_timestamp":"2025-08-11 14:21:05","hash":"630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d8609addeaf049-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d8609addeaf049-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '0.90',
      currency_code: 'USD',
      transaction_id: 1000015,
      transaction_timestamp: '2025-08-11 14:21:05',
      round_id: 596418,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:05',
    hash: '630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1'
  },
  timestamp: '2025-08-11T14:21:05.290Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "0.90",
    "currency_code": "USD",
    "transaction_id": 1000015,
    "transaction_timestamp": "2025-08-11 14:21:05",
    "round_id": 596418,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000015",
      "history_id": "test-1000015"
    }
  },
  "request_timestamp": "2025-08-11 14:21:05",
  "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "0.90",
    "currency_code": "USD",
    "transaction_id": 1000015,
    "transaction_timestamp": "2025-08-11 14:21:05",
    "round_id": 596418,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000015",
      "history_id": "test-1000015"
    }
  },
  "request_timestamp": "2025-08-11 14:21:05",
  "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d8609addeaf049-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '0.90',
      currency_code: 'USD',
      transaction_id: 1000015,
      transaction_timestamp: '2025-08-11 14:21:05',
      round_id: 596418,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:05',
    hash: '630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1'
  },
  timestamp: '2025-08-11T14:21:05.290Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '0.90',
    currency_code: 'USD',
    transaction_id: 1000015,
    transaction_timestamp: '2025-08-11 14:21:05',
    round_id: 596418,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: '78d0de2e8724b03a0ec34c869e44ceae',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000015',
      history_id: 'test-1000015'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "0.90",
    "currency_code": "USD",
    "transaction_id": 1000015,
    "transaction_timestamp": "2025-08-11 14:21:05",
    "round_id": 596418,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000015",
      "history_id": "test-1000015"
    }
  },
  "request_timestamp": "2025-08-11 14:21:05",
  "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 0.90, parsed: -0.9, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($0.90)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[IDEMPOTENCY] Found 0 recent bet transactions with same amount
[IDEMPOTENCY] Transaction 1000018 is new, proceeding with processing
[DEBUG] CHANGEBALANCE: Processing bet of $1.29
[IDEMPOTENCY] Checking for duplicate transactions for user 48
[DEBUG] CHANGEBALANCE: Starting game validation - game_id: 4, transactionType: WIN
[DEBUG] CHANGEBALANCE: Validating game 4
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"4.35","currency_code":"USD","transaction_id":1000016,"transaction_timestamp":"2025-08-11 14:21:05","round_id":583505,"round_finished":false,"game_id":4,"user_id":"48","token":"78d0de2e8724b03a0ec34c869e44ceae","context":{"reason":"not_provided","urid":"TEST1000016","history_id":"test-1000016"}},"request_timestamp":"2025-08-11 14:21:05","hash":"630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d8609ad88d97ca-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d8609ad88d97ca-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '4.35',
      currency_code: 'USD',
      transaction_id: 1000016,
      transaction_timestamp: '2025-08-11 14:21:05',
      round_id: 583505,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:05',
    hash: '630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1'
  },
  timestamp: '2025-08-11T14:21:05.295Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "4.35",
    "currency_code": "USD",
    "transaction_id": 1000016,
    "transaction_timestamp": "2025-08-11 14:21:05",
    "round_id": 583505,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000016",
      "history_id": "test-1000016"
    }
  },
  "request_timestamp": "2025-08-11 14:21:05",
  "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "4.35",
    "currency_code": "USD",
    "transaction_id": 1000016,
    "transaction_timestamp": "2025-08-11 14:21:05",
    "round_id": 583505,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000016",
      "history_id": "test-1000016"
    }
  },
  "request_timestamp": "2025-08-11 14:21:05",
  "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d8609ad88d97ca-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '4.35',
      currency_code: 'USD',
      transaction_id: 1000016,
      transaction_timestamp: '2025-08-11 14:21:05',
      round_id: 583505,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:05',
    hash: '630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1'
  },
  timestamp: '2025-08-11T14:21:05.296Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '4.35',
    currency_code: 'USD',
    transaction_id: 1000016,
    transaction_timestamp: '2025-08-11 14:21:05',
    round_id: 583505,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: '78d0de2e8724b03a0ec34c869e44ceae',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000016',
      history_id: 'test-1000016'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "4.35",
    "currency_code": "USD",
    "transaction_id": 1000016,
    "transaction_timestamp": "2025-08-11 14:21:05",
    "round_id": 583505,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000016",
      "history_id": "test-1000016"
    }
  },
  "request_timestamp": "2025-08-11 14:21:05",
  "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: WIN, amount: 4.35, parsed: 4.35, type: WIN
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($4.35)',
  transaction_type: 'WIN',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[IDEMPOTENCY] Found 0 recent bet transactions with same amount
[IDEMPOTENCY] Transaction 1000019 is new, proceeding with processing
[DEBUG] CHANGEBALANCE: Processing win of $1.37
[IDEMPOTENCY] Checking for duplicate transactions for user 48
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"5.48","currency_code":"USD","transaction_id":1000017,"transaction_timestamp":"2025-08-11 14:21:05","round_id":388549,"round_finished":false,"game_id":4,"user_id":"48","token":"78d0de2e8724b03a0ec34c869e44ceae","context":{"reason":"not_provided","urid":"TEST1000017","history_id":"test-1000017"}},"request_timestamp":"2025-08-11 14:21:05","hash":"630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d8609add00cb93-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d8609add00cb93-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '5.48',
      currency_code: 'USD',
      transaction_id: 1000017,
      transaction_timestamp: '2025-08-11 14:21:05',
      round_id: 388549,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:05',
    hash: '630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1'
  },
  timestamp: '2025-08-11T14:21:05.302Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "5.48",
    "currency_code": "USD",
    "transaction_id": 1000017,
    "transaction_timestamp": "2025-08-11 14:21:05",
    "round_id": 388549,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000017",
      "history_id": "test-1000017"
    }
  },
  "request_timestamp": "2025-08-11 14:21:05",
  "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "5.48",
    "currency_code": "USD",
    "transaction_id": 1000017,
    "transaction_timestamp": "2025-08-11 14:21:05",
    "round_id": 388549,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000017",
      "history_id": "test-1000017"
    }
  },
  "request_timestamp": "2025-08-11 14:21:05",
  "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d8609add00cb93-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '5.48',
      currency_code: 'USD',
      transaction_id: 1000017,
      transaction_timestamp: '2025-08-11 14:21:05',
      round_id: 388549,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:05',
    hash: '630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1'
  },
  timestamp: '2025-08-11T14:21:05.303Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '5.48',
    currency_code: 'USD',
    transaction_id: 1000017,
    transaction_timestamp: '2025-08-11 14:21:05',
    round_id: 388549,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: '78d0de2e8724b03a0ec34c869e44ceae',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000017',
      history_id: 'test-1000017'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "5.48",
    "currency_code": "USD",
    "transaction_id": 1000017,
    "transaction_timestamp": "2025-08-11 14:21:05",
    "round_id": 388549,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000017",
      "history_id": "test-1000017"
    }
  },
  "request_timestamp": "2025-08-11 14:21:05",
  "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 5.48, parsed: -5.48, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($5.48)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[IDEMPOTENCY] Found 0 recent bet transactions with same amount
[IDEMPOTENCY] Transaction 1000014 is new, proceeding with processing
[DEBUG] CHANGEBALANCE: Processing bet of $3.46
[IDEMPOTENCY] Checking for duplicate transactions for user 48
[IDEMPOTENCY] Found 0 recent bet transactions with same amount
[IDEMPOTENCY] Transaction 1000010 is new, proceeding with processing
[DEBUG] CHANGEBALANCE: Processing win of $5.69
[IDEMPOTENCY] Checking for duplicate transactions for user 48
[PROFIT_CONTROL] Processing win: $1.37, Provider RTP: 96.00%
[IDEMPOTENCY] Found 0 recent bet transactions with same amount
[IDEMPOTENCY] Transaction 1000013 is new, proceeding with processing
[DEBUG] CHANGEBALANCE: Processing bet of $7.13
[IDEMPOTENCY] Found 0 recent bet transactions with same amount
[IDEMPOTENCY] Transaction 1000012 is new, proceeding with processing
[DEBUG] CHANGEBALANCE: Processing win of $2.74
[DEBUG] CHANGEBALANCE: Starting game validation - game_id: 4, transactionType: WIN
[DEBUG] CHANGEBALANCE: Validating game 4
[DEBUG] CHANGEBALANCE: Starting game validation - game_id: 4, transactionType: BET
[DEBUG] CHANGEBALANCE: Validating game 4
[PROFIT_CONTROL] Validated metrics: {
  originalAmount: 1.37,
  adjustedAmount: 1.37,
  profitReduction: 0,
  effectiveRtp: '100.00',
  providerRtp: '96.00'
}
[DEBUG] CHANGEBALANCE: Starting game validation - game_id: 4, transactionType: WIN
[DEBUG] CHANGEBALANCE: Validating game 4
[IDEMPOTENCY] Checking for duplicate transactions for user 48
[DEBUG] CHANGEBALANCE: Starting game validation - game_id: 4, transactionType: BET
[DEBUG] CHANGEBALANCE: Validating game 4
[IDEMPOTENCY] Checking for duplicate transactions for user 48
[IDEMPOTENCY] Found 0 recent bet transactions with same amount
[IDEMPOTENCY] Transaction 1000011 is new, proceeding with processing
[DEBUG] CHANGEBALANCE: Processing win of $8.97
[IDEMPOTENCY] Found 0 recent bet transactions with same amount
[IDEMPOTENCY] Transaction 1000015 is new, proceeding with processing
[DEBUG] CHANGEBALANCE: Processing bet of $0.90
[IDEMPOTENCY] Checking for duplicate transactions for user 48
[PROFIT_CONTROL] Win adjustment: $1.37 → $1.37 (reduction: $0.00)
[DEBUG] No bet found with session_id undefined, looking for bet with same round_id 57866
[IDEMPOTENCY] Checking for duplicate transactions for user 48
[DEBUG] No bet found with round_id 57866, looking for most recent bet for game 4
[IDEMPOTENCY] Found 0 recent bet transactions with same amount
[IDEMPOTENCY] Transaction 1000016 is new, proceeding with processing
[DEBUG] CHANGEBALANCE: Processing win of $4.35
[IDEMPOTENCY] Found 0 recent bet transactions with same amount
[IDEMPOTENCY] Transaction 1000017 is new, proceeding with processing
[DEBUG] CHANGEBALANCE: Processing bet of $5.48
[DEBUG] Updated bet 1252 with adjusted win amount 1.37
[WALLET_FIX] Processing win with category balance: $1.37
[WALLET_FIX] Category balance calculation: 26.96 + 1.37 = 28.330000000000002
[WALLET_FIX] Category balance updated: 26.96 + 1.37 = 28.330000000000002
CHANGEBALANCE win processed: {
  bet_id: 1252,
  transaction_id: 2746,
  balance_before: '$26.96',
  balance_after: '$28.33',
  win_amount: '$1.37'
}
[BALANCE_AUDIT] Win processed - Category: slots, Balance: 26.96 -> 28.330000000000002
[TRANSACTION] Successfully committed transaction
[TRANSACTION] Client released
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "1.37",
      "currency_code": "USD",
      "transaction_id": 1000019,
      "transaction_timestamp": "2025-08-11 14:21:05",
      "round_id": 57866,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000019",
        "history_id": "test-1000019"
      }
    },
    "request_timestamp": "2025-08-11 14:21:05",
    "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:05",
    "hash": "8532b9b33dd663b1256276f747cb18684a60cdde",
    "data": {
      "transaction_id": 1000019,
      "status": "OK",
      "balance": 28.33,
      "currency_code": "USD"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "1.37",
      "currency_code": "USD",
      "transaction_id": 1000019,
      "transaction_timestamp": "2025-08-11 14:21:05",
      "round_id": 57866,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000019",
        "history_id": "test-1000019"
      }
    },
    "request_timestamp": "2025-08-11 14:21:05",
    "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:05",
    "hash": "8532b9b33dd663b1256276f747cb18684a60cdde",
    "data": {
      "transaction_id": 1000019,
      "status": "OK",
      "balance": 28.33,
      "currency_code": "USD"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 291.749 ms - 699[0m
[PROFIT_CONTROL] Validated metrics: {
  originalAmount: 1.29,
  adjustedAmount: 1.29,
  profitReduction: 0,
  effectiveRtp: '100.00',
  providerRtp: '96.00'
}
[TRANSACTION] Successfully committed transaction
[TRANSACTION] Client released
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "1.29",
      "currency_code": "USD",
      "transaction_id": 1000018,
      "transaction_timestamp": "2025-08-11 14:21:05",
      "round_id": 106547,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000018",
        "history_id": "test-1000018"
      }
    },
    "request_timestamp": "2025-08-11 14:21:05",
    "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:05",
    "hash": "8532b9b33dd663b1256276f747cb18684a60cdde",
    "data": {
      "transaction_id": 1000018,
      "status": "OK",
      "balance": 27.04,
      "currency_code": "USD"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "1.29",
      "currency_code": "USD",
      "transaction_id": 1000018,
      "transaction_timestamp": "2025-08-11 14:21:05",
      "round_id": 106547,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000018",
        "history_id": "test-1000018"
      }
    },
    "request_timestamp": "2025-08-11 14:21:05",
    "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:05",
    "hash": "8532b9b33dd663b1256276f747cb18684a60cdde",
    "data": {
      "transaction_id": 1000018,
      "status": "OK",
      "balance": 27.04,
      "currency_code": "USD"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 392.779 ms - 700[0m
[PROFIT_CONTROL] Validated metrics: {
  originalAmount: 3.46,
  adjustedAmount: 3.46,
  profitReduction: 0,
  effectiveRtp: '100.00',
  providerRtp: '96.00'
}
[TRANSACTION] Successfully committed transaction
[TRANSACTION] Client released
[PROFIT_CONTROL] Processing win: $4.35, Provider RTP: 96.00%
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "3.46",
      "currency_code": "USD",
      "transaction_id": 1000014,
      "transaction_timestamp": "2025-08-11 14:21:05",
      "round_id": 234929,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000014",
        "history_id": "test-1000014"
      }
    },
    "request_timestamp": "2025-08-11 14:21:05",
    "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:05",
    "hash": "8532b9b33dd663b1256276f747cb18684a60cdde",
    "data": {
      "transaction_id": 1000014,
      "status": "OK",
      "balance": 23.58,
      "currency_code": "USD"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "3.46",
      "currency_code": "USD",
      "transaction_id": 1000014,
      "transaction_timestamp": "2025-08-11 14:21:05",
      "round_id": 234929,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000014",
        "history_id": "test-1000014"
      }
    },
    "request_timestamp": "2025-08-11 14:21:05",
    "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:05",
    "hash": "8532b9b33dd663b1256276f747cb18684a60cdde",
    "data": {
      "transaction_id": 1000014,
      "status": "OK",
      "balance": 23.58,
      "currency_code": "USD"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 457.549 ms - 700[0m
[PROFIT_CONTROL] Validated metrics: {
  originalAmount: 4.35,
  adjustedAmount: 4.35,
  profitReduction: 0,
  effectiveRtp: '100.00',
  providerRtp: '96.00'
}
[PROFIT_CONTROL] Win adjustment: $4.35 → $4.35 (reduction: $0.00)
[DEBUG] No bet found with session_id undefined, looking for bet with same round_id 583505
[DEBUG] No bet found with round_id 583505, looking for most recent bet for game 4
[DEBUG] Updated bet 1254 with adjusted win amount 4.35
[WALLET_FIX] Processing win with category balance: $4.35
[WALLET_FIX] Category balance calculation: 23.58 + 4.35 = 27.93
[WALLET_FIX] Category balance updated: 23.58 + 4.35 = 27.93
CHANGEBALANCE win processed: {
  bet_id: 1254,
  transaction_id: 2749,
  balance_before: '$23.58',
  balance_after: '$27.93',
  win_amount: '$4.35'
}
[BALANCE_AUDIT] Win processed - Category: slots, Balance: 23.58 -> 27.93
[TRANSACTION] Successfully committed transaction
[TRANSACTION] Client released
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "4.35",
      "currency_code": "USD",
      "transaction_id": 1000016,
      "transaction_timestamp": "2025-08-11 14:21:05",
      "round_id": 583505,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000016",
        "history_id": "test-1000016"
      }
    },
    "request_timestamp": "2025-08-11 14:21:05",
    "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:05",
    "hash": "8532b9b33dd663b1256276f747cb18684a60cdde",
    "data": {
      "transaction_id": 1000016,
      "status": "OK",
      "balance": 31.31,
      "currency_code": "USD"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "4.35",
      "currency_code": "USD",
      "transaction_id": 1000016,
      "transaction_timestamp": "2025-08-11 14:21:05",
      "round_id": 583505,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000016",
        "history_id": "test-1000016"
      }
    },
    "request_timestamp": "2025-08-11 14:21:05",
    "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:05",
    "hash": "8532b9b33dd663b1256276f747cb18684a60cdde",
    "data": {
      "transaction_id": 1000016,
      "status": "OK",
      "balance": 31.31,
      "currency_code": "USD"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 451.340 ms - 700[0m
[PROFIT_CONTROL] Validated metrics: {
  originalAmount: 7.13,
  adjustedAmount: 7.13,
  profitReduction: 0,
  effectiveRtp: '100.00',
  providerRtp: '96.00'
}
[TRANSACTION] Successfully committed transaction
[TRANSACTION] Client released
[PROFIT_CONTROL] Processing win: $5.69, Provider RTP: 96.00%
[PROFIT_CONTROL] Validated metrics: {
  originalAmount: 5.69,
  adjustedAmount: 5.69,
  profitReduction: 0,
  effectiveRtp: '100.00',
  providerRtp: '96.00'
}
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "7.13",
      "currency_code": "USD",
      "transaction_id": 1000013,
      "transaction_timestamp": "2025-08-11 14:21:05",
      "round_id": 568054,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000013",
        "history_id": "test-1000013"
      }
    },
    "request_timestamp": "2025-08-11 14:21:05",
    "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:05",
    "hash": "8532b9b33dd663b1256276f747cb18684a60cdde",
    "data": {
      "transaction_id": 1000013,
      "status": "OK",
      "balance": 24.18,
      "currency_code": "USD"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "7.13",
      "currency_code": "USD",
      "transaction_id": 1000013,
      "transaction_timestamp": "2025-08-11 14:21:05",
      "round_id": 568054,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000013",
        "history_id": "test-1000013"
      }
    },
    "request_timestamp": "2025-08-11 14:21:05",
    "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:05",
    "hash": "8532b9b33dd663b1256276f747cb18684a60cdde",
    "data": {
      "transaction_id": 1000013,
      "status": "OK",
      "balance": 24.18,
      "currency_code": "USD"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 551.633 ms - 700[0m
[PROFIT_CONTROL] Win adjustment: $5.69 → $5.69 (reduction: $0.00)
[DEBUG] No bet found with session_id undefined, looking for bet with same round_id 800674
[DEBUG] No bet found with round_id 800674, looking for most recent bet for game 4
[DEBUG] Updated bet 1255 with adjusted win amount 5.69
[WALLET_FIX] Processing win with category balance: $5.69
[WALLET_FIX] Category balance calculation: 24.18 + 5.69 = 29.87
[WALLET_FIX] Category balance updated: 24.18 + 5.69 = 29.87
CHANGEBALANCE win processed: {
  bet_id: 1255,
  transaction_id: 2751,
  balance_before: '$24.18',
  balance_after: '$29.87',
  win_amount: '$5.69'
}
[BALANCE_AUDIT] Win processed - Category: slots, Balance: 24.18 -> 29.87
[PROFIT_CONTROL] Processing win: $2.74, Provider RTP: 96.00%
[TRANSACTION] Successfully committed transaction
[TRANSACTION] Client released
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "5.69",
      "currency_code": "USD",
      "transaction_id": 1000010,
      "transaction_timestamp": "2025-08-11 14:21:05",
      "round_id": 800674,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000010",
        "history_id": "test-1000010"
      }
    },
    "request_timestamp": "2025-08-11 14:21:05",
    "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:05",
    "hash": "8532b9b33dd663b1256276f747cb18684a60cdde",
    "data": {
      "transaction_id": 1000010,
      "status": "OK",
      "balance": 32.65,
      "currency_code": "USD"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "5.69",
      "currency_code": "USD",
      "transaction_id": 1000010,
      "transaction_timestamp": "2025-08-11 14:21:05",
      "round_id": 800674,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000010",
        "history_id": "test-1000010"
      }
    },
    "request_timestamp": "2025-08-11 14:21:05",
    "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:05",
    "hash": "8532b9b33dd663b1256276f747cb18684a60cdde",
    "data": {
      "transaction_id": 1000010,
      "status": "OK",
      "balance": 32.65,
      "currency_code": "USD"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 655.735 ms - 700[0m
[PROFIT_CONTROL] Validated metrics: {
  originalAmount: 2.74,
  adjustedAmount: 2.74,
  profitReduction: 0,
  effectiveRtp: '100.00',
  providerRtp: '96.00'
}
[PROFIT_CONTROL] Win adjustment: $2.74 → $2.74 (reduction: $0.00)
[DEBUG] No bet found with session_id undefined, looking for bet with same round_id 283122
[DEBUG] No bet found with round_id 283122, looking for most recent bet for game 4
[DEBUG] Updated bet 1255 with adjusted win amount 2.74
[WALLET_FIX] Processing win with category balance: $2.74
[WALLET_FIX] Category balance calculation: 32.65 + 2.74 = 35.39
[WALLET_FIX] Category balance updated: 32.65 + 2.74 = 35.39
CHANGEBALANCE win processed: {
  bet_id: 1255,
  transaction_id: 2752,
  balance_before: '$32.65',
  balance_after: '$35.39',
  win_amount: '$2.74'
}
[BALANCE_AUDIT] Win processed - Category: slots, Balance: 32.65 -> 35.39
[TRANSACTION] Successfully committed transaction
[TRANSACTION] Client released
[PROFIT_CONTROL] Processing win: $8.97, Provider RTP: 96.00%
[PROFIT_CONTROL] Validated metrics: {
  originalAmount: 8.97,
  adjustedAmount: 8.97,
  profitReduction: 0,
  effectiveRtp: '100.00',
  providerRtp: '96.00'
}
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "2.74",
      "currency_code": "USD",
      "transaction_id": 1000012,
      "transaction_timestamp": "2025-08-11 14:21:05",
      "round_id": 283122,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000012",
        "history_id": "test-1000012"
      }
    },
    "request_timestamp": "2025-08-11 14:21:05",
    "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:05",
    "hash": "8532b9b33dd663b1256276f747cb18684a60cdde",
    "data": {
      "transaction_id": 1000012,
      "status": "OK",
      "balance": 29.7,
      "currency_code": "USD"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "2.74",
      "currency_code": "USD",
      "transaction_id": 1000012,
      "transaction_timestamp": "2025-08-11 14:21:05",
      "round_id": 283122,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000012",
        "history_id": "test-1000012"
      }
    },
    "request_timestamp": "2025-08-11 14:21:05",
    "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:05",
    "hash": "8532b9b33dd663b1256276f747cb18684a60cdde",
    "data": {
      "transaction_id": 1000012,
      "status": "OK",
      "balance": 29.7,
      "currency_code": "USD"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 676.450 ms - 699[0m
[PROFIT_CONTROL] Win adjustment: $8.97 → $8.97 (reduction: $0.00)
[DEBUG] No bet found with session_id undefined, looking for bet with same round_id 321125
[DEBUG] No bet found with round_id 321125, looking for most recent bet for game 4
[DEBUG] Updated bet 1255 with adjusted win amount 8.97
[WALLET_FIX] Processing win with category balance: $8.97
[WALLET_FIX] Category balance calculation: 29.7 + 8.97 = 38.67
[WALLET_FIX] Category balance updated: 29.7 + 8.97 = 38.67
CHANGEBALANCE win processed: {
  bet_id: 1255,
  transaction_id: 2753,
  balance_before: '$29.70',
  balance_after: '$38.67',
  win_amount: '$8.97'
}
[BALANCE_AUDIT] Win processed - Category: slots, Balance: 29.7 -> 38.67
[TRANSACTION] Successfully committed transaction
[TRANSACTION] Client released
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "8.97",
      "currency_code": "USD",
      "transaction_id": 1000011,
      "transaction_timestamp": "2025-08-11 14:21:05",
      "round_id": 321125,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000011",
        "history_id": "test-1000011"
      }
    },
    "request_timestamp": "2025-08-11 14:21:05",
    "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:05",
    "hash": "8532b9b33dd663b1256276f747cb18684a60cdde",
    "data": {
      "transaction_id": 1000011,
      "status": "OK",
      "balance": 35.93,
      "currency_code": "USD"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "8.97",
      "currency_code": "USD",
      "transaction_id": 1000011,
      "transaction_timestamp": "2025-08-11 14:21:05",
      "round_id": 321125,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000011",
        "history_id": "test-1000011"
      }
    },
    "request_timestamp": "2025-08-11 14:21:05",
    "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:05",
    "hash": "8532b9b33dd663b1256276f747cb18684a60cdde",
    "data": {
      "transaction_id": 1000011,
      "status": "OK",
      "balance": 35.93,
      "currency_code": "USD"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 713.364 ms - 700[0m
[PROFIT_CONTROL] Validated metrics: {
  originalAmount: 0.9,
  adjustedAmount: 0.9,
  profitReduction: 0,
  effectiveRtp: '100.00',
  providerRtp: '96.00'
}
[TRANSACTION] Successfully committed transaction
[TRANSACTION] Client released
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "0.90",
      "currency_code": "USD",
      "transaction_id": 1000015,
      "transaction_timestamp": "2025-08-11 14:21:05",
      "round_id": 596418,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000015",
        "history_id": "test-1000015"
      }
    },
    "request_timestamp": "2025-08-11 14:21:05",
    "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:06",
    "hash": "a37656bb532d54fcf6f5356d539541586ff97caf",
    "data": {
      "transaction_id": 1000015,
      "status": "OK",
      "balance": 35.03,
      "currency_code": "USD"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "0.90",
      "currency_code": "USD",
      "transaction_id": 1000015,
      "transaction_timestamp": "2025-08-11 14:21:05",
      "round_id": 596418,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000015",
        "history_id": "test-1000015"
      }
    },
    "request_timestamp": "2025-08-11 14:21:05",
    "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:06",
    "hash": "a37656bb532d54fcf6f5356d539541586ff97caf",
    "data": {
      "transaction_id": 1000015,
      "status": "OK",
      "balance": 35.03,
      "currency_code": "USD"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 754.837 ms - 700[0m
[PROFIT_CONTROL] Validated metrics: {
  originalAmount: 5.48,
  adjustedAmount: 5.48,
  profitReduction: 0,
  effectiveRtp: '100.00',
  providerRtp: '96.00'
}
[TRANSACTION] Successfully committed transaction
[TRANSACTION] Client released
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "5.48",
      "currency_code": "USD",
      "transaction_id": 1000017,
      "transaction_timestamp": "2025-08-11 14:21:05",
      "round_id": 388549,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000017",
        "history_id": "test-1000017"
      }
    },
    "request_timestamp": "2025-08-11 14:21:05",
    "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:06",
    "hash": "a37656bb532d54fcf6f5356d539541586ff97caf",
    "data": {
      "transaction_id": 1000017,
      "status": "OK",
      "balance": 29.55,
      "currency_code": "USD"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "5.48",
      "currency_code": "USD",
      "transaction_id": 1000017,
      "transaction_timestamp": "2025-08-11 14:21:05",
      "round_id": 388549,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000017",
        "history_id": "test-1000017"
      }
    },
    "request_timestamp": "2025-08-11 14:21:05",
    "hash": "630dd3ab1e5c9f71efc55f6d51dc23126a6de9b1"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:06",
    "hash": "a37656bb532d54fcf6f5356d539541586ff97caf",
    "data": {
      "transaction_id": 1000017,
      "status": "OK",
      "balance": 29.55,
      "currency_code": "USD"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 796.578 ms - 700[0m
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"9.23","currency_code":"USD","transaction_id":1000028,"transaction_timestamp":"2025-08-11 14:21:07","round_id":173297,"round_finished":false,"game_id":4,"user_id":"48","token":"78d0de2e8724b03a0ec34c869e44ceae","context":{"reason":"not_provided","urid":"TEST1000028","history_id":"test-1000028"}},"request_timestamp":"2025-08-11 14:21:07","hash":"b63aed1107386082cac7a40d60496de62e8caed0"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d860a94b12cb92-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860a94b12cb92-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '9.23',
      currency_code: 'USD',
      transaction_id: 1000028,
      transaction_timestamp: '2025-08-11 14:21:07',
      round_id: 173297,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:07',
    hash: 'b63aed1107386082cac7a40d60496de62e8caed0'
  },
  timestamp: '2025-08-11T14:21:07.505Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "9.23",
    "currency_code": "USD",
    "transaction_id": 1000028,
    "transaction_timestamp": "2025-08-11 14:21:07",
    "round_id": 173297,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000028",
      "history_id": "test-1000028"
    }
  },
  "request_timestamp": "2025-08-11 14:21:07",
  "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "9.23",
    "currency_code": "USD",
    "transaction_id": 1000028,
    "transaction_timestamp": "2025-08-11 14:21:07",
    "round_id": 173297,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000028",
      "history_id": "test-1000028"
    }
  },
  "request_timestamp": "2025-08-11 14:21:07",
  "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860a94b12cb92-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '9.23',
      currency_code: 'USD',
      transaction_id: 1000028,
      transaction_timestamp: '2025-08-11 14:21:07',
      round_id: 173297,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:07',
    hash: 'b63aed1107386082cac7a40d60496de62e8caed0'
  },
  timestamp: '2025-08-11T14:21:07.506Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '9.23',
    currency_code: 'USD',
    transaction_id: 1000028,
    transaction_timestamp: '2025-08-11 14:21:07',
    round_id: 173297,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: '78d0de2e8724b03a0ec34c869e44ceae',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000028',
      history_id: 'test-1000028'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "9.23",
    "currency_code": "USD",
    "transaction_id": 1000028,
    "transaction_timestamp": "2025-08-11 14:21:07",
    "round_id": 173297,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000028",
      "history_id": "test-1000028"
    }
  },
  "request_timestamp": "2025-08-11 14:21:07",
  "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 9.23, parsed: -9.23, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($9.23)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"1.51","currency_code":"USD","transaction_id":1000023,"transaction_timestamp":"2025-08-11 14:21:07","round_id":729395,"round_finished":false,"game_id":4,"user_id":"48","token":"78d0de2e8724b03a0ec34c869e44ceae","context":{"reason":"not_provided","urid":"TEST1000023","history_id":"test-1000023"}},"request_timestamp":"2025-08-11 14:21:07","hash":"b63aed1107386082cac7a40d60496de62e8caed0"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d860a94f2f102d-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860a94f2f102d-LAX',
    'x-operator-id': 'thinkcode_stg',
    accept: 'application/json, text/plain, */*',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG',
    'cf-visitor': '{"scheme":"https"}',
    'x-forwarded-proto': 'https'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '1.51',
      currency_code: 'USD',
      transaction_id: 1000023,
      transaction_timestamp: '2025-08-11 14:21:07',
      round_id: 729395,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:07',
    hash: 'b63aed1107386082cac7a40d60496de62e8caed0'
  },
  timestamp: '2025-08-11T14:21:07.514Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "1.51",
    "currency_code": "USD",
    "transaction_id": 1000023,
    "transaction_timestamp": "2025-08-11 14:21:07",
    "round_id": 729395,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000023",
      "history_id": "test-1000023"
    }
  },
  "request_timestamp": "2025-08-11 14:21:07",
  "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "1.51",
    "currency_code": "USD",
    "transaction_id": 1000023,
    "transaction_timestamp": "2025-08-11 14:21:07",
    "round_id": 729395,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000023",
      "history_id": "test-1000023"
    }
  },
  "request_timestamp": "2025-08-11 14:21:07",
  "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860a94f2f102d-LAX',
    'x-operator-id': 'thinkcode_stg',
    accept: 'application/json, text/plain, */*',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG',
    'cf-visitor': '{"scheme":"https"}',
    'x-forwarded-proto': 'https'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '1.51',
      currency_code: 'USD',
      transaction_id: 1000023,
      transaction_timestamp: '2025-08-11 14:21:07',
      round_id: 729395,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:07',
    hash: 'b63aed1107386082cac7a40d60496de62e8caed0'
  },
  timestamp: '2025-08-11T14:21:07.514Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '1.51',
    currency_code: 'USD',
    transaction_id: 1000023,
    transaction_timestamp: '2025-08-11 14:21:07',
    round_id: 729395,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: '78d0de2e8724b03a0ec34c869e44ceae',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000023',
      history_id: 'test-1000023'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "1.51",
    "currency_code": "USD",
    "transaction_id": 1000023,
    "transaction_timestamp": "2025-08-11 14:21:07",
    "round_id": 729395,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000023",
      "history_id": "test-1000023"
    }
  },
  "request_timestamp": "2025-08-11 14:21:07",
  "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 1.51, parsed: -1.51, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($1.51)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"4.58","currency_code":"USD","transaction_id":1000024,"transaction_timestamp":"2025-08-11 14:21:07","round_id":446182,"round_finished":false,"game_id":4,"user_id":"48","token":"78d0de2e8724b03a0ec34c869e44ceae","context":{"reason":"not_provided","urid":"TEST1000024","history_id":"test-1000024"}},"request_timestamp":"2025-08-11 14:21:07","hash":"b63aed1107386082cac7a40d60496de62e8caed0"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d860a94c942b5f-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860a94c942b5f-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '4.58',
      currency_code: 'USD',
      transaction_id: 1000024,
      transaction_timestamp: '2025-08-11 14:21:07',
      round_id: 446182,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:07',
    hash: 'b63aed1107386082cac7a40d60496de62e8caed0'
  },
  timestamp: '2025-08-11T14:21:07.518Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "4.58",
    "currency_code": "USD",
    "transaction_id": 1000024,
    "transaction_timestamp": "2025-08-11 14:21:07",
    "round_id": 446182,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000024",
      "history_id": "test-1000024"
    }
  },
  "request_timestamp": "2025-08-11 14:21:07",
  "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "4.58",
    "currency_code": "USD",
    "transaction_id": 1000024,
    "transaction_timestamp": "2025-08-11 14:21:07",
    "round_id": 446182,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000024",
      "history_id": "test-1000024"
    }
  },
  "request_timestamp": "2025-08-11 14:21:07",
  "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860a94c942b5f-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '4.58',
      currency_code: 'USD',
      transaction_id: 1000024,
      transaction_timestamp: '2025-08-11 14:21:07',
      round_id: 446182,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:07',
    hash: 'b63aed1107386082cac7a40d60496de62e8caed0'
  },
  timestamp: '2025-08-11T14:21:07.518Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '4.58',
    currency_code: 'USD',
    transaction_id: 1000024,
    transaction_timestamp: '2025-08-11 14:21:07',
    round_id: 446182,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: '78d0de2e8724b03a0ec34c869e44ceae',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000024',
      history_id: 'test-1000024'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "4.58",
    "currency_code": "USD",
    "transaction_id": 1000024,
    "transaction_timestamp": "2025-08-11 14:21:07",
    "round_id": 446182,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000024",
      "history_id": "test-1000024"
    }
  },
  "request_timestamp": "2025-08-11 14:21:07",
  "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 4.58, parsed: -4.58, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($4.58)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[DEBUG] CHANGEBALANCE: Starting game validation - game_id: 4, transactionType: BET
[DEBUG] CHANGEBALANCE: Validating game 4
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"6.26","currency_code":"USD","transaction_id":1000029,"transaction_timestamp":"2025-08-11 14:21:07","round_id":925433,"round_finished":false,"game_id":4,"user_id":"48","token":"78d0de2e8724b03a0ec34c869e44ceae","context":{"reason":"not_provided","urid":"TEST1000029","history_id":"test-1000029"}},"request_timestamp":"2025-08-11 14:21:07","hash":"b63aed1107386082cac7a40d60496de62e8caed0"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d860a94dd3db66-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860a94dd3db66-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '6.26',
      currency_code: 'USD',
      transaction_id: 1000029,
      transaction_timestamp: '2025-08-11 14:21:07',
      round_id: 925433,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:07',
    hash: 'b63aed1107386082cac7a40d60496de62e8caed0'
  },
  timestamp: '2025-08-11T14:21:07.523Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "6.26",
    "currency_code": "USD",
    "transaction_id": 1000029,
    "transaction_timestamp": "2025-08-11 14:21:07",
    "round_id": 925433,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000029",
      "history_id": "test-1000029"
    }
  },
  "request_timestamp": "2025-08-11 14:21:07",
  "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "6.26",
    "currency_code": "USD",
    "transaction_id": 1000029,
    "transaction_timestamp": "2025-08-11 14:21:07",
    "round_id": 925433,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000029",
      "history_id": "test-1000029"
    }
  },
  "request_timestamp": "2025-08-11 14:21:07",
  "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860a94dd3db66-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '6.26',
      currency_code: 'USD',
      transaction_id: 1000029,
      transaction_timestamp: '2025-08-11 14:21:07',
      round_id: 925433,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:07',
    hash: 'b63aed1107386082cac7a40d60496de62e8caed0'
  },
  timestamp: '2025-08-11T14:21:07.523Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '6.26',
    currency_code: 'USD',
    transaction_id: 1000029,
    transaction_timestamp: '2025-08-11 14:21:07',
    round_id: 925433,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: '78d0de2e8724b03a0ec34c869e44ceae',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000029',
      history_id: 'test-1000029'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "6.26",
    "currency_code": "USD",
    "transaction_id": 1000029,
    "transaction_timestamp": "2025-08-11 14:21:07",
    "round_id": 925433,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000029",
      "history_id": "test-1000029"
    }
  },
  "request_timestamp": "2025-08-11 14:21:07",
  "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: WIN, amount: 6.26, parsed: 6.26, type: WIN
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($6.26)',
  transaction_type: 'WIN',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[DEBUG] CHANGEBALANCE: Starting game validation - game_id: 4, transactionType: BET
[DEBUG] CHANGEBALANCE: Validating game 4
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"6.58","currency_code":"USD","transaction_id":1000022,"transaction_timestamp":"2025-08-11 14:21:07","round_id":897078,"round_finished":false,"game_id":4,"user_id":"48","token":"78d0de2e8724b03a0ec34c869e44ceae","context":{"reason":"not_provided","urid":"TEST1000022","history_id":"test-1000022"}},"request_timestamp":"2025-08-11 14:21:07","hash":"b63aed1107386082cac7a40d60496de62e8caed0"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d860a94d2314f4-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860a94d2314f4-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '6.58',
      currency_code: 'USD',
      transaction_id: 1000022,
      transaction_timestamp: '2025-08-11 14:21:07',
      round_id: 897078,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:07',
    hash: 'b63aed1107386082cac7a40d60496de62e8caed0'
  },
  timestamp: '2025-08-11T14:21:07.527Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "6.58",
    "currency_code": "USD",
    "transaction_id": 1000022,
    "transaction_timestamp": "2025-08-11 14:21:07",
    "round_id": 897078,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000022",
      "history_id": "test-1000022"
    }
  },
  "request_timestamp": "2025-08-11 14:21:07",
  "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "6.58",
    "currency_code": "USD",
    "transaction_id": 1000022,
    "transaction_timestamp": "2025-08-11 14:21:07",
    "round_id": 897078,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000022",
      "history_id": "test-1000022"
    }
  },
  "request_timestamp": "2025-08-11 14:21:07",
  "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860a94d2314f4-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '6.58',
      currency_code: 'USD',
      transaction_id: 1000022,
      transaction_timestamp: '2025-08-11 14:21:07',
      round_id: 897078,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:07',
    hash: 'b63aed1107386082cac7a40d60496de62e8caed0'
  },
  timestamp: '2025-08-11T14:21:07.527Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '6.58',
    currency_code: 'USD',
    transaction_id: 1000022,
    transaction_timestamp: '2025-08-11 14:21:07',
    round_id: 897078,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: '78d0de2e8724b03a0ec34c869e44ceae',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000022',
      history_id: 'test-1000022'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "6.58",
    "currency_code": "USD",
    "transaction_id": 1000022,
    "transaction_timestamp": "2025-08-11 14:21:07",
    "round_id": 897078,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000022",
      "history_id": "test-1000022"
    }
  },
  "request_timestamp": "2025-08-11 14:21:07",
  "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 6.58, parsed: -6.58, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($6.58)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[DEBUG] CHANGEBALANCE: Starting game validation - game_id: 4, transactionType: BET
[DEBUG] CHANGEBALANCE: Validating game 4
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"7.30","currency_code":"USD","transaction_id":1000025,"transaction_timestamp":"2025-08-11 14:21:07","round_id":37812,"round_finished":false,"game_id":4,"user_id":"48","token":"78d0de2e8724b03a0ec34c869e44ceae","context":{"reason":"not_provided","urid":"TEST1000025","history_id":"test-1000025"}},"request_timestamp":"2025-08-11 14:21:07","hash":"b63aed1107386082cac7a40d60496de62e8caed0"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d860a95bd22f57-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '481',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860a95bd22f57-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '7.30',
      currency_code: 'USD',
      transaction_id: 1000025,
      transaction_timestamp: '2025-08-11 14:21:07',
      round_id: 37812,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:07',
    hash: 'b63aed1107386082cac7a40d60496de62e8caed0'
  },
  timestamp: '2025-08-11T14:21:07.535Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "7.30",
    "currency_code": "USD",
    "transaction_id": 1000025,
    "transaction_timestamp": "2025-08-11 14:21:07",
    "round_id": 37812,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000025",
      "history_id": "test-1000025"
    }
  },
  "request_timestamp": "2025-08-11 14:21:07",
  "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "7.30",
    "currency_code": "USD",
    "transaction_id": 1000025,
    "transaction_timestamp": "2025-08-11 14:21:07",
    "round_id": 37812,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000025",
      "history_id": "test-1000025"
    }
  },
  "request_timestamp": "2025-08-11 14:21:07",
  "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '481',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860a95bd22f57-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '7.30',
      currency_code: 'USD',
      transaction_id: 1000025,
      transaction_timestamp: '2025-08-11 14:21:07',
      round_id: 37812,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:07',
    hash: 'b63aed1107386082cac7a40d60496de62e8caed0'
  },
  timestamp: '2025-08-11T14:21:07.535Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '7.30',
    currency_code: 'USD',
    transaction_id: 1000025,
    transaction_timestamp: '2025-08-11 14:21:07',
    round_id: 37812,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: '78d0de2e8724b03a0ec34c869e44ceae',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000025',
      history_id: 'test-1000025'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "7.30",
    "currency_code": "USD",
    "transaction_id": 1000025,
    "transaction_timestamp": "2025-08-11 14:21:07",
    "round_id": 37812,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000025",
      "history_id": "test-1000025"
    }
  },
  "request_timestamp": "2025-08-11 14:21:07",
  "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: WIN, amount: 7.30, parsed: 7.3, type: WIN
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($7.30)',
  transaction_type: 'WIN',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[IDEMPOTENCY] Checking for duplicate transactions for user 48
[DEBUG] CHANGEBALANCE: Starting game validation - game_id: 4, transactionType: WIN
[DEBUG] CHANGEBALANCE: Validating game 4
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"6.19","currency_code":"USD","transaction_id":1000027,"transaction_timestamp":"2025-08-11 14:21:07","round_id":561823,"round_finished":false,"game_id":4,"user_id":"48","token":"78d0de2e8724b03a0ec34c869e44ceae","context":{"reason":"not_provided","urid":"TEST1000027","history_id":"test-1000027"}},"request_timestamp":"2025-08-11 14:21:07","hash":"b63aed1107386082cac7a40d60496de62e8caed0"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d860a94ba37c04-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860a94ba37c04-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '6.19',
      currency_code: 'USD',
      transaction_id: 1000027,
      transaction_timestamp: '2025-08-11 14:21:07',
      round_id: 561823,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:07',
    hash: 'b63aed1107386082cac7a40d60496de62e8caed0'
  },
  timestamp: '2025-08-11T14:21:07.539Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "6.19",
    "currency_code": "USD",
    "transaction_id": 1000027,
    "transaction_timestamp": "2025-08-11 14:21:07",
    "round_id": 561823,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000027",
      "history_id": "test-1000027"
    }
  },
  "request_timestamp": "2025-08-11 14:21:07",
  "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "6.19",
    "currency_code": "USD",
    "transaction_id": 1000027,
    "transaction_timestamp": "2025-08-11 14:21:07",
    "round_id": 561823,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000027",
      "history_id": "test-1000027"
    }
  },
  "request_timestamp": "2025-08-11 14:21:07",
  "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860a94ba37c04-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '6.19',
      currency_code: 'USD',
      transaction_id: 1000027,
      transaction_timestamp: '2025-08-11 14:21:07',
      round_id: 561823,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:07',
    hash: 'b63aed1107386082cac7a40d60496de62e8caed0'
  },
  timestamp: '2025-08-11T14:21:07.540Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '6.19',
    currency_code: 'USD',
    transaction_id: 1000027,
    transaction_timestamp: '2025-08-11 14:21:07',
    round_id: 561823,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: '78d0de2e8724b03a0ec34c869e44ceae',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000027',
      history_id: 'test-1000027'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "6.19",
    "currency_code": "USD",
    "transaction_id": 1000027,
    "transaction_timestamp": "2025-08-11 14:21:07",
    "round_id": 561823,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000027",
      "history_id": "test-1000027"
    }
  },
  "request_timestamp": "2025-08-11 14:21:07",
  "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: WIN, amount: 6.19, parsed: 6.19, type: WIN
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($6.19)',
  transaction_type: 'WIN',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[IDEMPOTENCY] Checking for duplicate transactions for user 48
[DEBUG] CHANGEBALANCE: Starting game validation - game_id: 4, transactionType: BET
[DEBUG] CHANGEBALANCE: Validating game 4
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"3.04","currency_code":"USD","transaction_id":1000026,"transaction_timestamp":"2025-08-11 14:21:07","round_id":546167,"round_finished":false,"game_id":4,"user_id":"48","token":"78d0de2e8724b03a0ec34c869e44ceae","context":{"reason":"not_provided","urid":"TEST1000026","history_id":"test-1000026"}},"request_timestamp":"2025-08-11 14:21:07","hash":"b63aed1107386082cac7a40d60496de62e8caed0"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d860a94a3797ca-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860a94a3797ca-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '3.04',
      currency_code: 'USD',
      transaction_id: 1000026,
      transaction_timestamp: '2025-08-11 14:21:07',
      round_id: 546167,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:07',
    hash: 'b63aed1107386082cac7a40d60496de62e8caed0'
  },
  timestamp: '2025-08-11T14:21:07.544Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "3.04",
    "currency_code": "USD",
    "transaction_id": 1000026,
    "transaction_timestamp": "2025-08-11 14:21:07",
    "round_id": 546167,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000026",
      "history_id": "test-1000026"
    }
  },
  "request_timestamp": "2025-08-11 14:21:07",
  "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "3.04",
    "currency_code": "USD",
    "transaction_id": 1000026,
    "transaction_timestamp": "2025-08-11 14:21:07",
    "round_id": 546167,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000026",
      "history_id": "test-1000026"
    }
  },
  "request_timestamp": "2025-08-11 14:21:07",
  "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860a94a3797ca-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '3.04',
      currency_code: 'USD',
      transaction_id: 1000026,
      transaction_timestamp: '2025-08-11 14:21:07',
      round_id: 546167,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:07',
    hash: 'b63aed1107386082cac7a40d60496de62e8caed0'
  },
  timestamp: '2025-08-11T14:21:07.544Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '3.04',
    currency_code: 'USD',
    transaction_id: 1000026,
    transaction_timestamp: '2025-08-11 14:21:07',
    round_id: 546167,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: '78d0de2e8724b03a0ec34c869e44ceae',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000026',
      history_id: 'test-1000026'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "3.04",
    "currency_code": "USD",
    "transaction_id": 1000026,
    "transaction_timestamp": "2025-08-11 14:21:07",
    "round_id": 546167,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000026",
      "history_id": "test-1000026"
    }
  },
  "request_timestamp": "2025-08-11 14:21:07",
  "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 3.04, parsed: -3.04, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($3.04)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[IDEMPOTENCY] Found 0 recent bet transactions with same amount
[IDEMPOTENCY] Transaction 1000028 is new, proceeding with processing
[DEBUG] CHANGEBALANCE: Processing bet of $9.23
[IDEMPOTENCY] Checking for duplicate transactions for user 48
[DEBUG] CHANGEBALANCE: Starting game validation - game_id: 4, transactionType: WIN
[DEBUG] CHANGEBALANCE: Validating game 4
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"BET","reason":"not_provided","amount":"7.47","currency_code":"USD","transaction_id":1000021,"transaction_timestamp":"2025-08-11 14:21:07","round_id":452405,"round_finished":false,"game_id":4,"user_id":"48","token":"78d0de2e8724b03a0ec34c869e44ceae","context":{"reason":"not_provided","urid":"TEST1000021","history_id":"test-1000021"}},"request_timestamp":"2025-08-11 14:21:07","hash":"b63aed1107386082cac7a40d60496de62e8caed0"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d860a94d8ff049-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860a94d8ff049-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '7.47',
      currency_code: 'USD',
      transaction_id: 1000021,
      transaction_timestamp: '2025-08-11 14:21:07',
      round_id: 452405,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:07',
    hash: 'b63aed1107386082cac7a40d60496de62e8caed0'
  },
  timestamp: '2025-08-11T14:21:07.552Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "7.47",
    "currency_code": "USD",
    "transaction_id": 1000021,
    "transaction_timestamp": "2025-08-11 14:21:07",
    "round_id": 452405,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000021",
      "history_id": "test-1000021"
    }
  },
  "request_timestamp": "2025-08-11 14:21:07",
  "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "7.47",
    "currency_code": "USD",
    "transaction_id": 1000021,
    "transaction_timestamp": "2025-08-11 14:21:07",
    "round_id": 452405,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000021",
      "history_id": "test-1000021"
    }
  },
  "request_timestamp": "2025-08-11 14:21:07",
  "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860a94d8ff049-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'BET',
      reason: 'not_provided',
      amount: '7.47',
      currency_code: 'USD',
      transaction_id: 1000021,
      transaction_timestamp: '2025-08-11 14:21:07',
      round_id: 452405,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:07',
    hash: 'b63aed1107386082cac7a40d60496de62e8caed0'
  },
  timestamp: '2025-08-11T14:21:07.553Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'BET',
    reason: 'not_provided',
    amount: '7.47',
    currency_code: 'USD',
    transaction_id: 1000021,
    transaction_timestamp: '2025-08-11 14:21:07',
    round_id: 452405,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: '78d0de2e8724b03a0ec34c869e44ceae',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000021',
      history_id: 'test-1000021'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "BET",
    "reason": "not_provided",
    "amount": "7.47",
    "currency_code": "USD",
    "transaction_id": 1000021,
    "transaction_timestamp": "2025-08-11 14:21:07",
    "round_id": 452405,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000021",
      "history_id": "test-1000021"
    }
  },
  "request_timestamp": "2025-08-11 14:21:07",
  "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: BET, amount: 7.47, parsed: -7.47, type: BET
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($7.47)',
  transaction_type: 'BET',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[IDEMPOTENCY] Found 0 recent bet transactions with same amount
[IDEMPOTENCY] Transaction 1000023 is new, proceeding with processing
[DEBUG] CHANGEBALANCE: Processing bet of $1.51
[DEBUG] CHANGEBALANCE: Starting game validation - game_id: 4, transactionType: WIN
[DEBUG] CHANGEBALANCE: Validating game 4
[APP DEBUG] Incoming request: POST /api/innova/changebalance body: {"command":"changebalance","data":{"transaction_type":"WIN","reason":"not_provided","amount":"3.40","currency_code":"USD","transaction_id":1000020,"transaction_timestamp":"2025-08-11 14:21:07","round_id":167074,"round_finished":false,"game_id":4,"user_id":"48","token":"78d0de2e8724b03a0ec34c869e44ceae","context":{"reason":"not_provided","urid":"TEST1000020","history_id":"test-1000020"}},"request_timestamp":"2025-08-11 14:21:07","hash":"b63aed1107386082cac7a40d60496de62e8caed0"}
[CLOUDFLARE] Request from Cloudflare - Ray: 96d860a94a35cb93-LAX, IP: 2407:3640:2275:22::1
[PROVIDER DEBUG] {
  path: '/api/innova/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860a94a35cb93-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '3.40',
      currency_code: 'USD',
      transaction_id: 1000020,
      transaction_timestamp: '2025-08-11 14:21:07',
      round_id: 167074,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:07',
    hash: 'b63aed1107386082cac7a40d60496de62e8caed0'
  },
  timestamp: '2025-08-11T14:21:07.558Z'
}
[TEST ROUTE] /changebalance route hit!
[TEST ROUTE] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "3.40",
    "currency_code": "USD",
    "transaction_id": 1000020,
    "transaction_timestamp": "2025-08-11 14:21:07",
    "round_id": 167074,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000020",
      "history_id": "test-1000020"
    }
  },
  "request_timestamp": "2025-08-11 14:21:07",
  "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
}
[ROUTE DEBUG] /innova route handler hit - VERSION 3.0
[ROUTE DEBUG] Request path: /changebalance
[ROUTE DEBUG] Request method: POST
[ROUTE DEBUG] Request body: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "3.40",
    "currency_code": "USD",
    "transaction_id": 1000020,
    "transaction_timestamp": "2025-08-11 14:21:07",
    "round_id": 167074,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000020",
      "history_id": "test-1000020"
    }
  },
  "request_timestamp": "2025-08-11 14:21:07",
  "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
}
Provider callback received: {
  path: '/changebalance',
  method: 'POST',
  headers: {
    connection: 'upgrade',
    host: 'backend.jackpotx.net',
    'content-length': '482',
    'x-forwarded-for': '2407:3640:2275:22::1',
    'content-type': 'application/json',
    'x-authorization': '63116a7611437044617d6ac66069bfa6010e3d1f',
    'accept-encoding': 'gzip, br',
    'user-agent': 'axios/1.11.0',
    'cf-ray': '96d860a94a35cb93-LAX',
    'x-operator-id': 'thinkcode_stg',
    'cf-visitor': '{"scheme":"https"}',
    accept: 'application/json, text/plain, */*',
    'x-forwarded-proto': 'https',
    'cdn-loop': 'cloudflare; loops=1',
    'cf-connecting-ip': '2407:3640:2275:22::1',
    'cf-ipcountry': 'SG'
  },
  body: {
    command: 'changebalance',
    data: {
      transaction_type: 'WIN',
      reason: 'not_provided',
      amount: '3.40',
      currency_code: 'USD',
      transaction_id: 1000020,
      transaction_timestamp: '2025-08-11 14:21:07',
      round_id: 167074,
      round_finished: false,
      game_id: 4,
      user_id: '48',
      token: '78d0de2e8724b03a0ec34c869e44ceae',
      context: [Object]
    },
    request_timestamp: '2025-08-11 14:21:07',
    hash: 'b63aed1107386082cac7a40d60496de62e8caed0'
  },
  timestamp: '2025-08-11T14:21:07.558Z'
}
Processing provider callback: {
  command: 'changebalance',
  data: {
    transaction_type: 'WIN',
    reason: 'not_provided',
    amount: '3.40',
    currency_code: 'USD',
    transaction_id: 1000020,
    transaction_timestamp: '2025-08-11 14:21:07',
    round_id: 167074,
    round_finished: false,
    game_id: 4,
    user_id: '48',
    token: '78d0de2e8724b03a0ec34c869e44ceae',
    context: {
      reason: 'not_provided',
      urid: 'TEST1000020',
      history_id: 'test-1000020'
    }
  }
}
[AUTH_DEBUG] Validating authorization for command: changebalance
[AUTH_DEBUG] Received auth header: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Secret key configured: YES
[AUTH_DEBUG] Expected hash: 63116a7611437044617d6ac66069bfa6010e3d1f
[AUTH_DEBUG] Hash match: true
CHANGEBALANCE request received: {
  "command": "changebalance",
  "data": {
    "transaction_type": "WIN",
    "reason": "not_provided",
    "amount": "3.40",
    "currency_code": "USD",
    "transaction_id": 1000020,
    "transaction_timestamp": "2025-08-11 14:21:07",
    "round_id": 167074,
    "round_finished": false,
    "game_id": 4,
    "user_id": "48",
    "token": "78d0de2e8724b03a0ec34c869e44ceae",
    "context": {
      "reason": "not_provided",
      "urid": "TEST1000020",
      "history_id": "test-1000020"
    }
  },
  "request_timestamp": "2025-08-11 14:21:07",
  "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
}
[CRITICAL DEBUG] handleChangeBalance method called - VERSION 2.0
[DEBUG] CHANGEBALANCE: Provider format - transaction_type: WIN, amount: 3.40, parsed: 3.4, type: WIN
CHANGEBALANCE parameters: {
  token: 'present',
  user_id: 'present',
  amount: 'present ($3.40)',
  transaction_type: 'WIN',
  transaction_id: 'present',
  game_id: 'present',
  session_id: 'missing',
  currency_code: 'present',
  round_id: 'present',
  round_finished: false
}
[IDEMPOTENCY] Found 0 recent bet transactions with same amount
[IDEMPOTENCY] Transaction 1000024 is new, proceeding with processing
[DEBUG] CHANGEBALANCE: Processing bet of $4.58
[IDEMPOTENCY] Checking for duplicate transactions for user 48
[IDEMPOTENCY] Checking for duplicate transactions for user 48
[DEBUG] CHANGEBALANCE: Starting game validation - game_id: 4, transactionType: BET
[DEBUG] CHANGEBALANCE: Validating game 4
[IDEMPOTENCY] Checking for duplicate transactions for user 48
[IDEMPOTENCY] Found 0 recent bet transactions with same amount
[IDEMPOTENCY] Transaction 1000022 is new, proceeding with processing
[DEBUG] CHANGEBALANCE: Processing bet of $6.58
[DEBUG] CHANGEBALANCE: Starting game validation - game_id: 4, transactionType: BET
[DEBUG] CHANGEBALANCE: Validating game 4
[IDEMPOTENCY] Found 0 recent bet transactions with same amount
[IDEMPOTENCY] Transaction 1000029 is new, proceeding with processing
[DEBUG] CHANGEBALANCE: Processing win of $6.26
[DEBUG] CHANGEBALANCE: Starting game validation - game_id: 4, transactionType: WIN
[DEBUG] CHANGEBALANCE: Validating game 4
[IDEMPOTENCY] Checking for duplicate transactions for user 48
[PROFIT_CONTROL] Validated metrics: {
  originalAmount: 9.23,
  adjustedAmount: 9.23,
  profitReduction: 0,
  effectiveRtp: '100.00',
  providerRtp: '96.00'
}
[IDEMPOTENCY] Checking for duplicate transactions for user 48
[IDEMPOTENCY] Checking for duplicate transactions for user 48
[IDEMPOTENCY] Found 0 recent bet transactions with same amount
[IDEMPOTENCY] Transaction 1000025 is new, proceeding with processing
[DEBUG] CHANGEBALANCE: Processing win of $7.30
[IDEMPOTENCY] Found 0 recent bet transactions with same amount
[IDEMPOTENCY] Transaction 1000027 is new, proceeding with processing
[DEBUG] CHANGEBALANCE: Processing win of $6.19
[IDEMPOTENCY] Found 0 recent bet transactions with same amount
[IDEMPOTENCY] Transaction 1000021 is new, proceeding with processing
[DEBUG] CHANGEBALANCE: Processing bet of $7.47
[IDEMPOTENCY] Found 0 recent bet transactions with same amount
[IDEMPOTENCY] Transaction 1000026 is new, proceeding with processing
[DEBUG] CHANGEBALANCE: Processing bet of $3.04
[IDEMPOTENCY] Checking for duplicate transactions for user 48
[IDEMPOTENCY] Found 0 recent bet transactions with same amount
[IDEMPOTENCY] Transaction 1000020 is new, proceeding with processing
[DEBUG] CHANGEBALANCE: Processing win of $3.40
[TRANSACTION] Successfully committed transaction
[TRANSACTION] Client released
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "9.23",
      "currency_code": "USD",
      "transaction_id": 1000028,
      "transaction_timestamp": "2025-08-11 14:21:07",
      "round_id": 173297,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000028",
        "history_id": "test-1000028"
      }
    },
    "request_timestamp": "2025-08-11 14:21:07",
    "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:07",
    "hash": "9fe9f0373a09e1dfb7690c66e83c63a356d8dc63",
    "data": {
      "transaction_id": 1000028,
      "status": "OK",
      "balance": 20.32,
      "currency_code": "USD"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "9.23",
      "currency_code": "USD",
      "transaction_id": 1000028,
      "transaction_timestamp": "2025-08-11 14:21:07",
      "round_id": 173297,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000028",
        "history_id": "test-1000028"
      }
    },
    "request_timestamp": "2025-08-11 14:21:07",
    "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:07",
    "hash": "9fe9f0373a09e1dfb7690c66e83c63a356d8dc63",
    "data": {
      "transaction_id": 1000028,
      "status": "OK",
      "balance": 20.32,
      "currency_code": "USD"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 80.411 ms - 700[0m
[PROFIT_CONTROL] Validated metrics: {
  originalAmount: 1.51,
  adjustedAmount: 1.51,
  profitReduction: 0,
  effectiveRtp: '100.00',
  providerRtp: '96.00'
}
[TRANSACTION] Successfully committed transaction
[TRANSACTION] Client released
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "1.51",
      "currency_code": "USD",
      "transaction_id": 1000023,
      "transaction_timestamp": "2025-08-11 14:21:07",
      "round_id": 729395,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000023",
        "history_id": "test-1000023"
      }
    },
    "request_timestamp": "2025-08-11 14:21:07",
    "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:07",
    "hash": "9fe9f0373a09e1dfb7690c66e83c63a356d8dc63",
    "data": {
      "transaction_id": 1000023,
      "status": "OK",
      "balance": 18.81,
      "currency_code": "USD"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "1.51",
      "currency_code": "USD",
      "transaction_id": 1000023,
      "transaction_timestamp": "2025-08-11 14:21:07",
      "round_id": 729395,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000023",
        "history_id": "test-1000023"
      }
    },
    "request_timestamp": "2025-08-11 14:21:07",
    "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:07",
    "hash": "9fe9f0373a09e1dfb7690c66e83c63a356d8dc63",
    "data": {
      "transaction_id": 1000023,
      "status": "OK",
      "balance": 18.81,
      "currency_code": "USD"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 87.960 ms - 700[0m
[PROFIT_CONTROL] Validated metrics: {
  originalAmount: 4.58,
  adjustedAmount: 4.58,
  profitReduction: 0,
  effectiveRtp: '100.00',
  providerRtp: '96.00'
}
[TRANSACTION] Successfully committed transaction
[TRANSACTION] Client released
[PROFIT_CONTROL] Processing win: $6.26, Provider RTP: 96.00%
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "4.58",
      "currency_code": "USD",
      "transaction_id": 1000024,
      "transaction_timestamp": "2025-08-11 14:21:07",
      "round_id": 446182,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000024",
        "history_id": "test-1000024"
      }
    },
    "request_timestamp": "2025-08-11 14:21:07",
    "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:07",
    "hash": "9fe9f0373a09e1dfb7690c66e83c63a356d8dc63",
    "data": {
      "transaction_id": 1000024,
      "status": "OK",
      "balance": 14.23,
      "currency_code": "USD"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "4.58",
      "currency_code": "USD",
      "transaction_id": 1000024,
      "transaction_timestamp": "2025-08-11 14:21:07",
      "round_id": 446182,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000024",
        "history_id": "test-1000024"
      }
    },
    "request_timestamp": "2025-08-11 14:21:07",
    "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:07",
    "hash": "9fe9f0373a09e1dfb7690c66e83c63a356d8dc63",
    "data": {
      "transaction_id": 1000024,
      "status": "OK",
      "balance": 14.23,
      "currency_code": "USD"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 105.749 ms - 700[0m
[PROFIT_CONTROL] Validated metrics: {
  originalAmount: 6.26,
  adjustedAmount: 6.26,
  profitReduction: 0,
  effectiveRtp: '100.00',
  providerRtp: '96.00'
}
[PROFIT_CONTROL] Win adjustment: $6.26 → $6.26 (reduction: $0.00)
[DEBUG] No bet found with session_id undefined, looking for bet with same round_id 925433
[DEBUG] No bet found with round_id 925433, looking for most recent bet for game 4
[DEBUG] Updated bet 1260 with adjusted win amount 6.26
[WALLET_FIX] Processing win with category balance: $6.26
[WALLET_FIX] Category balance calculation: 14.23 + 6.26 = 20.490000000000002
[WALLET_FIX] Category balance updated: 14.23 + 6.26 = 20.490000000000002
CHANGEBALANCE win processed: {
  bet_id: 1260,
  transaction_id: 2759,
  balance_before: '$14.23',
  balance_after: '$20.49',
  win_amount: '$6.26'
}
[BALANCE_AUDIT] Win processed - Category: slots, Balance: 14.23 -> 20.490000000000002
[TRANSACTION] Successfully committed transaction
[TRANSACTION] Client released
[PROFIT_CONTROL] Processing win: $3.40, Provider RTP: 96.00%
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "6.26",
      "currency_code": "USD",
      "transaction_id": 1000029,
      "transaction_timestamp": "2025-08-11 14:21:07",
      "round_id": 925433,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000029",
        "history_id": "test-1000029"
      }
    },
    "request_timestamp": "2025-08-11 14:21:07",
    "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:07",
    "hash": "9fe9f0373a09e1dfb7690c66e83c63a356d8dc63",
    "data": {
      "transaction_id": 1000029,
      "status": "OK",
      "balance": 35.81,
      "currency_code": "USD"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "6.26",
      "currency_code": "USD",
      "transaction_id": 1000029,
      "transaction_timestamp": "2025-08-11 14:21:07",
      "round_id": 925433,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000029",
        "history_id": "test-1000029"
      }
    },
    "request_timestamp": "2025-08-11 14:21:07",
    "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:07",
    "hash": "9fe9f0373a09e1dfb7690c66e83c63a356d8dc63",
    "data": {
      "transaction_id": 1000029,
      "status": "OK",
      "balance": 35.81,
      "currency_code": "USD"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 124.905 ms - 700[0m
[PROFIT_CONTROL] Validated metrics: {
  originalAmount: 3.4,
  adjustedAmount: 3.4,
  profitReduction: 0,
  effectiveRtp: '100.00',
  providerRtp: '96.00'
}
[PROFIT_CONTROL] Win adjustment: $3.40 → $3.40 (reduction: $0.00)
[DEBUG] No bet found with session_id undefined, looking for bet with same round_id 167074
[DEBUG] No bet found with round_id 167074, looking for most recent bet for game 4
[DEBUG] Updated bet 1260 with adjusted win amount 3.4
[WALLET_FIX] Processing win with category balance: $3.40
[WALLET_FIX] Category balance calculation: 35.81 + 3.4 = 39.21
[WALLET_FIX] Category balance updated: 35.81 + 3.4 = 39.21
CHANGEBALANCE win processed: {
  bet_id: 1260,
  transaction_id: 2760,
  balance_before: '$35.81',
  balance_after: '$39.21',
  win_amount: '$3.40'
}
[BALANCE_AUDIT] Win processed - Category: slots, Balance: 35.81 -> 39.21
[TRANSACTION] Successfully committed transaction
[TRANSACTION] Client released
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "3.40",
      "currency_code": "USD",
      "transaction_id": 1000020,
      "transaction_timestamp": "2025-08-11 14:21:07",
      "round_id": 167074,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000020",
        "history_id": "test-1000020"
      }
    },
    "request_timestamp": "2025-08-11 14:21:07",
    "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:07",
    "hash": "9fe9f0373a09e1dfb7690c66e83c63a356d8dc63",
    "data": {
      "transaction_id": 1000020,
      "status": "OK",
      "balance": 32.95,
      "currency_code": "USD"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "3.40",
      "currency_code": "USD",
      "transaction_id": 1000020,
      "transaction_timestamp": "2025-08-11 14:21:07",
      "round_id": 167074,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000020",
        "history_id": "test-1000020"
      }
    },
    "request_timestamp": "2025-08-11 14:21:07",
    "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:07",
    "hash": "9fe9f0373a09e1dfb7690c66e83c63a356d8dc63",
    "data": {
      "transaction_id": 1000020,
      "status": "OK",
      "balance": 32.95,
      "currency_code": "USD"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 112.156 ms - 700[0m
[PROFIT_CONTROL] Processing win: $7.30, Provider RTP: 96.00%
[PROFIT_CONTROL] Validated metrics: {
  originalAmount: 7.3,
  adjustedAmount: 7.3,
  profitReduction: 0,
  effectiveRtp: '100.00',
  providerRtp: '96.00'
}
[PROFIT_CONTROL] Win adjustment: $7.30 → $7.30 (reduction: $0.00)
[DEBUG] No bet found with session_id undefined, looking for bet with same round_id 37812
[DEBUG] No bet found with round_id 37812, looking for most recent bet for game 4
[DEBUG] Updated bet 1260 with adjusted win amount 7.3
[WALLET_FIX] Processing win with category balance: $7.30
[WALLET_FIX] Category balance calculation: 32.95 + 7.3 = 40.25
[WALLET_FIX] Category balance updated: 32.95 + 7.3 = 40.25
CHANGEBALANCE win processed: {
  bet_id: 1260,
  transaction_id: 2761,
  balance_before: '$32.95',
  balance_after: '$40.25',
  win_amount: '$7.30'
}
[BALANCE_AUDIT] Win processed - Category: slots, Balance: 32.95 -> 40.25
[TRANSACTION] Successfully committed transaction
[TRANSACTION] Client released
[PROFIT_CONTROL] Processing win: $6.19, Provider RTP: 96.00%
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "7.30",
      "currency_code": "USD",
      "transaction_id": 1000025,
      "transaction_timestamp": "2025-08-11 14:21:07",
      "round_id": 37812,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000025",
        "history_id": "test-1000025"
      }
    },
    "request_timestamp": "2025-08-11 14:21:07",
    "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:07",
    "hash": "9fe9f0373a09e1dfb7690c66e83c63a356d8dc63",
    "data": {
      "transaction_id": 1000025,
      "status": "OK",
      "balance": 36.85,
      "currency_code": "USD"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "7.30",
      "currency_code": "USD",
      "transaction_id": 1000025,
      "transaction_timestamp": "2025-08-11 14:21:07",
      "round_id": 37812,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000025",
        "history_id": "test-1000025"
      }
    },
    "request_timestamp": "2025-08-11 14:21:07",
    "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:07",
    "hash": "9fe9f0373a09e1dfb7690c66e83c63a356d8dc63",
    "data": {
      "transaction_id": 1000025,
      "status": "OK",
      "balance": 36.85,
      "currency_code": "USD"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 162.868 ms - 699[0m
[PROFIT_CONTROL] Validated metrics: {
  originalAmount: 6.19,
  adjustedAmount: 6.19,
  profitReduction: 0,
  effectiveRtp: '100.00',
  providerRtp: '96.00'
}
[PROFIT_CONTROL] Win adjustment: $6.19 → $6.19 (reduction: $0.00)
[DEBUG] No bet found with session_id undefined, looking for bet with same round_id 561823
[DEBUG] No bet found with round_id 561823, looking for most recent bet for game 4
[DEBUG] Updated bet 1260 with adjusted win amount 6.19
[WALLET_FIX] Processing win with category balance: $6.19
[WALLET_FIX] Category balance calculation: 36.85 + 6.19 = 43.04
[WALLET_FIX] Category balance updated: 36.85 + 6.19 = 43.04
CHANGEBALANCE win processed: {
  bet_id: 1260,
  transaction_id: 2762,
  balance_before: '$36.85',
  balance_after: '$43.04',
  win_amount: '$6.19'
}
[BALANCE_AUDIT] Win processed - Category: slots, Balance: 36.85 -> 43.04
[TRANSACTION] Successfully committed transaction
[TRANSACTION] Client released
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "6.19",
      "currency_code": "USD",
      "transaction_id": 1000027,
      "transaction_timestamp": "2025-08-11 14:21:07",
      "round_id": 561823,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000027",
        "history_id": "test-1000027"
      }
    },
    "request_timestamp": "2025-08-11 14:21:07",
    "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:07",
    "hash": "9fe9f0373a09e1dfb7690c66e83c63a356d8dc63",
    "data": {
      "transaction_id": 1000027,
      "status": "OK",
      "balance": 35.74,
      "currency_code": "USD"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "WIN",
      "reason": "not_provided",
      "amount": "6.19",
      "currency_code": "USD",
      "transaction_id": 1000027,
      "transaction_timestamp": "2025-08-11 14:21:07",
      "round_id": 561823,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000027",
        "history_id": "test-1000027"
      }
    },
    "request_timestamp": "2025-08-11 14:21:07",
    "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:07",
    "hash": "9fe9f0373a09e1dfb7690c66e83c63a356d8dc63",
    "data": {
      "transaction_id": 1000027,
      "status": "OK",
      "balance": 35.74,
      "currency_code": "USD"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 179.756 ms - 700[0m
[PROFIT_CONTROL] Validated metrics: {
  originalAmount: 6.58,
  adjustedAmount: 6.58,
  profitReduction: 0,
  effectiveRtp: '100.00',
  providerRtp: '96.00'
}
[TRANSACTION] Successfully committed transaction
[TRANSACTION] Client released
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "6.58",
      "currency_code": "USD",
      "transaction_id": 1000022,
      "transaction_timestamp": "2025-08-11 14:21:07",
      "round_id": 897078,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000022",
        "history_id": "test-1000022"
      }
    },
    "request_timestamp": "2025-08-11 14:21:07",
    "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:07",
    "hash": "9fe9f0373a09e1dfb7690c66e83c63a356d8dc63",
    "data": {
      "transaction_id": 1000022,
      "status": "OK",
      "balance": 29.16,
      "currency_code": "USD"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "6.58",
      "currency_code": "USD",
      "transaction_id": 1000022,
      "transaction_timestamp": "2025-08-11 14:21:07",
      "round_id": 897078,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000022",
        "history_id": "test-1000022"
      }
    },
    "request_timestamp": "2025-08-11 14:21:07",
    "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:07",
    "hash": "9fe9f0373a09e1dfb7690c66e83c63a356d8dc63",
    "data": {
      "transaction_id": 1000022,
      "status": "OK",
      "balance": 29.16,
      "currency_code": "USD"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 207.903 ms - 700[0m
[PROFIT_CONTROL] Validated metrics: {
  originalAmount: 3.04,
  adjustedAmount: 3.04,
  profitReduction: 0,
  effectiveRtp: '100.00',
  providerRtp: '96.00'
}
[TRANSACTION] Successfully committed transaction
[TRANSACTION] Client released
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "3.04",
      "currency_code": "USD",
      "transaction_id": 1000026,
      "transaction_timestamp": "2025-08-11 14:21:07",
      "round_id": 546167,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000026",
        "history_id": "test-1000026"
      }
    },
    "request_timestamp": "2025-08-11 14:21:07",
    "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:07",
    "hash": "9fe9f0373a09e1dfb7690c66e83c63a356d8dc63",
    "data": {
      "transaction_id": 1000026,
      "status": "OK",
      "balance": 26.12,
      "currency_code": "USD"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "3.04",
      "currency_code": "USD",
      "transaction_id": 1000026,
      "transaction_timestamp": "2025-08-11 14:21:07",
      "round_id": 546167,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000026",
        "history_id": "test-1000026"
      }
    },
    "request_timestamp": "2025-08-11 14:21:07",
    "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:07",
    "hash": "9fe9f0373a09e1dfb7690c66e83c63a356d8dc63",
    "data": {
      "transaction_id": 1000026,
      "status": "OK",
      "balance": 26.12,
      "currency_code": "USD"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 213.703 ms - 700[0m
[PROFIT_CONTROL] Validated metrics: {
  originalAmount: 7.47,
  adjustedAmount: 7.47,
  profitReduction: 0,
  effectiveRtp: '100.00',
  providerRtp: '96.00'
}
[TRANSACTION] Successfully committed transaction
[TRANSACTION] Client released
PROVIDER RESPONSE OUTPUT: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "7.47",
      "currency_code": "USD",
      "transaction_id": 1000021,
      "transaction_timestamp": "2025-08-11 14:21:07",
      "round_id": 452405,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000021",
        "history_id": "test-1000021"
      }
    },
    "request_timestamp": "2025-08-11 14:21:07",
    "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:07",
    "hash": "9fe9f0373a09e1dfb7690c66e83c63a356d8dc63",
    "data": {
      "transaction_id": 1000021,
      "status": "OK",
      "balance": 18.65,
      "currency_code": "USD"
    }
  }
}
Provider callback response: {
  "request": {
    "command": "changebalance",
    "data": {
      "transaction_type": "BET",
      "reason": "not_provided",
      "amount": "7.47",
      "currency_code": "USD",
      "transaction_id": 1000021,
      "transaction_timestamp": "2025-08-11 14:21:07",
      "round_id": 452405,
      "round_finished": false,
      "game_id": 4,
      "user_id": "48",
      "token": "78d0de2e8724b03a0ec34c869e44ceae",
      "context": {
        "reason": "not_provided",
        "urid": "TEST1000021",
        "history_id": "test-1000021"
      }
    },
    "request_timestamp": "2025-08-11 14:21:07",
    "hash": "b63aed1107386082cac7a40d60496de62e8caed0"
  },
  "response": {
    "status": "OK",
    "response_timestamp": "2025-08-11 14:21:07",
    "hash": "9fe9f0373a09e1dfb7690c66e83c63a356d8dc63",
    "data": {
      "transaction_id": 1000021,
      "status": "OK",
      "balance": 18.65,
      "currency_code": "USD"
    }
  }
}
[0mPOST /api/innova/changebalance [32m200[0m 221.724 ms - 700[0m
[APP DEBUG] Incoming request: GET /dispatch.asp body: undefined
[0mGET /dispatch.asp [33m404[0m 0.535 ms - 151[0m
